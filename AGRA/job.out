log : ResNet50_CropNet_GCNwithIntraMatrixAndInterMatrix_useCluster_withoutAFN_trainOnSourceDomain_RAFtoAFED out-pth . net: ResNet50 pretrained None dev 0
Use 112 * 112 Image source RAF target CK+ train bs 32 test bs 32
Ep: 60 LR 0.000100 mu: 0.900000 WD: 0.000100
================================================
Num cls : 7
Use global feature and local feature.
Use Intra GCN.
Use Inter GCN.
Use Mean in Cluster.
================================================
Building Train and Test Dataloader...
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
 test source dataset qty: 2993
 test source dataset dist: 325, 68, 158, 1171, 447, 160, 664
 test target dataset qty: 129
 test target dataset dist: 21, 9, 15, 24, 12, 15, 33
Done!
================================================
Building Model...
No Resume Model
Done!
================================================
Initialize Mean in Cluster....
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 81.934396s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
2021-04-23 13:54:30.888302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
[Target Domain] Cost time : 13.396261s
Done!
================================================
Building Optimizer...
Done!
================================================
Run Experiment...

    [Train]: 
    Epoch 1
    Data Time 2.9001 (0.0078)
    Batch Time 137.1791 (0.3668)
    Learning Rate 0.0001
    Accuracy 0.4387 0.4387 0.4387 0.4387 0.4387 0.4387 0.4387
    Precision 0.2491 0.0000 0.1250 0.4881 0.3012 0.2143 0.3614
    Recall 0.0556 0.0000 0.0014 0.8486 0.1475 0.0440 0.3570
    F1 0.0909 0.0000 0.0028 0.6197 0.1980 0.0730 0.3592
    Acc_avg 0.4387 Prec_avg 0.2484 Recall_avg 0.2077 F1_avg 0.1919
    Total Loss 2.9991 Global Cls Loss 1.5021 Local Cls Loss 1.4970 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3973 (0.0042)
    Batch Time 18.3261 (0.1950)
    Learning Rate 0.0001
    Accuracy 0.5092 0.5092 0.5092 0.5092 0.5092 0.5092 0.5092
    Precision 0.5028 0.0000 0.0000 0.5453 0.3305 0.4490 0.4677
    Recall 0.2769 0.0000 0.0000 0.9095 0.1767 0.1375 0.4036
    F1 0.3571 0.0000 0.0000 0.6818 0.2303 0.2105 0.4333
Acc_avg 0.5092 Prec_avg 0.3279 Recall_avg 0.2720 F1_avg 0.2733
    Total Loss 2.6147 Global Cls Loss 1.3070 Local Cls Loss 1.3077 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.2720.

    Test Target: 
    Data Time 0.0175 (0.0035)
    Batch Time 0.8080 (0.1616)
    Learning Rate 0.0001
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.1875 0.0000 0.0000 0.1810 0.0000 0.0000 0.7500
    Recall 0.1429 0.0000 0.0000 0.7917 0.0000 0.0000 0.1818
    F1 0.1622 0.0000 0.0000 0.2946 0.0000 0.0000 0.2927
Acc_avg 0.2171 Prec_avg 0.1598 Recall_avg 0.1595 F1_avg 0.1071
    Total Loss 3.6968 Global Cls Loss 1.8670 Local Cls Loss 1.8297 AFN Loss 0.0000

    [Train]: 
    Epoch 2
    Data Time 2.1657 (0.0058)
    Batch Time 136.1120 (0.3639)
    Learning Rate 0.0001
    Accuracy 0.5581 0.5581 0.5581 0.5581 0.5581 0.5581 0.5581
    Precision 0.5105 0.3333 0.3333 0.6450 0.4246 0.4502 0.4784
    Recall 0.4241 0.0038 0.0028 0.8350 0.3439 0.2654 0.5623
    F1 0.4633 0.0075 0.0056 0.7278 0.3801 0.3339 0.5170
    Acc_avg 0.5581 Prec_avg 0.4536 Recall_avg 0.3482 F1_avg 0.3479
    Total Loss 2.4344 Global Cls Loss 1.2203 Local Cls Loss 1.2142 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3635 (0.0039)
    Batch Time 20.5442 (0.2186)
    Learning Rate 0.0001
    Accuracy 0.6148 0.6148 0.6148 0.6148 0.6148 0.6148 0.6148
    Precision 0.5679 1.0000 0.5000 0.7139 0.4808 0.5670 0.5282
    Recall 0.6431 0.0735 0.0063 0.8395 0.3915 0.3438 0.6205
    F1 0.6032 0.1370 0.0125 0.7716 0.4316 0.4280 0.5706
Acc_avg 0.6148 Prec_avg 0.6225 Recall_avg 0.4169 F1_avg 0.4221
    Total Loss 2.1639 Global Cls Loss 1.0820 Local Cls Loss 1.0818 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.4169.

    Test Target: 
    Data Time 0.0205 (0.0041)
    Batch Time 0.8365 (0.1673)
    Learning Rate 0.0001
    Accuracy 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705
    Precision 0.3077 0.0000 0.0000 0.1593 0.0000 0.0000 0.0000
    Recall 0.1905 0.0000 0.0000 0.7500 0.0000 0.0000 0.0000
    F1 0.2353 0.0000 0.0000 0.2628 0.0000 0.0000 0.0000
Acc_avg 0.1705 Prec_avg 0.0667 Recall_avg 0.1344 F1_avg 0.0712
    Total Loss 3.8386 Global Cls Loss 1.9567 Local Cls Loss 1.8819 AFN Loss 0.0000

    [Train]: 
    Epoch 3
    Data Time 2.2360 (0.0060)
    Batch Time 129.1712 (0.3454)
    Learning Rate 0.0001
    Accuracy 0.6192 0.6192 0.6192 0.6192 0.6192 0.6192 0.6192
    Precision 0.6039 0.5660 0.4068 0.7155 0.5117 0.5058 0.5299
    Recall 0.5473 0.1145 0.0673 0.8519 0.4424 0.3856 0.6250
    F1 0.5742 0.1905 0.1155 0.7777 0.4745 0.4376 0.5736
    Acc_avg 0.6192 Prec_avg 0.5485 Recall_avg 0.4334 F1_avg 0.4491
    Total Loss 2.1343 Global Cls Loss 1.0679 Local Cls Loss 1.0665 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4871 (0.0052)
    Batch Time 19.9381 (0.2121)
    Learning Rate 0.0001
    Accuracy 0.6365 0.6365 0.6365 0.6365 0.6365 0.6365 0.6365
    Precision 0.7269 0.5278 0.3860 0.6872 0.5237 0.5425 0.5884
    Recall 0.5569 0.2794 0.1392 0.8950 0.3714 0.5188 0.5813
    F1 0.6307 0.3654 0.2047 0.7774 0.4346 0.5304 0.5848
Acc_avg 0.6365 Prec_avg 0.5689 Recall_avg 0.4774 F1_avg 0.5040
    Total Loss 2.0348 Global Cls Loss 1.0176 Local Cls Loss 1.0172 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.4774.

    Test Target: 
    Data Time 0.0206 (0.0041)
    Batch Time 0.8321 (0.1664)
    Learning Rate 0.0001
    Accuracy 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705
    Precision 0.1579 0.0000 0.0000 0.1776 0.0000 0.0000 0.0000
    Recall 0.1429 0.0000 0.0000 0.7917 0.0000 0.0000 0.0000
    F1 0.1500 0.0000 0.0000 0.2901 0.0000 0.0000 0.0000
Acc_avg 0.1705 Prec_avg 0.0479 Recall_avg 0.1335 F1_avg 0.0629
    Total Loss 3.8360 Global Cls Loss 1.9097 Local Cls Loss 1.9262 AFN Loss 0.0000

    [Train]: 
    Epoch 4
    Data Time 2.2809 (0.0061)
    Batch Time 130.2609 (0.3483)
    Learning Rate 0.0001
    Accuracy 0.6494 0.6494 0.6494 0.6494 0.6494 0.6494 0.6494
    Precision 0.6315 0.6071 0.4359 0.7549 0.5453 0.5561 0.5562
    Recall 0.6145 0.1947 0.1431 0.8599 0.4753 0.4721 0.6425
    F1 0.6229 0.2948 0.2154 0.8040 0.5079 0.5107 0.5962
    Acc_avg 0.6494 Prec_avg 0.5839 Recall_avg 0.4860 F1_avg 0.5074
    Total Loss 1.9557 Global Cls Loss 0.9787 Local Cls Loss 0.9770 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4845 (0.0052)
    Batch Time 19.5459 (0.2079)
    Learning Rate 0.0001
    Accuracy 0.6579 0.6579 0.6579 0.6579 0.6579 0.6579 0.6579
    Precision 0.6707 0.5385 0.4103 0.7553 0.5221 0.5161 0.5964
    Recall 0.6892 0.3088 0.1013 0.8514 0.4497 0.5000 0.6476
    F1 0.6798 0.3925 0.1624 0.8005 0.4832 0.5079 0.6209
Acc_avg 0.6579 Prec_avg 0.5728 Recall_avg 0.5069 F1_avg 0.5210
    Total Loss 1.9014 Global Cls Loss 0.9535 Local Cls Loss 0.9480 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5069.

    Test Target: 
    Data Time 0.0186 (0.0037)
    Batch Time 0.8093 (0.1619)
    Learning Rate 0.0001
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 1.0000 0.0000 0.0000 0.2143 0.0000 0.0000 0.1250
    Recall 0.0952 0.0000 0.0000 1.0000 0.0000 0.0000 0.0303
    F1 0.1739 0.0000 0.0000 0.3529 0.0000 0.0000 0.0488
Acc_avg 0.2093 Prec_avg 0.1913 Recall_avg 0.1608 F1_avg 0.0822
    Total Loss 4.0485 Global Cls Loss 2.0532 Local Cls Loss 1.9952 AFN Loss 0.0000

    [Train]: 
    Epoch 5
    Data Time 2.2161 (0.0059)
    Batch Time 123.3902 (0.3299)
    Learning Rate 0.0001
    Accuracy 0.6771 0.6771 0.6771 0.6771 0.6771 0.6771 0.6771
    Precision 0.6764 0.6238 0.4381 0.7727 0.5870 0.6135 0.5946
    Recall 0.6415 0.2405 0.2034 0.8680 0.5303 0.5191 0.6706
    F1 0.6585 0.3471 0.2778 0.8176 0.5572 0.5624 0.6303
    Acc_avg 0.6771 Prec_avg 0.6152 Recall_avg 0.5247 F1_avg 0.5501
    Total Loss 1.7959 Global Cls Loss 0.8994 Local Cls Loss 0.8965 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3812 (0.0041)
    Batch Time 17.9222 (0.1907)
    Learning Rate 0.0001
    Accuracy 0.6709 0.6709 0.6709 0.6709 0.6709 0.6709 0.6709
    Precision 0.7671 0.5938 0.3083 0.7951 0.5293 0.5326 0.6165
    Recall 0.5877 0.2794 0.2595 0.8352 0.5056 0.6125 0.6852
    F1 0.6655 0.3800 0.2818 0.8147 0.5172 0.5698 0.6491
Acc_avg 0.6709 Prec_avg 0.5918 Recall_avg 0.5379 F1_avg 0.5540
    Total Loss 1.8033 Global Cls Loss 0.9022 Local Cls Loss 0.9010 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5379.

    Test Target: 
    Data Time 0.0503 (0.0101)
    Batch Time 0.8202 (0.1640)
    Learning Rate 0.0001
    Accuracy 0.2636 0.2636 0.2636 0.2636 0.2636 0.2636 0.2636
    Precision 1.0000 0.0000 0.0000 0.2124 0.0000 0.0000 0.5385
    Recall 0.1429 0.0000 0.0000 1.0000 0.0000 0.0000 0.2121
    F1 0.2500 0.0000 0.0000 0.3504 0.0000 0.0000 0.3043
Acc_avg 0.2636 Prec_avg 0.2501 Recall_avg 0.1936 F1_avg 0.1292
    Total Loss 3.7222 Global Cls Loss 1.8643 Local Cls Loss 1.8579 AFN Loss 0.0000

    [Train]: 
    Epoch 6
    Data Time 2.0385 (0.0055)
    Batch Time 122.3519 (0.3271)
    Learning Rate 0.0001
    Accuracy 0.7007 0.7007 0.7007 0.7007 0.7007 0.7007 0.7007
    Precision 0.7099 0.7059 0.5107 0.7950 0.6084 0.6358 0.6187
    Recall 0.6789 0.3206 0.2679 0.8722 0.5554 0.5528 0.7022
    F1 0.6940 0.4409 0.3514 0.8318 0.5807 0.5914 0.6578
    Acc_avg 0.7007 Prec_avg 0.6549 Recall_avg 0.5643 F1_avg 0.5926
    Total Loss 1.6973 Global Cls Loss 0.8490 Local Cls Loss 0.8483 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3625 (0.0039)
    Batch Time 21.1602 (0.2251)
    Learning Rate 0.0001
    Accuracy 0.6816 0.6816 0.6816 0.6816 0.6816 0.6816 0.6816
    Precision 0.8061 0.5778 0.4167 0.8016 0.4881 0.6081 0.6123
    Recall 0.6523 0.3824 0.1899 0.8693 0.5951 0.5625 0.5994
    F1 0.7211 0.4602 0.2609 0.8341 0.5363 0.5844 0.6058
Acc_avg 0.6816 Prec_avg 0.6158 Recall_avg 0.5501 F1_avg 0.5718
    Total Loss 1.7575 Global Cls Loss 0.8772 Local Cls Loss 0.8803 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5501.

    Test Target: 
    Data Time 0.0189 (0.0038)
    Batch Time 0.8089 (0.1618)
    Learning Rate 0.0001
    Accuracy 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938
    Precision 1.0000 0.0000 0.0000 0.2017 0.0000 0.0000 0.0000
    Recall 0.0476 0.0000 0.0000 1.0000 0.0000 0.0000 0.0000
    F1 0.0909 0.0000 0.0000 0.3357 0.0000 0.0000 0.0000
Acc_avg 0.1938 Prec_avg 0.1717 Recall_avg 0.1497 F1_avg 0.0609
    Total Loss 4.1231 Global Cls Loss 2.0547 Local Cls Loss 2.0685 AFN Loss 0.0000

    [Train]: 
    Epoch 7
    Data Time 2.3681 (0.0063)
    Batch Time 121.7708 (0.3256)
    Learning Rate 0.0001
    Accuracy 0.7163 0.7163 0.7163 0.7163 0.7163 0.7163 0.7163
    Precision 0.7049 0.5891 0.5414 0.8157 0.6447 0.6489 0.6316
    Recall 0.6736 0.2901 0.3029 0.8799 0.5924 0.5880 0.7213
    F1 0.6889 0.3887 0.3885 0.8466 0.6174 0.6169 0.6735
    Acc_avg 0.7163 Prec_avg 0.6538 Recall_avg 0.5783 F1_avg 0.6029
    Total Loss 1.6064 Global Cls Loss 0.8042 Local Cls Loss 0.8022 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3934 (0.0042)
    Batch Time 20.2705 (0.2156)
    Learning Rate 0.0001
    Accuracy 0.6856 0.6856 0.6856 0.6856 0.6856 0.6856 0.6856
    Precision 0.7428 0.6250 0.3444 0.7588 0.5355 0.6226 0.7027
    Recall 0.7108 0.2206 0.3291 0.9026 0.5235 0.6188 0.5482
    F1 0.7264 0.3261 0.3366 0.8245 0.5294 0.6207 0.6159
Acc_avg 0.6856 Prec_avg 0.6188 Recall_avg 0.5505 F1_avg 0.5685
    Total Loss 1.7402 Global Cls Loss 0.8700 Local Cls Loss 0.8701 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5505.

    Test Target: 
    Data Time 0.0183 (0.0037)
    Batch Time 0.8524 (0.1705)
    Learning Rate 0.0001
    Accuracy 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705
    Precision 1.0000 0.0000 0.0000 0.2059 0.0000 0.0000 0.0000
    Recall 0.0476 0.0000 0.0000 0.8750 0.0000 0.0000 0.0000
    F1 0.0909 0.0000 0.0000 0.3333 0.0000 0.0000 0.0000
Acc_avg 0.1705 Prec_avg 0.1723 Recall_avg 0.1318 F1_avg 0.0606
    Total Loss 4.2957 Global Cls Loss 2.1436 Local Cls Loss 2.1521 AFN Loss 0.0000

    [Train]: 
    Epoch 8
    Data Time 2.1306 (0.0057)
    Batch Time 126.3429 (0.3378)
    Learning Rate 0.0001
    Accuracy 0.7306 0.7306 0.7306 0.7306 0.7306 0.7306 0.7306
    Precision 0.7327 0.6284 0.5686 0.8313 0.6482 0.6735 0.6413
    Recall 0.6966 0.3550 0.3198 0.8912 0.6138 0.6270 0.7183
    F1 0.7142 0.4537 0.4093 0.8602 0.6305 0.6494 0.6776
    Acc_avg 0.7306 Prec_avg 0.6748 Recall_avg 0.6031 F1_avg 0.6278
    Total Loss 1.5081 Global Cls Loss 0.7544 Local Cls Loss 0.7536 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4083 (0.0043)
    Batch Time 20.0078 (0.2128)
    Learning Rate 0.0001
    Accuracy 0.6946 0.6946 0.6946 0.6946 0.6946 0.6946 0.6946
    Precision 0.8253 0.7778 0.4105 0.7930 0.6416 0.6765 0.5734
    Recall 0.5815 0.3088 0.2468 0.8668 0.4206 0.5750 0.8057
    F1 0.6823 0.4421 0.3083 0.8282 0.5081 0.6216 0.6700
Acc_avg 0.6946 Prec_avg 0.6712 Recall_avg 0.5436 F1_avg 0.5801
    Total Loss 1.7321 Global Cls Loss 0.8653 Local Cls Loss 0.8668 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0192 (0.0038)
    Batch Time 0.8087 (0.1617)
    Learning Rate 0.0001
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.0000 0.0000 0.0000 0.1927 1.0000 0.0000 0.4545
    Recall 0.0000 0.0000 0.0000 0.8750 0.1667 0.0000 0.1515
    F1 0.0000 0.0000 0.0000 0.3158 0.2857 0.0000 0.2273
Acc_avg 0.2171 Prec_avg 0.2353 Recall_avg 0.1705 F1_avg 0.1184
    Total Loss 4.9648 Global Cls Loss 2.5084 Local Cls Loss 2.4564 AFN Loss 0.0000

    [Train]: 
    Epoch 9
    Data Time 2.1947 (0.0059)
    Batch Time 135.6000 (0.3626)
    Learning Rate 0.0001
    Accuracy 0.7393 0.7393 0.7393 0.7393 0.7393 0.7393 0.7393
    Precision 0.7496 0.6691 0.5539 0.8317 0.6622 0.6966 0.6545
    Recall 0.7258 0.3487 0.3170 0.8961 0.6239 0.6364 0.7273
    F1 0.7375 0.4584 0.4032 0.8627 0.6424 0.6651 0.6890
    Acc_avg 0.7393 Prec_avg 0.6882 Recall_avg 0.6107 F1_avg 0.6369
    Total Loss 1.4541 Global Cls Loss 0.7281 Local Cls Loss 0.7261 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3793 (0.0040)
    Batch Time 20.2214 (0.2151)
    Learning Rate 0.0001
    Accuracy 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000
    Precision 0.7946 0.6444 0.4167 0.8042 0.5724 0.6885 0.6075
    Recall 0.6308 0.4265 0.2532 0.8736 0.5481 0.5250 0.7063
    F1 0.7033 0.5133 0.3150 0.8375 0.5600 0.5957 0.6532
Acc_avg 0.7000 Prec_avg 0.6469 Recall_avg 0.5662 F1_avg 0.5968
    Total Loss 1.6750 Global Cls Loss 0.8377 Local Cls Loss 0.8372 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5662.

    Test Target: 
    Data Time 0.0235 (0.0047)
    Batch Time 0.9883 (0.1977)
    Learning Rate 0.0001
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.1538 0.0000 0.2267 0.2222 0.0000 0.2143
    Recall 0.0000 0.2222 0.0000 0.7083 0.1667 0.0000 0.1818
    F1 0.0000 0.1818 0.0000 0.3434 0.1905 0.0000 0.1967
Acc_avg 0.2093 Prec_avg 0.1167 Recall_avg 0.1827 F1_avg 0.1304
    Total Loss 4.0439 Global Cls Loss 2.0395 Local Cls Loss 2.0044 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 90.076844s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 14.866688s

    [Train]: 
    Epoch 10
    Data Time 2.4618 (0.0066)
    Batch Time 127.9889 (0.3422)
    Learning Rate 0.0001
    Accuracy 0.7520 0.7520 0.7520 0.7520 0.7520 0.7520 0.7520
    Precision 0.7597 0.6899 0.5498 0.8454 0.6769 0.7127 0.6770
    Recall 0.7284 0.4160 0.3871 0.8937 0.6403 0.6584 0.7462
    F1 0.7437 0.5190 0.4543 0.8689 0.6581 0.6845 0.7099
    Acc_avg 0.7520 Prec_avg 0.7016 Recall_avg 0.6386 F1_avg 0.6626
    Total Loss 1.3685 Global Cls Loss 0.6852 Local Cls Loss 0.6833 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.4237 (0.0045)
    Batch Time 19.8935 (0.2116)
    Learning Rate 0.0001
    Accuracy 0.7160 0.7160 0.7160 0.7160 0.7160 0.7160 0.7160
    Precision 0.7046 0.5769 0.5352 0.8375 0.5825 0.6471 0.6489
    Recall 0.7046 0.4412 0.2405 0.8625 0.6398 0.6188 0.6792
    F1 0.7046 0.5000 0.3319 0.8498 0.6098 0.6326 0.6637
Acc_avg 0.7160 Prec_avg 0.6475 Recall_avg 0.5981 F1_avg 0.6132
    Total Loss 1.5953 Global Cls Loss 0.7970 Local Cls Loss 0.7983 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5981.

    Test Target: 
    Data Time 0.0196 (0.0039)
    Batch Time 0.8116 (0.1623)
    Learning Rate 0.0001
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2121 0.0000 0.0000 0.2759
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0000 0.2424
    F1 0.0000 0.0000 0.0000 0.3415 0.0000 0.0000 0.2581
Acc_avg 0.2248 Prec_avg 0.0697 Recall_avg 0.1596 F1_avg 0.0856
    Total Loss 4.1094 Global Cls Loss 2.0478 Local Cls Loss 2.0616 AFN Loss 0.0000

    [Train]: 
    Epoch 11
    Data Time 2.7354 (0.0073)
    Batch Time 124.3218 (0.3324)
    Learning Rate 0.0001
    Accuracy 0.7655 0.7655 0.7655 0.7655 0.7655 0.7655 0.7655
    Precision 0.7771 0.6941 0.5945 0.8534 0.6956 0.7289 0.6894
    Recall 0.7506 0.4504 0.3975 0.9001 0.6584 0.6584 0.7680
    F1 0.7636 0.5463 0.4764 0.8761 0.6765 0.6918 0.7265
    Acc_avg 0.7655 Prec_avg 0.7190 Recall_avg 0.6547 F1_avg 0.6796
    Total Loss 1.2997 Global Cls Loss 0.6506 Local Cls Loss 0.6492 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4754 (0.0051)
    Batch Time 18.3857 (0.1956)
    Learning Rate 0.0001
    Accuracy 0.7210 0.7210 0.7210 0.7210 0.7210 0.7210 0.7210
    Precision 0.7778 0.8438 0.3556 0.8224 0.6263 0.6065 0.6579
    Recall 0.7108 0.3971 0.3038 0.8898 0.5436 0.5875 0.7123
    F1 0.7428 0.5400 0.3276 0.8548 0.5820 0.5968 0.6840
Acc_avg 0.7210 Prec_avg 0.6700 Recall_avg 0.5921 F1_avg 0.6183
    Total Loss 1.6124 Global Cls Loss 0.8057 Local Cls Loss 0.8068 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0163 (0.0033)
    Batch Time 0.8125 (0.1625)
    Learning Rate 0.0001
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2055 1.0000 0.0000 0.2264
    Recall 0.0000 0.0000 0.0000 0.6250 0.1667 0.0000 0.3636
    F1 0.0000 0.0000 0.0000 0.3093 0.2857 0.0000 0.2791
Acc_avg 0.2248 Prec_avg 0.2046 Recall_avg 0.1650 F1_avg 0.1249
    Total Loss 4.6692 Global Cls Loss 2.3415 Local Cls Loss 2.3277 AFN Loss 0.0000

    [Train]: 
    Epoch 12
    Data Time 2.3760 (0.0064)
    Batch Time 123.6713 (0.3307)
    Learning Rate 0.0001
    Accuracy 0.7780 0.7780 0.7780 0.7780 0.7780 0.7780 0.7780
    Precision 0.7744 0.6946 0.6206 0.8672 0.7051 0.7339 0.7087
    Recall 0.7744 0.4427 0.4404 0.9111 0.6684 0.7038 0.7634
    F1 0.7744 0.5408 0.5152 0.8886 0.6863 0.7186 0.7351
    Acc_avg 0.7780 Prec_avg 0.7292 Recall_avg 0.6720 F1_avg 0.6941
    Total Loss 1.2185 Global Cls Loss 0.6102 Local Cls Loss 0.6083 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5626 (0.0060)
    Batch Time 18.6008 (0.1979)
    Learning Rate 0.0001
    Accuracy 0.7170 0.7170 0.7170 0.7170 0.7170 0.7170 0.7170
    Precision 0.7508 0.5417 0.4000 0.8213 0.6233 0.5989 0.6508
    Recall 0.6954 0.3824 0.1899 0.8711 0.5145 0.6813 0.7605
    F1 0.7220 0.4483 0.2575 0.8454 0.5637 0.6374 0.7014
Acc_avg 0.7170 Prec_avg 0.6267 Recall_avg 0.5850 F1_avg 0.5965
    Total Loss 1.6179 Global Cls Loss 0.8093 Local Cls Loss 0.8086 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0264 (0.0053)
    Batch Time 0.7864 (0.1573)
    Learning Rate 0.0001
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 0.6667 0.0000 0.0000 0.2045 0.3333 0.0000 0.2667
    Recall 0.0952 0.0000 0.0000 0.7500 0.1667 0.0000 0.2424
    F1 0.1667 0.0000 0.0000 0.3214 0.2222 0.0000 0.2540
Acc_avg 0.2326 Prec_avg 0.2102 Recall_avg 0.1792 F1_avg 0.1378
    Total Loss 4.5127 Global Cls Loss 2.2511 Local Cls Loss 2.2617 AFN Loss 0.0000

    [Train]: 
    Epoch 13
    Data Time 2.3444 (0.0063)
    Batch Time 124.5754 (0.3331)
    Learning Rate 0.0001
    Accuracy 0.7892 0.7892 0.7892 0.7892 0.7892 0.7892 0.7892
    Precision 0.8118 0.6978 0.6311 0.8717 0.7251 0.7666 0.7158
    Recall 0.7983 0.4847 0.4727 0.9016 0.7066 0.7126 0.7783
    F1 0.8050 0.5721 0.5405 0.8864 0.7157 0.7386 0.7458
    Acc_avg 0.7892 Prec_avg 0.7457 Recall_avg 0.6935 F1_avg 0.7149
    Total Loss 1.1733 Global Cls Loss 0.5872 Local Cls Loss 0.5861 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4809 (0.0051)
    Batch Time 18.9585 (0.2017)
    Learning Rate 0.0001
    Accuracy 0.7280 0.7280 0.7280 0.7280 0.7280 0.7280 0.7280
    Precision 0.7807 0.5800 0.4132 0.8304 0.5755 0.6600 0.7080
    Recall 0.7231 0.4265 0.3165 0.8822 0.6309 0.6188 0.6792
    F1 0.7508 0.4915 0.3584 0.8555 0.6019 0.6387 0.6933
Acc_avg 0.7280 Prec_avg 0.6497 Recall_avg 0.6110 F1_avg 0.6272
    Total Loss 1.5837 Global Cls Loss 0.7913 Local Cls Loss 0.7924 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6110.

    Test Target: 
    Data Time 0.0196 (0.0039)
    Batch Time 0.8390 (0.1678)
    Learning Rate 0.0001
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0000 0.0000 0.0000 0.1714 0.2500 0.1333 0.2500
    Recall 0.0000 0.0000 0.0000 0.5000 0.1667 0.1333 0.2424
    F1 0.0000 0.0000 0.0000 0.2553 0.2000 0.1333 0.2462
Acc_avg 0.1860 Prec_avg 0.1150 Recall_avg 0.1489 F1_avg 0.1193
    Total Loss 4.8669 Global Cls Loss 2.4304 Local Cls Loss 2.4365 AFN Loss 0.0000

    [Train]: 
    Epoch 14
    Data Time 2.2770 (0.0061)
    Batch Time 136.4264 (0.3648)
    Learning Rate 0.0001
    Accuracy 0.7957 0.7957 0.7957 0.7957 0.7957 0.7957 0.7957
    Precision 0.8075 0.6959 0.6362 0.8791 0.7415 0.7728 0.7201
    Recall 0.7870 0.5153 0.4783 0.9109 0.7045 0.7331 0.7890
    F1 0.7971 0.5921 0.5460 0.8947 0.7225 0.7524 0.7530
    Acc_avg 0.7957 Prec_avg 0.7504 Recall_avg 0.7026 F1_avg 0.7226
    Total Loss 1.1205 Global Cls Loss 0.5611 Local Cls Loss 0.5594 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3569 (0.0038)
    Batch Time 18.0234 (0.1917)
    Learning Rate 0.0001
    Accuracy 0.7277 0.7277 0.7277 0.7277 0.7277 0.7277 0.7277
    Precision 0.8185 0.6977 0.3472 0.8497 0.6180 0.6538 0.6795
    Recall 0.6800 0.4412 0.4241 0.8642 0.6443 0.6375 0.6898
    F1 0.7429 0.5405 0.3818 0.8569 0.6309 0.6456 0.6846
Acc_avg 0.7277 Prec_avg 0.6663 Recall_avg 0.6259 F1_avg 0.6404
    Total Loss 1.6015 Global Cls Loss 0.8004 Local Cls Loss 0.8012 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6259.

    Test Target: 
    Data Time 0.0183 (0.0037)
    Batch Time 0.8207 (0.1641)
    Learning Rate 0.0001
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 0.0000 0.0000 0.0000 0.2895 0.0000 0.1429 0.2857
    Recall 0.0000 0.0000 0.0000 0.4583 0.0000 0.1333 0.6061
    F1 0.0000 0.0000 0.0000 0.3548 0.0000 0.1379 0.3883
Acc_avg 0.2558 Prec_avg 0.1026 Recall_avg 0.1711 F1_avg 0.1259
    Total Loss 3.5287 Global Cls Loss 1.7553 Local Cls Loss 1.7734 AFN Loss 0.0000

    [Train]: 
    Epoch 15
    Data Time 2.2180 (0.0059)
    Batch Time 122.6139 (0.3278)
    Learning Rate 0.0001
    Accuracy 0.8170 0.8170 0.8170 0.8170 0.8170 0.8170 0.8170
    Precision 0.8255 0.7513 0.6954 0.8913 0.7691 0.7555 0.7537
    Recall 0.8118 0.5534 0.5316 0.9256 0.7357 0.7067 0.8157
    F1 0.8186 0.6374 0.6025 0.9081 0.7520 0.7303 0.7835
    Acc_avg 0.8170 Prec_avg 0.7774 Recall_avg 0.7258 F1_avg 0.7475
    Total Loss 1.0384 Global Cls Loss 0.5196 Local Cls Loss 0.5188 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4204 (0.0045)
    Batch Time 18.9392 (0.2015)
    Learning Rate 0.0001
    Accuracy 0.7127 0.7127 0.7127 0.7127 0.7127 0.7127 0.7127
    Precision 0.7108 0.5625 0.3810 0.7998 0.7267 0.5687 0.6521
    Recall 0.7262 0.3971 0.3038 0.8839 0.4877 0.5687 0.7199
    F1 0.7184 0.4655 0.3380 0.8398 0.5837 0.5687 0.6843
Acc_avg 0.7127 Prec_avg 0.6288 Recall_avg 0.5839 F1_avg 0.5998
    Total Loss 1.6858 Global Cls Loss 0.8433 Local Cls Loss 0.8425 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0167 (0.0033)
    Batch Time 0.9642 (0.1928)
    Learning Rate 0.0001
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.1600 0.0000 0.0000 0.2500 0.1250 0.0000 0.2712
    Recall 0.1905 0.0000 0.0000 0.2917 0.0833 0.0000 0.4848
    F1 0.1739 0.0000 0.0000 0.2692 0.1000 0.0000 0.3478
Acc_avg 0.2171 Prec_avg 0.1152 Recall_avg 0.1500 F1_avg 0.1273
    Total Loss 3.6782 Global Cls Loss 1.8430 Local Cls Loss 1.8351 AFN Loss 0.0000

    [Train]: 
    Epoch 16
    Data Time 2.1047 (0.0056)
    Batch Time 121.6865 (0.3254)
    Learning Rate 0.0001
    Accuracy 0.8245 0.8245 0.8245 0.8245 0.8245 0.8245 0.8245
    Precision 0.8395 0.7789 0.6847 0.8974 0.7730 0.7843 0.7628
    Recall 0.8229 0.5916 0.5512 0.9256 0.7459 0.7625 0.8136
    F1 0.8311 0.6725 0.6107 0.9113 0.7592 0.7732 0.7873
    Acc_avg 0.8245 Prec_avg 0.7886 Recall_avg 0.7447 F1_avg 0.7636
    Total Loss 1.0144 Global Cls Loss 0.5079 Local Cls Loss 0.5065 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4068 (0.0043)
    Batch Time 20.6981 (0.2202)
    Learning Rate 0.0001
    Accuracy 0.7120 0.7120 0.7120 0.7120 0.7120 0.7120 0.7120
    Precision 0.7778 0.5254 0.4825 0.8123 0.6030 0.7377 0.6243
    Recall 0.6677 0.4559 0.3481 0.8719 0.5369 0.5625 0.7184
    F1 0.7185 0.4882 0.4044 0.8410 0.5680 0.6383 0.6681
Acc_avg 0.7120 Prec_avg 0.6519 Recall_avg 0.5945 F1_avg 0.6181
    Total Loss 1.7339 Global Cls Loss 0.8676 Local Cls Loss 0.8662 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0195 (0.0039)
    Batch Time 0.8132 (0.1626)
    Learning Rate 0.0001
    Accuracy 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481
    Precision 0.0000 0.0000 0.0000 0.2586 0.0000 0.0000 0.2833
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.5152
    F1 0.0000 0.0000 0.0000 0.3659 0.0000 0.0000 0.3656
Acc_avg 0.2481 Prec_avg 0.0774 Recall_avg 0.1629 F1_avg 0.1045
    Total Loss 3.7833 Global Cls Loss 1.8965 Local Cls Loss 1.8868 AFN Loss 0.0000

    [Train]: 
    Epoch 17
    Data Time 2.2489 (0.0060)
    Batch Time 131.9941 (0.3529)
    Learning Rate 0.0001
    Accuracy 0.8227 0.8227 0.8227 0.8227 0.8227 0.8227 0.8227
    Precision 0.8215 0.7586 0.6859 0.8938 0.7740 0.8307 0.7590
    Recall 0.7973 0.5878 0.5674 0.9233 0.7560 0.7845 0.8040
    F1 0.8092 0.6624 0.6211 0.9083 0.7649 0.8069 0.7808
    Acc_avg 0.8227 Prec_avg 0.7891 Recall_avg 0.7457 F1_avg 0.7648
    Total Loss 0.9734 Global Cls Loss 0.4866 Local Cls Loss 0.4867 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4026 (0.0043)
    Batch Time 18.6659 (0.1986)
    Learning Rate 0.0001
    Accuracy 0.7300 0.7300 0.7300 0.7300 0.7300 0.7300 0.7300
    Precision 0.7114 0.6364 0.4355 0.8433 0.6584 0.5838 0.6760
    Recall 0.7662 0.4118 0.3418 0.8779 0.5951 0.6312 0.6913
    F1 0.7378 0.5000 0.3830 0.8603 0.6251 0.6066 0.6835
Acc_avg 0.7300 Prec_avg 0.6493 Recall_avg 0.6165 F1_avg 0.6280
    Total Loss 1.6302 Global Cls Loss 0.8157 Local Cls Loss 0.8145 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0180 (0.0036)
    Batch Time 0.8059 (0.1612)
    Learning Rate 0.0001
    Accuracy 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868
    Precision 0.2632 0.0000 0.0000 0.3243 0.0000 0.1500 0.3469
    Recall 0.2381 0.0000 0.0000 0.5000 0.0000 0.2000 0.5152
    F1 0.2500 0.0000 0.0000 0.3934 0.0000 0.1714 0.4146
Acc_avg 0.2868 Prec_avg 0.1549 Recall_avg 0.2076 F1_avg 0.1756
    Total Loss 3.9679 Global Cls Loss 1.9895 Local Cls Loss 1.9784 AFN Loss 0.0000

    [Train]: 
    Epoch 18
    Data Time 2.4081 (0.0064)
    Batch Time 122.5348 (0.3276)
    Learning Rate 0.0001
    Accuracy 0.8392 0.8392 0.8392 0.8392 0.8392 0.8392 0.8392
    Precision 0.8610 0.7580 0.7324 0.9002 0.8039 0.8141 0.7781
    Recall 0.8364 0.6336 0.6152 0.9256 0.7702 0.7962 0.8267
    F1 0.8485 0.6902 0.6687 0.9127 0.7867 0.8050 0.8017
    Acc_avg 0.8392 Prec_avg 0.8068 Recall_avg 0.7720 F1_avg 0.7876
    Total Loss 0.9075 Global Cls Loss 0.4537 Local Cls Loss 0.4537 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3605 (0.0038)
    Batch Time 18.0836 (0.1924)
    Learning Rate 0.0001
    Accuracy 0.7407 0.7407 0.7407 0.7407 0.7407 0.7407 0.7407
    Precision 0.7645 0.7222 0.4015 0.8288 0.6784 0.6159 0.6970
    Recall 0.8092 0.3824 0.3481 0.8933 0.5615 0.5813 0.7274
    F1 0.7862 0.5000 0.3729 0.8598 0.6144 0.5981 0.7119
Acc_avg 0.7407 Prec_avg 0.6726 Recall_avg 0.6147 F1_avg 0.6348
    Total Loss 1.6477 Global Cls Loss 0.8243 Local Cls Loss 0.8233 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0191 (0.0038)
    Batch Time 0.8195 (0.1639)
    Learning Rate 0.0001
    Accuracy 0.3023 0.3023 0.3023 0.3023 0.3023 0.3023 0.3023
    Precision 0.0000 0.0000 0.0000 0.3953 0.2857 0.0000 0.3448
    Recall 0.0000 0.0000 0.0000 0.7083 0.1667 0.0000 0.6061
    F1 0.0000 0.0000 0.0000 0.5075 0.2105 0.0000 0.4396
Acc_avg 0.3023 Prec_avg 0.1466 Recall_avg 0.2116 F1_avg 0.1654
    Total Loss 3.8426 Global Cls Loss 1.9144 Local Cls Loss 1.9282 AFN Loss 0.0000

    [Train]: 
    Epoch 19
    Data Time 2.1066 (0.0056)
    Batch Time 133.4646 (0.3569)
    Learning Rate 0.0001
    Accuracy 0.8417 0.8417 0.8417 0.8417 0.8417 0.8417 0.8417
    Precision 0.8384 0.7703 0.7210 0.9061 0.8107 0.8143 0.7873
    Recall 0.8364 0.6527 0.6208 0.9275 0.7745 0.7856 0.8316
    F1 0.8374 0.7066 0.6672 0.9167 0.7922 0.7997 0.8088
    Acc_avg 0.8417 Prec_avg 0.8069 Recall_avg 0.7756 F1_avg 0.7898
    Total Loss 0.8640 Global Cls Loss 0.4321 Local Cls Loss 0.4319 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3735 (0.0040)
    Batch Time 18.9562 (0.2017)
    Learning Rate 0.0001
    Accuracy 0.7197 0.7197 0.7197 0.7197 0.7197 0.7197 0.7197
    Precision 0.7730 0.7381 0.3333 0.8508 0.6273 0.5833 0.6866
    Recall 0.7231 0.4559 0.4367 0.8471 0.6890 0.6562 0.6235
    F1 0.7472 0.5636 0.3781 0.8490 0.6567 0.6176 0.6535
Acc_avg 0.7197 Prec_avg 0.6561 Recall_avg 0.6331 F1_avg 0.6380
    Total Loss 1.7174 Global Cls Loss 0.8612 Local Cls Loss 0.8563 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6331.

    Test Target: 
    Data Time 0.0205 (0.0041)
    Batch Time 0.9809 (0.1962)
    Learning Rate 0.0001
    Accuracy 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938
    Precision 0.0000 0.0000 0.0000 0.2500 0.0000 0.1579 0.2118
    Recall 0.0000 0.0000 0.0000 0.1667 0.0000 0.2000 0.5455
    F1 0.0000 0.0000 0.0000 0.2000 0.0000 0.1765 0.3051
Acc_avg 0.1938 Prec_avg 0.0885 Recall_avg 0.1303 F1_avg 0.0974
    Total Loss 4.2989 Global Cls Loss 2.1471 Local Cls Loss 2.1519 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 88.367195s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.902750s

    [Train]: 
    Epoch 20
    Data Time 2.2593 (0.0060)
    Batch Time 131.0641 (0.3504)
    Learning Rate 0.0001
    Accuracy 0.8501 0.8501 0.8501 0.8501 0.8501 0.8501 0.8501
    Precision 0.8629 0.7972 0.7291 0.9174 0.7952 0.8437 0.7946
    Recall 0.8650 0.6603 0.6494 0.9303 0.7809 0.8152 0.8304
    F1 0.8639 0.7223 0.6869 0.9238 0.7880 0.8292 0.8121
    Acc_avg 0.8501 Prec_avg 0.8200 Recall_avg 0.7902 F1_avg 0.8038
    Total Loss 0.8312 Global Cls Loss 0.4165 Local Cls Loss 0.4146 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.4584 (0.0049)
    Batch Time 18.1037 (0.1926)
    Learning Rate 0.0001
    Accuracy 0.7307 0.7307 0.7307 0.7307 0.7307 0.7307 0.7307
    Precision 0.7664 0.5849 0.4552 0.8500 0.6022 0.6258 0.6830
    Recall 0.7569 0.4559 0.3861 0.8617 0.6197 0.6375 0.6943
    F1 0.7616 0.5124 0.4178 0.8558 0.6108 0.6316 0.6886
Acc_avg 0.7307 Prec_avg 0.6525 Recall_avg 0.6303 F1_avg 0.6398
    Total Loss 1.6640 Global Cls Loss 0.8330 Local Cls Loss 0.8310 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0167 (0.0033)
    Batch Time 0.8069 (0.1614)
    Learning Rate 0.0001
    Accuracy 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705
    Precision 0.0690 0.0000 0.0000 1.0000 0.1111 0.0000 0.2381
    Recall 0.0952 0.0000 0.0000 0.2917 0.2500 0.0000 0.3030
    F1 0.0800 0.0000 0.0000 0.4516 0.1538 0.0000 0.2667
Acc_avg 0.1705 Prec_avg 0.2026 Recall_avg 0.1343 F1_avg 0.1360
    Total Loss 3.9835 Global Cls Loss 1.9993 Local Cls Loss 1.9842 AFN Loss 0.0000

    [Train]: 
    Epoch 21
    Data Time 2.2557 (0.0060)
    Batch Time 122.0681 (0.3264)
    Learning Rate 1e-05
    Accuracy 0.8966 0.8966 0.8966 0.8966 0.8966 0.8966 0.8966
    Precision 0.8885 0.8682 0.8245 0.9452 0.8711 0.8947 0.8501
    Recall 0.8991 0.7290 0.6985 0.9498 0.8646 0.8737 0.8994
    F1 0.8938 0.7925 0.7563 0.9475 0.8679 0.8841 0.8740
    Acc_avg 0.8966 Prec_avg 0.8775 Recall_avg 0.8449 F1_avg 0.8594
    Total Loss 0.5999 Global Cls Loss 0.2999 Local Cls Loss 0.3000 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3585 (0.0038)
    Batch Time 18.7222 (0.1992)
    Learning Rate 1e-05
    Accuracy 0.7514 0.7514 0.7514 0.7514 0.7514 0.7514 0.7514
    Precision 0.8127 0.6809 0.4412 0.8311 0.6804 0.6757 0.7048
    Recall 0.7477 0.4706 0.3797 0.8950 0.6667 0.6250 0.7048
    F1 0.7788 0.5565 0.4082 0.8618 0.6734 0.6494 0.7048
Acc_avg 0.7514 Prec_avg 0.6895 Recall_avg 0.6414 F1_avg 0.6619
    Total Loss 1.5523 Global Cls Loss 0.7770 Local Cls Loss 0.7753 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6414.

    Test Target: 
    Data Time 0.0188 (0.0038)
    Batch Time 0.8193 (0.1639)
    Learning Rate 1e-05
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.0000 0.0000 0.0000 0.4286 0.1875 0.0556 0.2750
    Recall 0.0000 0.0000 0.0000 0.5000 0.2500 0.1333 0.3333
    F1 0.0000 0.0000 0.0000 0.4615 0.2143 0.0784 0.3014
Acc_avg 0.2171 Prec_avg 0.1352 Recall_avg 0.1738 F1_avg 0.1508
    Total Loss 3.9421 Global Cls Loss 1.9709 Local Cls Loss 1.9712 AFN Loss 0.0000

    [Train]: 
    Epoch 22
    Data Time 2.2048 (0.0059)
    Batch Time 121.4305 (0.3247)
    Learning Rate 1e-05
    Accuracy 0.9159 0.9159 0.9159 0.9159 0.9159 0.9159 0.9159
    Precision 0.9343 0.8945 0.8639 0.9487 0.8963 0.9153 0.8750
    Recall 0.9142 0.8092 0.7658 0.9664 0.8763 0.9032 0.9091
    F1 0.9241 0.8497 0.8119 0.9575 0.8862 0.9092 0.8917
    Acc_avg 0.9159 Prec_avg 0.9040 Recall_avg 0.8777 F1_avg 0.8900
    Total Loss 0.5148 Global Cls Loss 0.2569 Local Cls Loss 0.2579 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3713 (0.0039)
    Batch Time 21.8766 (0.2327)
    Learning Rate 1e-05
    Accuracy 0.7544 0.7544 0.7544 0.7544 0.7544 0.7544 0.7544
    Precision 0.7692 0.7000 0.4692 0.8418 0.6682 0.7000 0.7123
    Recall 0.8000 0.5147 0.3861 0.8907 0.6667 0.6125 0.6973
    F1 0.7843 0.5932 0.4236 0.8656 0.6674 0.6533 0.7047
Acc_avg 0.7544 Prec_avg 0.6944 Recall_avg 0.6526 F1_avg 0.6703
    Total Loss 1.5342 Global Cls Loss 0.7681 Local Cls Loss 0.7661 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6526.

    Test Target: 
    Data Time 0.0232 (0.0046)
    Batch Time 0.9671 (0.1934)
    Learning Rate 1e-05
    Accuracy 0.2636 0.2636 0.2636 0.2636 0.2636 0.2636 0.2636
    Precision 0.2727 0.0000 0.0000 0.4516 0.1818 0.0476 0.2857
    Recall 0.1429 0.0000 0.0000 0.5833 0.3333 0.0667 0.3636
    F1 0.1875 0.0000 0.0000 0.5091 0.2353 0.0556 0.3200
Acc_avg 0.2636 Prec_avg 0.1771 Recall_avg 0.2128 F1_avg 0.1868
    Total Loss 3.9642 Global Cls Loss 1.9841 Local Cls Loss 1.9801 AFN Loss 0.0000

    [Train]: 
    Epoch 23
    Data Time 2.2052 (0.0059)
    Batch Time 125.4400 (0.3354)
    Learning Rate 1e-05
    Accuracy 0.9202 0.9202 0.9202 0.9202 0.9202 0.9202 0.9202
    Precision 0.9242 0.8875 0.8752 0.9534 0.9004 0.9237 0.8845
    Recall 0.9308 0.8161 0.7868 0.9611 0.8928 0.8871 0.9164
    F1 0.9275 0.8503 0.8287 0.9572 0.8966 0.9050 0.9002
    Acc_avg 0.9202 Prec_avg 0.9070 Recall_avg 0.8845 F1_avg 0.8951
    Total Loss 0.4783 Global Cls Loss 0.2387 Local Cls Loss 0.2396 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3583 (0.0038)
    Batch Time 18.6510 (0.1984)
    Learning Rate 1e-05
    Accuracy 0.7624 0.7624 0.7624 0.7624 0.7624 0.7624 0.7624
    Precision 0.8078 0.7255 0.4918 0.8393 0.6681 0.7133 0.7227
    Recall 0.7631 0.5441 0.3797 0.9052 0.6846 0.6375 0.7063
    F1 0.7848 0.6218 0.4286 0.8710 0.6762 0.6733 0.7144
Acc_avg 0.7624 Prec_avg 0.7098 Recall_avg 0.6601 F1_avg 0.6814
    Total Loss 1.5703 Global Cls Loss 0.7866 Local Cls Loss 0.7837 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6601.

    Test Target: 
    Data Time 0.0187 (0.0037)
    Batch Time 0.8199 (0.1640)
    Learning Rate 1e-05
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 0.1429 0.0000 0.0000 0.3784 0.0000 0.1304 0.2885
    Recall 0.0476 0.0000 0.0000 0.5833 0.0000 0.2000 0.4545
    F1 0.0714 0.0000 0.0000 0.4590 0.0000 0.1579 0.3529
Acc_avg 0.2558 Prec_avg 0.1343 Recall_avg 0.1836 F1_avg 0.1488
    Total Loss 4.1713 Global Cls Loss 2.0833 Local Cls Loss 2.0879 AFN Loss 0.0000

    [Train]: 
    Epoch 24
    Data Time 2.2051 (0.0059)
    Batch Time 127.7911 (0.3417)
    Learning Rate 1e-05
    Accuracy 0.9257 0.9257 0.9257 0.9257 0.9257 0.9257 0.9257
    Precision 0.9312 0.8780 0.8587 0.9574 0.9089 0.9394 0.8943
    Recall 0.9245 0.8244 0.7924 0.9656 0.9007 0.9339 0.9164
    F1 0.9279 0.8504 0.8242 0.9615 0.9048 0.9367 0.9052
    Acc_avg 0.9257 Prec_avg 0.9097 Recall_avg 0.8940 F1_avg 0.9015
    Total Loss 0.4404 Global Cls Loss 0.2198 Local Cls Loss 0.2206 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4033 (0.0043)
    Batch Time 20.0418 (0.2132)
    Learning Rate 1e-05
    Accuracy 0.7618 0.7618 0.7618 0.7618 0.7618 0.7618 0.7618
    Precision 0.7937 0.6875 0.4305 0.8473 0.6836 0.7279 0.7269
    Recall 0.7815 0.4853 0.4114 0.8958 0.6913 0.6188 0.7093
    F1 0.7876 0.5690 0.4207 0.8709 0.6874 0.6689 0.7180
Acc_avg 0.7618 Prec_avg 0.6996 Recall_avg 0.6562 F1_avg 0.6746
    Total Loss 1.5655 Global Cls Loss 0.7844 Local Cls Loss 0.7811 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0170 (0.0034)
    Batch Time 0.9453 (0.1891)
    Learning Rate 1e-05
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 0.2857 0.0000 0.0000 0.3400 0.0000 0.1111 0.2727
    Recall 0.0952 0.0000 0.0000 0.7083 0.0000 0.1333 0.3636
    F1 0.1429 0.0000 0.0000 0.4595 0.0000 0.1212 0.3117
Acc_avg 0.2558 Prec_avg 0.1442 Recall_avg 0.1858 F1_avg 0.1479
    Total Loss 4.3642 Global Cls Loss 2.1815 Local Cls Loss 2.1828 AFN Loss 0.0000

    [Train]: 
    Epoch 25
    Data Time 2.2766 (0.0061)
    Batch Time 124.0169 (0.3316)
    Learning Rate 1e-05
    Accuracy 0.9335 0.9335 0.9335 0.9335 0.9335 0.9335 0.9335
    Precision 0.9369 0.9180 0.8827 0.9606 0.9172 0.9530 0.9023
    Recall 0.9324 0.8550 0.8233 0.9734 0.9065 0.9223 0.9217
    F1 0.9347 0.8854 0.8520 0.9670 0.9119 0.9374 0.9119
    Acc_avg 0.9335 Prec_avg 0.9244 Recall_avg 0.9049 F1_avg 0.9143
    Total Loss 0.4086 Global Cls Loss 0.2042 Local Cls Loss 0.2045 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3630 (0.0039)
    Batch Time 17.9694 (0.1912)
    Learning Rate 1e-05
    Accuracy 0.7618 0.7618 0.7618 0.7618 0.7618 0.7618 0.7618
    Precision 0.8339 0.6923 0.4627 0.8292 0.6840 0.7603 0.7158
    Recall 0.7569 0.5294 0.3924 0.9120 0.6488 0.5750 0.7319
    F1 0.7935 0.6000 0.4247 0.8686 0.6659 0.6548 0.7238
Acc_avg 0.7618 Prec_avg 0.7112 Recall_avg 0.6495 F1_avg 0.6759
    Total Loss 1.6139 Global Cls Loss 0.8088 Local Cls Loss 0.8052 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0190 (0.0038)
    Batch Time 0.8205 (0.1641)
    Learning Rate 1e-05
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 0.6667 0.0000 0.0000 0.2881 0.0000 0.0000 0.2619
    Recall 0.0952 0.0000 0.0000 0.7083 0.0000 0.0000 0.3333
    F1 0.1667 0.0000 0.0000 0.4096 0.0000 0.0000 0.2933
Acc_avg 0.2326 Prec_avg 0.1738 Recall_avg 0.1624 F1_avg 0.1242
    Total Loss 4.5713 Global Cls Loss 2.2824 Local Cls Loss 2.2889 AFN Loss 0.0000

    [Train]: 
    Epoch 26
    Data Time 2.4365 (0.0065)
    Batch Time 139.2120 (0.3722)
    Learning Rate 1e-05
    Accuracy 0.9367 0.9367 0.9367 0.9367 0.9367 0.9367 0.9367
    Precision 0.9483 0.9383 0.8840 0.9629 0.9212 0.9503 0.9038
    Recall 0.9333 0.8702 0.8443 0.9724 0.9114 0.9279 0.9262
    F1 0.9408 0.9030 0.8637 0.9676 0.9163 0.9390 0.9148
    Acc_avg 0.9367 Prec_avg 0.9298 Recall_avg 0.9122 F1_avg 0.9207
    Total Loss 0.3734 Global Cls Loss 0.1859 Local Cls Loss 0.1875 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4434 (0.0047)
    Batch Time 18.0619 (0.1921)
    Learning Rate 1e-05
    Accuracy 0.7611 0.7611 0.7611 0.7611 0.7611 0.7611 0.7611
    Precision 0.8257 0.7619 0.4420 0.8553 0.6645 0.7348 0.7013
    Recall 0.7723 0.4706 0.3861 0.8881 0.6957 0.6062 0.7319
    F1 0.7981 0.5818 0.4122 0.8714 0.6798 0.6644 0.7163
Acc_avg 0.7611 Prec_avg 0.7122 Recall_avg 0.6501 F1_avg 0.6748
    Total Loss 1.6098 Global Cls Loss 0.8073 Local Cls Loss 0.8025 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0173 (0.0035)
    Batch Time 0.8075 (0.1615)
    Learning Rate 1e-05
    Accuracy 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713
    Precision 0.2857 0.0000 0.0000 0.3421 0.0000 0.1000 0.3396
    Recall 0.0952 0.0000 0.0000 0.5417 0.0000 0.1333 0.5455
    F1 0.1429 0.0000 0.0000 0.4194 0.0000 0.1143 0.4186
Acc_avg 0.2713 Prec_avg 0.1525 Recall_avg 0.1880 F1_avg 0.1564
    Total Loss 4.3906 Global Cls Loss 2.1945 Local Cls Loss 2.1962 AFN Loss 0.0000

    [Train]: 
    Epoch 27
    Data Time 2.1698 (0.0058)
    Batch Time 132.8950 (0.3553)
    Learning Rate 1e-05
    Accuracy 0.9392 0.9392 0.9392 0.9392 0.9392 0.9392 0.9392
    Precision 0.9487 0.9295 0.8854 0.9649 0.9246 0.9398 0.9119
    Recall 0.9404 0.8550 0.8357 0.9747 0.9178 0.9164 0.9323
    F1 0.9445 0.8907 0.8598 0.9698 0.9212 0.9280 0.9220
    Acc_avg 0.9392 Prec_avg 0.9293 Recall_avg 0.9103 F1_avg 0.9194
    Total Loss 0.3639 Global Cls Loss 0.1815 Local Cls Loss 0.1824 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4176 (0.0044)
    Batch Time 19.5225 (0.2077)
    Learning Rate 1e-05
    Accuracy 0.7645 0.7645 0.7645 0.7645 0.7645 0.7645 0.7645
    Precision 0.8000 0.7174 0.4621 0.8523 0.6828 0.6774 0.7232
    Recall 0.7877 0.4853 0.3861 0.8967 0.6935 0.6562 0.7123
    F1 0.7938 0.5789 0.4207 0.8739 0.6881 0.6667 0.7178
Acc_avg 0.7645 Prec_avg 0.7022 Recall_avg 0.6597 F1_avg 0.6771
    Total Loss 1.6372 Global Cls Loss 0.8210 Local Cls Loss 0.8163 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0187 (0.0037)
    Batch Time 0.8230 (0.1646)
    Learning Rate 1e-05
    Accuracy 0.2946 0.2946 0.2946 0.2946 0.2946 0.2946 0.2946
    Precision 0.4000 0.0000 0.0000 0.3559 0.0000 0.2143 0.2927
    Recall 0.0952 0.0000 0.0000 0.8750 0.0000 0.2000 0.3636
    F1 0.1538 0.0000 0.0000 0.5060 0.0000 0.2069 0.3243
Acc_avg 0.2946 Prec_avg 0.1804 Recall_avg 0.2191 F1_avg 0.1702
    Total Loss 4.7365 Global Cls Loss 2.3695 Local Cls Loss 2.3671 AFN Loss 0.0000

    [Train]: 
    Epoch 28
    Data Time 2.1061 (0.0056)
    Batch Time 124.4914 (0.3329)
    Learning Rate 1e-05
    Accuracy 0.9413 0.9413 0.9413 0.9413 0.9413 0.9413 0.9413
    Precision 0.9459 0.9200 0.8997 0.9655 0.9319 0.9463 0.9123
    Recall 0.9436 0.8779 0.8429 0.9751 0.9151 0.9311 0.9338
    F1 0.9447 0.8984 0.8704 0.9703 0.9234 0.9387 0.9230
    Acc_avg 0.9413 Prec_avg 0.9317 Recall_avg 0.9171 F1_avg 0.9241
    Total Loss 0.3491 Global Cls Loss 0.1742 Local Cls Loss 0.1749 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3642 (0.0039)
    Batch Time 18.2075 (0.1937)
    Learning Rate 1e-05
    Accuracy 0.7685 0.7685 0.7685 0.7685 0.7685 0.7685 0.7685
    Precision 0.8159 0.7333 0.4357 0.8669 0.7033 0.7192 0.6968
    Recall 0.7908 0.4853 0.3861 0.8958 0.6734 0.6562 0.7440
    F1 0.8031 0.5841 0.4094 0.8811 0.6880 0.6863 0.7196
Acc_avg 0.7685 Prec_avg 0.7102 Recall_avg 0.6617 F1_avg 0.6817
    Total Loss 1.6569 Global Cls Loss 0.8313 Local Cls Loss 0.8256 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6617.

    Test Target: 
    Data Time 0.0221 (0.0044)
    Batch Time 0.9798 (0.1960)
    Learning Rate 1e-05
    Accuracy 0.3333 0.3333 0.3333 0.3333 0.3333 0.3333 0.3333
    Precision 0.5000 0.0000 0.0000 0.4211 0.0000 0.1765 0.3492
    Recall 0.0952 0.0000 0.0000 0.6667 0.0000 0.2000 0.6667
    F1 0.1600 0.0000 0.0000 0.5161 0.0000 0.1875 0.4583
Acc_avg 0.3333 Prec_avg 0.2067 Recall_avg 0.2327 F1_avg 0.1889
    Total Loss 4.5553 Global Cls Loss 2.2773 Local Cls Loss 2.2779 AFN Loss 0.0000

    [Train]: 
    Epoch 29
    Data Time 2.0846 (0.0056)
    Batch Time 128.1161 (0.3426)
    Learning Rate 1e-05
    Accuracy 0.9455 0.9455 0.9455 0.9455 0.9455 0.9455 0.9455
    Precision 0.9528 0.9363 0.9069 0.9680 0.9237 0.9563 0.9241
    Recall 0.9468 0.8969 0.8471 0.9768 0.9315 0.9310 0.9335
    F1 0.9498 0.9162 0.8760 0.9724 0.9276 0.9435 0.9288
    Acc_avg 0.9455 Prec_avg 0.9383 Recall_avg 0.9234 F1_avg 0.9306
    Total Loss 0.3311 Global Cls Loss 0.1652 Local Cls Loss 0.1659 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4230 (0.0045)
    Batch Time 19.1346 (0.2036)
    Learning Rate 1e-05
    Accuracy 0.7681 0.7681 0.7681 0.7681 0.7681 0.7681 0.7681
    Precision 0.8158 0.7059 0.4683 0.8650 0.7041 0.6986 0.6957
    Recall 0.7631 0.5294 0.3734 0.8915 0.6868 0.6375 0.7575
    F1 0.7886 0.6050 0.4155 0.8780 0.6954 0.6667 0.7253
Acc_avg 0.7681 Prec_avg 0.7076 Recall_avg 0.6628 F1_avg 0.6821
    Total Loss 1.6862 Global Cls Loss 0.8463 Local Cls Loss 0.8399 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6628.

    Test Target: 
    Data Time 0.0249 (0.0050)
    Batch Time 0.9814 (0.1963)
    Learning Rate 1e-05
    Accuracy 0.2946 0.2946 0.2946 0.2946 0.2946 0.2946 0.2946
    Precision 0.6667 0.0000 0.0000 0.3235 0.0000 0.3000 0.2895
    Recall 0.0952 0.0000 0.0000 0.4583 0.0000 0.2000 0.6667
    F1 0.1667 0.0000 0.0000 0.3793 0.0000 0.2400 0.4037
Acc_avg 0.2946 Prec_avg 0.2257 Recall_avg 0.2029 F1_avg 0.1699
    Total Loss 4.8199 Global Cls Loss 2.4084 Local Cls Loss 2.4115 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 80.972795s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.799561s

    [Train]: 
    Epoch 30
    Data Time 2.6248 (0.0070)
    Batch Time 138.7081 (0.3709)
    Learning Rate 1e-05
    Accuracy 0.9484 0.9484 0.9484 0.9484 0.9484 0.9484 0.9484
    Precision 0.9526 0.9216 0.8996 0.9708 0.9385 0.9603 0.9243
    Recall 0.9579 0.8969 0.8668 0.9753 0.9310 0.9223 0.9415
    F1 0.9552 0.9091 0.8829 0.9731 0.9348 0.9409 0.9328
    Acc_avg 0.9484 Prec_avg 0.9382 Recall_avg 0.9274 F1_avg 0.9327
    Total Loss 0.3041 Global Cls Loss 0.1517 Local Cls Loss 0.1524 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3488 (0.0037)
    Batch Time 18.1166 (0.1927)
    Learning Rate 1e-05
    Accuracy 0.7614 0.7614 0.7614 0.7614 0.7614 0.7614 0.7614
    Precision 0.8625 0.7347 0.4507 0.8352 0.6930 0.7013 0.7067
    Recall 0.7138 0.5294 0.4051 0.9086 0.6667 0.6750 0.7184
    F1 0.7811 0.6154 0.4267 0.8703 0.6796 0.6879 0.7125
Acc_avg 0.7614 Prec_avg 0.7120 Recall_avg 0.6596 F1_avg 0.6819
    Total Loss 1.7098 Global Cls Loss 0.8586 Local Cls Loss 0.8512 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0170 (0.0034)
    Batch Time 0.8056 (0.1611)
    Learning Rate 1e-05
    Accuracy 0.3256 0.3256 0.3256 0.3256 0.3256 0.3256 0.3256
    Precision 0.6667 0.0000 0.0000 0.3902 0.0000 0.1333 0.3492
    Recall 0.0952 0.0000 0.0000 0.6667 0.0000 0.1333 0.6667
    F1 0.1667 0.0000 0.0000 0.4923 0.0000 0.1333 0.4583
Acc_avg 0.3256 Prec_avg 0.2199 Recall_avg 0.2231 F1_avg 0.1787
    Total Loss 4.9139 Global Cls Loss 2.4556 Local Cls Loss 2.4583 AFN Loss 0.0000

    [Train]: 
    Epoch 31
    Data Time 2.1352 (0.0057)
    Batch Time 124.0714 (0.3317)
    Learning Rate 1e-05
    Accuracy 0.9548 0.9548 0.9548 0.9548 0.9548 0.9548 0.9548
    Precision 0.9629 0.9465 0.9191 0.9763 0.9402 0.9511 0.9330
    Recall 0.9492 0.8779 0.8920 0.9804 0.9342 0.9413 0.9545
    F1 0.9560 0.9109 0.9053 0.9784 0.9372 0.9462 0.9436
    Acc_avg 0.9548 Prec_avg 0.9470 Recall_avg 0.9328 F1_avg 0.9397
    Total Loss 0.2839 Global Cls Loss 0.1413 Local Cls Loss 0.1425 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3771 (0.0040)
    Batch Time 18.7040 (0.1990)
    Learning Rate 1e-05
    Accuracy 0.7661 0.7661 0.7661 0.7661 0.7661 0.7661 0.7661
    Precision 0.8141 0.7391 0.4286 0.8634 0.6948 0.6835 0.7116
    Recall 0.7815 0.5000 0.3987 0.8907 0.6823 0.6750 0.7319
    F1 0.7975 0.5965 0.4131 0.8768 0.6885 0.6792 0.7216
Acc_avg 0.7661 Prec_avg 0.7050 Recall_avg 0.6657 F1_avg 0.6819
    Total Loss 1.6853 Global Cls Loss 0.8466 Local Cls Loss 0.8386 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6657.

    Test Target: 
    Data Time 0.0743 (0.0149)
    Batch Time 0.8221 (0.1644)
    Learning Rate 1e-05
    Accuracy 0.2946 0.2946 0.2946 0.2946 0.2946 0.2946 0.2946
    Precision 0.5000 0.0000 0.0000 0.3231 0.0000 0.2857 0.2766
    Recall 0.0952 0.0000 0.0000 0.8750 0.0000 0.1333 0.3939
    F1 0.1600 0.0000 0.0000 0.4719 0.0000 0.1818 0.3250
Acc_avg 0.2946 Prec_avg 0.1979 Recall_avg 0.2139 F1_avg 0.1627
    Total Loss 4.8017 Global Cls Loss 2.4003 Local Cls Loss 2.4014 AFN Loss 0.0000

    [Train]: 
    Epoch 32
    Data Time 2.2197 (0.0059)
    Batch Time 123.4797 (0.3302)
    Learning Rate 1e-05
    Accuracy 0.9507 0.9507 0.9507 0.9507 0.9507 0.9507 0.9507
    Precision 0.9450 0.9675 0.9013 0.9740 0.9349 0.9481 0.9341
    Recall 0.9563 0.9084 0.8710 0.9779 0.9289 0.9384 0.9436
    F1 0.9506 0.9370 0.8859 0.9759 0.9319 0.9433 0.9388
    Acc_avg 0.9507 Prec_avg 0.9436 Recall_avg 0.9321 F1_avg 0.9376
    Total Loss 0.2959 Global Cls Loss 0.1474 Local Cls Loss 0.1485 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3970 (0.0042)
    Batch Time 17.9427 (0.1909)
    Learning Rate 1e-05
    Accuracy 0.7624 0.7624 0.7624 0.7624 0.7624 0.7624 0.7624
    Precision 0.7931 0.6667 0.4565 0.8344 0.7024 0.7027 0.7309
    Recall 0.7785 0.5000 0.3987 0.9078 0.6600 0.6500 0.7078
    F1 0.7857 0.5714 0.4257 0.8695 0.6805 0.6753 0.7192
Acc_avg 0.7624 Prec_avg 0.6981 Recall_avg 0.6575 F1_avg 0.6753
    Total Loss 1.7278 Global Cls Loss 0.8681 Local Cls Loss 0.8597 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0233 (0.0047)
    Batch Time 0.8311 (0.1662)
    Learning Rate 1e-05
    Accuracy 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868
    Precision 1.0000 0.0000 0.0000 0.2877 0.1250 0.1667 0.2895
    Recall 0.1429 0.0000 0.0000 0.8750 0.0833 0.0667 0.3333
    F1 0.2500 0.0000 0.0000 0.4330 0.1000 0.0952 0.3099
Acc_avg 0.2868 Prec_avg 0.2670 Recall_avg 0.2145 F1_avg 0.1697
    Total Loss 5.5386 Global Cls Loss 2.7728 Local Cls Loss 2.7658 AFN Loss 0.0000

    [Train]: 
    Epoch 33
    Data Time 2.3211 (0.0062)
    Batch Time 122.6301 (0.3279)
    Learning Rate 1e-05
    Accuracy 0.9557 0.9557 0.9557 0.9557 0.9557 0.9557 0.9557
    Precision 0.9619 0.9368 0.9467 0.9748 0.9325 0.9657 0.9357
    Recall 0.9626 0.9046 0.8962 0.9802 0.9374 0.9487 0.9440
    F1 0.9623 0.9204 0.9207 0.9775 0.9349 0.9571 0.9398
    Acc_avg 0.9557 Prec_avg 0.9506 Recall_avg 0.9391 F1_avg 0.9447
    Total Loss 0.2697 Global Cls Loss 0.1346 Local Cls Loss 0.1350 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3658 (0.0039)
    Batch Time 18.1106 (0.1927)
    Learning Rate 1e-05
    Accuracy 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591
    Precision 0.8094 0.6939 0.4567 0.8186 0.7277 0.7047 0.7126
    Recall 0.7446 0.5000 0.3671 0.9172 0.6219 0.6562 0.7244
    F1 0.7756 0.5812 0.4070 0.8651 0.6707 0.6796 0.7184
Acc_avg 0.7591 Prec_avg 0.7034 Recall_avg 0.6473 F1_avg 0.6711
    Total Loss 1.8044 Global Cls Loss 0.9068 Local Cls Loss 0.8976 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0178 (0.0036)
    Batch Time 0.7978 (0.1596)
    Learning Rate 1e-05
    Accuracy 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791
    Precision 0.6667 0.0000 0.0000 0.2985 0.0000 0.2000 0.2600
    Recall 0.0952 0.0000 0.0000 0.8333 0.0000 0.0667 0.3939
    F1 0.1667 0.0000 0.0000 0.4396 0.0000 0.1000 0.3133
Acc_avg 0.2791 Prec_avg 0.2036 Recall_avg 0.1985 F1_avg 0.1456
    Total Loss 5.7706 Global Cls Loss 2.8925 Local Cls Loss 2.8781 AFN Loss 0.0000

    [Train]: 
    Epoch 34
    Data Time 2.1075 (0.0056)
    Batch Time 121.9333 (0.3260)
    Learning Rate 1e-05
    Accuracy 0.9570 0.9570 0.9570 0.9570 0.9570 0.9570 0.9570
    Precision 0.9704 0.9510 0.9305 0.9745 0.9427 0.9584 0.9353
    Recall 0.9619 0.8893 0.9031 0.9817 0.9337 0.9471 0.9505
    F1 0.9661 0.9191 0.9166 0.9781 0.9382 0.9527 0.9428
    Acc_avg 0.9570 Prec_avg 0.9518 Recall_avg 0.9382 F1_avg 0.9448
    Total Loss 0.2574 Global Cls Loss 0.1283 Local Cls Loss 0.1291 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4466 (0.0048)
    Batch Time 18.2248 (0.1939)
    Learning Rate 1e-05
    Accuracy 0.7614 0.7614 0.7614 0.7614 0.7614 0.7614 0.7614
    Precision 0.8101 0.6600 0.4161 0.8460 0.6898 0.7000 0.7232
    Recall 0.7877 0.4853 0.3924 0.9052 0.6667 0.6562 0.7003
    F1 0.7988 0.5593 0.4039 0.8746 0.6780 0.6774 0.7116
Acc_avg 0.7614 Prec_avg 0.6922 Recall_avg 0.6563 F1_avg 0.6719
    Total Loss 1.7683 Global Cls Loss 0.8890 Local Cls Loss 0.8794 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0223 (0.0045)
    Batch Time 0.7976 (0.1595)
    Learning Rate 1e-05
    Accuracy 0.3101 0.3101 0.3101 0.3101 0.3101 0.3101 0.3101
    Precision 0.7500 0.0000 0.0000 0.3333 0.1818 0.2857 0.2791
    Recall 0.1429 0.0000 0.0000 0.8750 0.1667 0.1333 0.3636
    F1 0.2400 0.0000 0.0000 0.4828 0.1739 0.1818 0.3158
Acc_avg 0.3101 Prec_avg 0.2614 Recall_avg 0.2402 F1_avg 0.1992
    Total Loss 5.1046 Global Cls Loss 2.5574 Local Cls Loss 2.5472 AFN Loss 0.0000

    [Train]: 
    Epoch 35
    Data Time 2.4874 (0.0067)
    Batch Time 122.9150 (0.3286)
    Learning Rate 1e-05
    Accuracy 0.9590 0.9590 0.9590 0.9590 0.9590 0.9590 0.9590
    Precision 0.9582 0.9407 0.9233 0.9787 0.9508 0.9617 0.9393
    Recall 0.9643 0.9119 0.8948 0.9790 0.9438 0.9560 0.9541
    F1 0.9612 0.9261 0.9088 0.9789 0.9473 0.9588 0.9466
    Acc_avg 0.9590 Prec_avg 0.9504 Recall_avg 0.9434 F1_avg 0.9468
    Total Loss 0.2520 Global Cls Loss 0.1256 Local Cls Loss 0.1264 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4579 (0.0049)
    Batch Time 18.8088 (0.2001)
    Learning Rate 1e-05
    Accuracy 0.7598 0.7598 0.7598 0.7598 0.7598 0.7598 0.7598
    Precision 0.8000 0.6957 0.4400 0.8491 0.7032 0.7103 0.6971
    Recall 0.7754 0.4706 0.4177 0.9035 0.6309 0.6438 0.7244
    F1 0.7875 0.5614 0.4286 0.8755 0.6651 0.6754 0.7105
Acc_avg 0.7598 Prec_avg 0.6994 Recall_avg 0.6523 F1_avg 0.6720
    Total Loss 1.7862 Global Cls Loss 0.8980 Local Cls Loss 0.8882 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0230 (0.0046)
    Batch Time 0.8094 (0.1619)
    Learning Rate 1e-05
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 1.0000 0.0000 0.0000 0.2857 0.0000 0.0000 0.2500
    Recall 0.0952 0.0000 0.0000 0.6667 0.0000 0.0000 0.4545
    F1 0.1739 0.0000 0.0000 0.4000 0.0000 0.0000 0.3226
Acc_avg 0.2558 Prec_avg 0.2194 Recall_avg 0.1738 F1_avg 0.1281
    Total Loss 5.3169 Global Cls Loss 2.6673 Local Cls Loss 2.6496 AFN Loss 0.0000

    [Train]: 
    Epoch 36
    Data Time 2.3351 (0.0062)
    Batch Time 126.5584 (0.3384)
    Learning Rate 1e-05
    Accuracy 0.9599 0.9599 0.9599 0.9599 0.9599 0.9599 0.9599
    Precision 0.9689 0.9672 0.9437 0.9746 0.9436 0.9601 0.9433
    Recall 0.9658 0.9008 0.8934 0.9851 0.9406 0.9530 0.9509
    F1 0.9674 0.9328 0.9179 0.9798 0.9421 0.9565 0.9471
    Acc_avg 0.9599 Prec_avg 0.9573 Recall_avg 0.9414 F1_avg 0.9491
    Total Loss 0.2439 Global Cls Loss 0.1213 Local Cls Loss 0.1226 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4100 (0.0044)
    Batch Time 18.2576 (0.1942)
    Learning Rate 1e-05
    Accuracy 0.7621 0.7621 0.7621 0.7621 0.7621 0.7621 0.7621
    Precision 0.7994 0.7333 0.4326 0.8695 0.6815 0.7047 0.6922
    Recall 0.7723 0.4853 0.3861 0.8933 0.6846 0.6562 0.7214
    F1 0.7856 0.5841 0.4080 0.8812 0.6830 0.6796 0.7065
Acc_avg 0.7621 Prec_avg 0.7019 Recall_avg 0.6570 F1_avg 0.6754
    Total Loss 1.7856 Global Cls Loss 0.8979 Local Cls Loss 0.8877 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0211 (0.0042)
    Batch Time 0.7862 (0.1572)
    Learning Rate 1e-05
    Accuracy 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713
    Precision 0.6667 0.0000 0.0000 0.2750 0.0000 0.2500 0.2917
    Recall 0.0952 0.0000 0.0000 0.4583 0.0000 0.0667 0.6364
    F1 0.1667 0.0000 0.0000 0.3437 0.0000 0.1053 0.4000
Acc_avg 0.2713 Prec_avg 0.2119 Recall_avg 0.1795 F1_avg 0.1451
    Total Loss 5.2910 Global Cls Loss 2.6531 Local Cls Loss 2.6379 AFN Loss 0.0000

    [Train]: 
    Epoch 37
    Data Time 2.3010 (0.0062)
    Batch Time 123.6700 (0.3307)
    Learning Rate 1e-05
    Accuracy 0.9593 0.9593 0.9593 0.9593 0.9593 0.9593 0.9593
    Precision 0.9618 0.9385 0.9397 0.9752 0.9475 0.9583 0.9447
    Recall 0.9587 0.9313 0.9173 0.9792 0.9485 0.9428 0.9497
    F1 0.9602 0.9349 0.9283 0.9772 0.9480 0.9505 0.9472
    Acc_avg 0.9593 Prec_avg 0.9522 Recall_avg 0.9468 F1_avg 0.9495
    Total Loss 0.2379 Global Cls Loss 0.1183 Local Cls Loss 0.1196 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4531 (0.0048)
    Batch Time 18.2721 (0.1944)
    Learning Rate 1e-05
    Accuracy 0.7604 0.7604 0.7604 0.7604 0.7604 0.7604 0.7604
    Precision 0.7704 0.7021 0.4508 0.8584 0.6834 0.6752 0.7081
    Recall 0.7846 0.4853 0.3481 0.8958 0.6711 0.6625 0.7199
    F1 0.7774 0.5739 0.3929 0.8767 0.6772 0.6688 0.7140
Acc_avg 0.7604 Prec_avg 0.6926 Recall_avg 0.6525 F1_avg 0.6687
    Total Loss 1.7870 Global Cls Loss 0.8989 Local Cls Loss 0.8881 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0197 (0.0039)
    Batch Time 0.7943 (0.1589)
    Learning Rate 1e-05
    Accuracy 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791
    Precision 0.6667 0.0000 0.0000 0.3214 0.0000 0.2857 0.2545
    Recall 0.0952 0.0000 0.0000 0.7500 0.0000 0.1333 0.4242
    F1 0.1667 0.0000 0.0000 0.4500 0.0000 0.1818 0.3182
Acc_avg 0.2791 Prec_avg 0.2183 Recall_avg 0.2004 F1_avg 0.1595
    Total Loss 5.3624 Global Cls Loss 2.6924 Local Cls Loss 2.6700 AFN Loss 0.0000

    [Train]: 
    Epoch 38
    Data Time 2.8165 (0.0075)
    Batch Time 137.7270 (0.3683)
    Learning Rate 1e-05
    Accuracy 0.9657 0.9657 0.9657 0.9657 0.9657 0.9657 0.9657
    Precision 0.9743 0.9609 0.9475 0.9800 0.9525 0.9605 0.9511
    Recall 0.9634 0.9389 0.9142 0.9811 0.9565 0.9619 0.9631
    F1 0.9688 0.9498 0.9306 0.9806 0.9545 0.9612 0.9571
    Acc_avg 0.9657 Prec_avg 0.9610 Recall_avg 0.9542 F1_avg 0.9575
    Total Loss 0.2245 Global Cls Loss 0.1118 Local Cls Loss 0.1127 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3682 (0.0039)
    Batch Time 18.2148 (0.1938)
    Learning Rate 1e-05
    Accuracy 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591
    Precision 0.8057 0.7174 0.3892 0.8490 0.6856 0.7067 0.7231
    Recall 0.7785 0.4853 0.4114 0.9026 0.6734 0.6625 0.6883
    F1 0.7919 0.5789 0.4000 0.8750 0.6795 0.6839 0.7052
Acc_avg 0.7591 Prec_avg 0.6967 Recall_avg 0.6574 F1_avg 0.6735
    Total Loss 1.8189 Global Cls Loss 0.9148 Local Cls Loss 0.9042 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0196 (0.0039)
    Batch Time 0.8089 (0.1618)
    Learning Rate 1e-05
    Accuracy 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868
    Precision 0.6667 0.0000 0.0000 0.2979 0.0000 0.2500 0.2857
    Recall 0.0952 0.0000 0.0000 0.5833 0.0000 0.0667 0.6061
    F1 0.1667 0.0000 0.0000 0.3944 0.0000 0.1053 0.3883
Acc_avg 0.2868 Prec_avg 0.2143 Recall_avg 0.1930 F1_avg 0.1507
    Total Loss 5.4391 Global Cls Loss 2.7283 Local Cls Loss 2.7108 AFN Loss 0.0000

    [Train]: 
    Epoch 39
    Data Time 2.1161 (0.0057)
    Batch Time 124.2282 (0.3322)
    Learning Rate 1e-05
    Accuracy 0.9652 0.9652 0.9652 0.9652 0.9652 0.9652 0.9652
    Precision 0.9615 0.9680 0.9507 0.9817 0.9535 0.9793 0.9446
    Recall 0.9722 0.9237 0.9201 0.9807 0.9475 0.9692 0.9619
    F1 0.9668 0.9453 0.9351 0.9812 0.9505 0.9742 0.9532
    Acc_avg 0.9652 Prec_avg 0.9628 Recall_avg 0.9536 F1_avg 0.9580
    Total Loss 0.2235 Global Cls Loss 0.1113 Local Cls Loss 0.1121 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3731 (0.0040)
    Batch Time 17.8749 (0.1902)
    Learning Rate 1e-05
    Accuracy 0.7541 0.7541 0.7541 0.7541 0.7541 0.7541 0.7541
    Precision 0.7706 0.7391 0.4079 0.8418 0.6871 0.6846 0.7170
    Recall 0.7754 0.5000 0.3924 0.9044 0.6532 0.6375 0.6867
    F1 0.7730 0.5965 0.4000 0.8720 0.6697 0.6602 0.7015
Acc_avg 0.7541 Prec_avg 0.6926 Recall_avg 0.6499 F1_avg 0.6676
    Total Loss 1.8307 Global Cls Loss 0.9207 Local Cls Loss 0.9100 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0196 (0.0039)
    Batch Time 0.7988 (0.1598)
    Learning Rate 1e-05
    Accuracy 0.2946 0.2946 0.2946 0.2946 0.2946 0.2946 0.2946
    Precision 0.6667 0.0000 0.0000 0.3171 0.0000 0.0000 0.2987
    Recall 0.0952 0.0000 0.0000 0.5417 0.0000 0.0000 0.6970
    F1 0.1667 0.0000 0.0000 0.4000 0.0000 0.0000 0.4182
Acc_avg 0.2946 Prec_avg 0.1832 Recall_avg 0.1906 F1_avg 0.1407
    Total Loss 5.5100 Global Cls Loss 2.7648 Local Cls Loss 2.7452 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 80.190856s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.558504s

    [Train]: 
    Epoch 40
    Data Time 2.2482 (0.0060)
    Batch Time 122.5877 (0.3278)
    Learning Rate 1e-05
    Accuracy 0.9692 0.9692 0.9692 0.9692 0.9692 0.9692 0.9692
    Precision 0.9644 0.9569 0.9554 0.9835 0.9585 0.9750 0.9560
    Recall 0.9674 0.9313 0.9313 0.9866 0.9565 0.9707 0.9611
    F1 0.9659 0.9439 0.9432 0.9850 0.9575 0.9728 0.9585
    Acc_avg 0.9692 Prec_avg 0.9642 Recall_avg 0.9578 F1_avg 0.9610
    Total Loss 0.2000 Global Cls Loss 0.0994 Local Cls Loss 0.1006 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3726 (0.0040)
    Batch Time 18.7610 (0.1996)
    Learning Rate 1e-05
    Accuracy 0.7578 0.7578 0.7578 0.7578 0.7578 0.7578 0.7578
    Precision 0.8182 0.6731 0.4286 0.8388 0.6969 0.6821 0.7156
    Recall 0.7477 0.5147 0.4177 0.9018 0.6532 0.6438 0.7123
    F1 0.7814 0.5833 0.4231 0.8691 0.6744 0.6624 0.7140
Acc_avg 0.7578 Prec_avg 0.6933 Recall_avg 0.6559 F1_avg 0.6725
    Total Loss 1.8508 Global Cls Loss 0.9309 Local Cls Loss 0.9199 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0180 (0.0036)
    Batch Time 0.8037 (0.1607)
    Learning Rate 1e-05
    Accuracy 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713
    Precision 1.0000 0.0000 0.0000 0.2807 0.0000 0.2000 0.2667
    Recall 0.0952 0.0000 0.0000 0.6667 0.0000 0.0667 0.4848
    F1 0.1739 0.0000 0.0000 0.3951 0.0000 0.1000 0.3441
Acc_avg 0.2713 Prec_avg 0.2496 Recall_avg 0.1876 F1_avg 0.1447
    Total Loss 5.3241 Global Cls Loss 2.6725 Local Cls Loss 2.6516 AFN Loss 0.0000

    [Train]: 
    Epoch 41
    Data Time 2.1410 (0.0057)
    Batch Time 130.7073 (0.3495)
    Learning Rate 1e-06
    Accuracy 0.9660 0.9660 0.9660 0.9660 0.9660 0.9660 0.9660
    Precision 0.9768 0.9603 0.9375 0.9787 0.9578 0.9705 0.9499
    Recall 0.9682 0.9237 0.9257 0.9849 0.9523 0.9677 0.9550
    F1 0.9725 0.9416 0.9315 0.9818 0.9550 0.9691 0.9524
    Acc_avg 0.9660 Prec_avg 0.9617 Recall_avg 0.9539 F1_avg 0.9577
    Total Loss 0.2006 Global Cls Loss 0.0998 Local Cls Loss 0.1007 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3648 (0.0039)
    Batch Time 18.1225 (0.1928)
    Learning Rate 1e-06
    Accuracy 0.7584 0.7584 0.7584 0.7584 0.7584 0.7584 0.7584
    Precision 0.8039 0.6667 0.4317 0.8460 0.6957 0.6753 0.7104
    Recall 0.7569 0.5294 0.3797 0.8958 0.6801 0.6500 0.7093
    F1 0.7797 0.5902 0.4040 0.8702 0.6878 0.6624 0.7099
Acc_avg 0.7584 Prec_avg 0.6899 Recall_avg 0.6573 F1_avg 0.6720
    Total Loss 1.8435 Global Cls Loss 0.9274 Local Cls Loss 0.9161 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0206 (0.0041)
    Batch Time 0.7996 (0.1599)
    Learning Rate 1e-06
    Accuracy 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868
    Precision 1.0000 0.0000 0.0000 0.2963 0.0000 0.2500 0.2787
    Recall 0.0952 0.0000 0.0000 0.6667 0.0000 0.1333 0.5152
    F1 0.1739 0.0000 0.0000 0.4103 0.0000 0.1739 0.3617
Acc_avg 0.2868 Prec_avg 0.2607 Recall_avg 0.2015 F1_avg 0.1600
    Total Loss 5.3132 Global Cls Loss 2.6687 Local Cls Loss 2.6445 AFN Loss 0.0000

    [Train]: 
    Epoch 42
    Data Time 2.4970 (0.0067)
    Batch Time 133.3037 (0.3564)
    Learning Rate 1e-06
    Accuracy 0.9666 0.9666 0.9666 0.9666 0.9666 0.9666 0.9666
    Precision 0.9720 0.9558 0.9504 0.9787 0.9598 0.9733 0.9496
    Recall 0.9650 0.9084 0.9130 0.9872 0.9512 0.9604 0.9631
    F1 0.9685 0.9315 0.9313 0.9830 0.9555 0.9668 0.9563
    Acc_avg 0.9666 Prec_avg 0.9628 Recall_avg 0.9498 F1_avg 0.9561
    Total Loss 0.1960 Global Cls Loss 0.0975 Local Cls Loss 0.0985 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4288 (0.0046)
    Batch Time 17.9055 (0.1905)
    Learning Rate 1e-06
    Accuracy 0.7574 0.7574 0.7574 0.7574 0.7574 0.7574 0.7574
    Precision 0.8091 0.6792 0.4178 0.8502 0.6813 0.6667 0.7152
    Recall 0.7692 0.5294 0.3861 0.8915 0.6935 0.6500 0.6958
    F1 0.7886 0.5950 0.4013 0.8704 0.6874 0.6582 0.7053
Acc_avg 0.7574 Prec_avg 0.6885 Recall_avg 0.6594 F1_avg 0.6723
    Total Loss 1.8454 Global Cls Loss 0.9283 Local Cls Loss 0.9171 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0230 (0.0046)
    Batch Time 0.8079 (0.1616)
    Learning Rate 1e-06
    Accuracy 0.3023 0.3023 0.3023 0.3023 0.3023 0.3023 0.3023
    Precision 1.0000 0.0000 0.0000 0.3333 0.0000 0.2857 0.3065
    Recall 0.0952 0.0000 0.0000 0.6667 0.0000 0.1333 0.5758
    F1 0.1739 0.0000 0.0000 0.4444 0.0000 0.1818 0.4000
Acc_avg 0.3023 Prec_avg 0.2751 Recall_avg 0.2101 F1_avg 0.1715
    Total Loss 5.1046 Global Cls Loss 2.5624 Local Cls Loss 2.5422 AFN Loss 0.0000

    [Train]: 
    Epoch 43
    Data Time 2.3625 (0.0063)
    Batch Time 122.7963 (0.3283)
    Learning Rate 1e-06
    Accuracy 0.9693 0.9693 0.9693 0.9693 0.9693 0.9693 0.9693
    Precision 0.9760 0.9656 0.9524 0.9816 0.9604 0.9778 0.9520
    Recall 0.9682 0.9656 0.9270 0.9853 0.9522 0.9677 0.9651
    F1 0.9721 0.9656 0.9395 0.9835 0.9563 0.9727 0.9585
    Acc_avg 0.9693 Prec_avg 0.9665 Recall_avg 0.9616 F1_avg 0.9640
    Total Loss 0.1893 Global Cls Loss 0.0940 Local Cls Loss 0.0953 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5900 (0.0063)
    Batch Time 18.6039 (0.1979)
    Learning Rate 1e-06
    Accuracy 0.7608 0.7608 0.7608 0.7608 0.7608 0.7608 0.7608
    Precision 0.8032 0.6731 0.4286 0.8443 0.7005 0.6795 0.7154
    Recall 0.7785 0.5147 0.3608 0.8984 0.6801 0.6625 0.7078
    F1 0.7906 0.5833 0.3918 0.8705 0.6901 0.6709 0.7116
Acc_avg 0.7608 Prec_avg 0.6921 Recall_avg 0.6575 F1_avg 0.6727
    Total Loss 1.8331 Global Cls Loss 0.9220 Local Cls Loss 0.9111 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0201 (0.0040)
    Batch Time 0.8298 (0.1660)
    Learning Rate 1e-06
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 1.0000 0.0000 0.0000 0.2830 0.0000 0.2000 0.2414
    Recall 0.0952 0.0000 0.0000 0.6250 0.0000 0.1333 0.4242
    F1 0.1739 0.0000 0.0000 0.3896 0.0000 0.1600 0.3077
Acc_avg 0.2558 Prec_avg 0.2463 Recall_avg 0.1825 F1_avg 0.1473
    Total Loss 5.3265 Global Cls Loss 2.6746 Local Cls Loss 2.6519 AFN Loss 0.0000

    [Train]: 
    Epoch 44
    Data Time 2.4129 (0.0065)
    Batch Time 132.2864 (0.3537)
    Learning Rate 1e-06
    Accuracy 0.9693 0.9693 0.9693 0.9693 0.9693 0.9693 0.9693
    Precision 0.9585 0.9679 0.9437 0.9806 0.9624 0.9701 0.9657
    Recall 0.9730 0.9198 0.9173 0.9879 0.9639 0.9545 0.9606
    F1 0.9657 0.9432 0.9303 0.9842 0.9632 0.9623 0.9632
    Acc_avg 0.9693 Prec_avg 0.9641 Recall_avg 0.9539 F1_avg 0.9589
    Total Loss 0.1862 Global Cls Loss 0.0926 Local Cls Loss 0.0936 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3517 (0.0037)
    Batch Time 18.0590 (0.1921)
    Learning Rate 1e-06
    Accuracy 0.7574 0.7574 0.7574 0.7574 0.7574 0.7574 0.7574
    Precision 0.8182 0.6667 0.4317 0.8413 0.6978 0.6711 0.7039
    Recall 0.7754 0.5000 0.3797 0.9009 0.6510 0.6375 0.7123
    F1 0.7962 0.5714 0.4040 0.8701 0.6736 0.6538 0.7081
Acc_avg 0.7574 Prec_avg 0.6901 Recall_avg 0.6510 F1_avg 0.6682
    Total Loss 1.8507 Global Cls Loss 0.9308 Local Cls Loss 0.9199 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0165 (0.0033)
    Batch Time 0.7996 (0.1599)
    Learning Rate 1e-06
    Accuracy 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791
    Precision 1.0000 0.0000 0.0000 0.2667 0.0000 0.2857 0.2985
    Recall 0.0952 0.0000 0.0000 0.5000 0.0000 0.1333 0.6061
    F1 0.1739 0.0000 0.0000 0.3478 0.0000 0.1818 0.4000
Acc_avg 0.2791 Prec_avg 0.2644 Recall_avg 0.1907 F1_avg 0.1577
    Total Loss 5.3493 Global Cls Loss 2.6845 Local Cls Loss 2.6648 AFN Loss 0.0000

    [Train]: 
    Epoch 45
    Data Time 2.1755 (0.0058)
    Batch Time 130.4871 (0.3489)
    Learning Rate 1e-06
    Accuracy 0.9718 0.9718 0.9718 0.9718 0.9718 0.9718 0.9718
    Precision 0.9661 0.9457 0.9599 0.9829 0.9657 0.9735 0.9634
    Recall 0.9746 0.9313 0.9397 0.9892 0.9575 0.9677 0.9627
    F1 0.9703 0.9385 0.9497 0.9860 0.9616 0.9706 0.9631
    Acc_avg 0.9718 Prec_avg 0.9653 Recall_avg 0.9604 F1_avg 0.9628
    Total Loss 0.1838 Global Cls Loss 0.0914 Local Cls Loss 0.0924 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3559 (0.0038)
    Batch Time 18.0799 (0.1923)
    Learning Rate 1e-06
    Accuracy 0.7618 0.7618 0.7618 0.7618 0.7618 0.7618 0.7618
    Precision 0.8065 0.7143 0.4580 0.8265 0.7046 0.6908 0.7285
    Recall 0.7692 0.5147 0.3797 0.9155 0.6510 0.6562 0.7033
    F1 0.7874 0.5983 0.4152 0.8687 0.6767 0.6731 0.7157
Acc_avg 0.7618 Prec_avg 0.7042 Recall_avg 0.6557 F1_avg 0.6765
    Total Loss 1.8843 Global Cls Loss 0.9481 Local Cls Loss 0.9362 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0157 (0.0031)
    Batch Time 0.7945 (0.1589)
    Learning Rate 1e-06
    Accuracy 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868
    Precision 1.0000 0.0000 0.0000 0.2985 0.0000 0.1429 0.2800
    Recall 0.0952 0.0000 0.0000 0.8333 0.0000 0.0667 0.4242
    F1 0.1739 0.0000 0.0000 0.4396 0.0000 0.0909 0.3373
Acc_avg 0.2868 Prec_avg 0.2459 Recall_avg 0.2028 F1_avg 0.1488
    Total Loss 5.5144 Global Cls Loss 2.7711 Local Cls Loss 2.7433 AFN Loss 0.0000

    [Train]: 
    Epoch 46
    Data Time 2.0012 (0.0054)
    Batch Time 123.9784 (0.3315)
    Learning Rate 1e-06
    Accuracy 0.9710 0.9710 0.9710 0.9710 0.9710 0.9710 0.9710
    Precision 0.9720 0.9730 0.9499 0.9833 0.9624 0.9733 0.9589
    Recall 0.9642 0.9618 0.9299 0.9866 0.9650 0.9618 0.9647
    F1 0.9681 0.9674 0.9398 0.9849 0.9637 0.9675 0.9618
    Acc_avg 0.9710 Prec_avg 0.9675 Recall_avg 0.9620 F1_avg 0.9647
    Total Loss 0.1830 Global Cls Loss 0.0911 Local Cls Loss 0.0919 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4021 (0.0043)
    Batch Time 20.8681 (0.2220)
    Learning Rate 1e-06
    Accuracy 0.7581 0.7581 0.7581 0.7581 0.7581 0.7581 0.7581
    Precision 0.8125 0.6863 0.4400 0.8246 0.7024 0.6842 0.7189
    Recall 0.7600 0.5147 0.3481 0.9155 0.6443 0.6500 0.7048
    F1 0.7854 0.5882 0.3887 0.8677 0.6721 0.6667 0.7118
Acc_avg 0.7581 Prec_avg 0.6956 Recall_avg 0.6482 F1_avg 0.6686
    Total Loss 1.8916 Global Cls Loss 0.9515 Local Cls Loss 0.9400 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0201 (0.0040)
    Batch Time 0.9692 (0.1938)
    Learning Rate 1e-06
    Accuracy 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868 0.2868
    Precision 0.6667 0.0000 0.0000 0.3226 0.0000 0.1667 0.2456
    Recall 0.0952 0.0000 0.0000 0.8333 0.0000 0.0667 0.4242
    F1 0.1667 0.0000 0.0000 0.4651 0.0000 0.0952 0.3111
Acc_avg 0.2868 Prec_avg 0.2002 Recall_avg 0.2028 F1_avg 0.1483
    Total Loss 5.5504 Global Cls Loss 2.7875 Local Cls Loss 2.7628 AFN Loss 0.0000

    [Train]: 
    Epoch 47
    Data Time 2.1214 (0.0057)
    Batch Time 126.3069 (0.3377)
    Learning Rate 1e-06
    Accuracy 0.9704 0.9704 0.9704 0.9704 0.9704 0.9704 0.9704
    Precision 0.9721 0.9608 0.9578 0.9828 0.9595 0.9736 0.9580
    Recall 0.9698 0.9351 0.9229 0.9847 0.9549 0.9721 0.9724
    F1 0.9710 0.9478 0.9400 0.9838 0.9572 0.9729 0.9651
    Acc_avg 0.9704 Prec_avg 0.9664 Recall_avg 0.9588 F1_avg 0.9625
    Total Loss 0.1868 Global Cls Loss 0.0930 Local Cls Loss 0.0938 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4380 (0.0047)
    Batch Time 18.9666 (0.2018)
    Learning Rate 1e-06
    Accuracy 0.7641 0.7641 0.7641 0.7641 0.7641 0.7641 0.7641
    Precision 0.7879 0.7059 0.4167 0.8645 0.7005 0.6564 0.7241
    Recall 0.8000 0.5294 0.4114 0.8881 0.6801 0.6687 0.7154
    F1 0.7939 0.6050 0.4140 0.8762 0.6901 0.6625 0.7197
Acc_avg 0.7641 Prec_avg 0.6937 Recall_avg 0.6704 F1_avg 0.6802
    Total Loss 1.8457 Global Cls Loss 0.9286 Local Cls Loss 0.9170 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6704.

    Test Target: 
    Data Time 0.0195 (0.0039)
    Batch Time 0.9768 (0.1954)
    Learning Rate 1e-06
    Accuracy 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713
    Precision 0.5000 0.0000 0.0000 0.3056 0.0000 0.2143 0.2676
    Recall 0.0952 0.0000 0.0000 0.4583 0.0000 0.2000 0.5758
    F1 0.1600 0.0000 0.0000 0.3667 0.0000 0.2069 0.3654
Acc_avg 0.2713 Prec_avg 0.1839 Recall_avg 0.1899 F1_avg 0.1570
    Total Loss 5.1586 Global Cls Loss 2.5882 Local Cls Loss 2.5703 AFN Loss 0.0000

    [Train]: 
    Epoch 48
    Data Time 2.0790 (0.0056)
    Batch Time 126.6083 (0.3385)
    Learning Rate 1e-06
    Accuracy 0.9710 0.9710 0.9710 0.9710 0.9710 0.9710 0.9710
    Precision 0.9692 0.9640 0.9553 0.9808 0.9643 0.9736 0.9626
    Recall 0.9746 0.9198 0.9299 0.9889 0.9602 0.9721 0.9602
    F1 0.9719 0.9414 0.9424 0.9849 0.9622 0.9729 0.9614
    Acc_avg 0.9710 Prec_avg 0.9671 Recall_avg 0.9580 F1_avg 0.9624
    Total Loss 0.1801 Global Cls Loss 0.0894 Local Cls Loss 0.0907 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3661 (0.0039)
    Batch Time 18.6555 (0.1985)
    Learning Rate 1e-06
    Accuracy 0.7638 0.7638 0.7638 0.7638 0.7638 0.7638 0.7638
    Precision 0.7903 0.6481 0.4341 0.8689 0.6804 0.7071 0.7077
    Recall 0.8000 0.5147 0.3544 0.8830 0.7002 0.6188 0.7364
    F1 0.7951 0.5738 0.3902 0.8759 0.6902 0.6600 0.7218
Acc_avg 0.7638 Prec_avg 0.6910 Recall_avg 0.6582 F1_avg 0.6724
    Total Loss 1.8410 Global Cls Loss 0.9261 Local Cls Loss 0.9149 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0161 (0.0032)
    Batch Time 0.7980 (0.1596)
    Learning Rate 1e-06
    Accuracy 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713
    Precision 0.4000 0.0000 0.0000 0.2927 0.0000 0.2857 0.2714
    Recall 0.0952 0.0000 0.0000 0.5000 0.0000 0.1333 0.5758
    F1 0.1538 0.0000 0.0000 0.3692 0.0000 0.1818 0.3689
Acc_avg 0.2713 Prec_avg 0.1785 Recall_avg 0.1863 F1_avg 0.1534
    Total Loss 5.3212 Global Cls Loss 2.6710 Local Cls Loss 2.6502 AFN Loss 0.0000

    [Train]: 
    Epoch 49
    Data Time 2.1025 (0.0056)
    Batch Time 124.2646 (0.3323)
    Learning Rate 1e-06
    Accuracy 0.9727 0.9727 0.9727 0.9727 0.9727 0.9727 0.9727
    Precision 0.9768 0.9766 0.9424 0.9858 0.9633 0.9778 0.9598
    Recall 0.9690 0.9542 0.9424 0.9862 0.9618 0.9692 0.9688
    F1 0.9729 0.9653 0.9424 0.9860 0.9626 0.9735 0.9642
    Acc_avg 0.9727 Prec_avg 0.9689 Recall_avg 0.9645 F1_avg 0.9667
    Total Loss 0.1779 Global Cls Loss 0.0886 Local Cls Loss 0.0893 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4337 (0.0046)
    Batch Time 21.5772 (0.2295)
    Learning Rate 1e-06
    Accuracy 0.7608 0.7608 0.7608 0.7608 0.7608 0.7608 0.7608
    Precision 0.7968 0.6939 0.4189 0.8554 0.7064 0.6646 0.7090
    Recall 0.7723 0.5000 0.3924 0.8941 0.6622 0.6687 0.7229
    F1 0.7844 0.5812 0.4052 0.8743 0.6836 0.6667 0.7159
Acc_avg 0.7608 Prec_avg 0.6922 Recall_avg 0.6590 F1_avg 0.6730
    Total Loss 1.8441 Global Cls Loss 0.9278 Local Cls Loss 0.9163 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0202 (0.0040)
    Batch Time 0.8177 (0.1635)
    Learning Rate 1e-06
    Accuracy 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713
    Precision 0.5000 0.0000 0.0000 0.2927 0.0000 0.1667 0.2817
    Recall 0.0952 0.0000 0.0000 0.5000 0.0000 0.0667 0.6061
    F1 0.1600 0.0000 0.0000 0.3692 0.0000 0.0952 0.3846
Acc_avg 0.2713 Prec_avg 0.1773 Recall_avg 0.1811 F1_avg 0.1442
    Total Loss 5.3790 Global Cls Loss 2.6992 Local Cls Loss 2.6798 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 90.221641s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 14.008557s

    [Train]: 
    Epoch 50
    Data Time 2.3574 (0.0063)
    Batch Time 139.8143 (0.3738)
    Learning Rate 1e-06
    Accuracy 0.9724 0.9724 0.9724 0.9724 0.9724 0.9724 0.9724
    Precision 0.9711 0.9720 0.9612 0.9814 0.9707 0.9734 0.9602
    Recall 0.9603 0.9275 0.9383 0.9877 0.9660 0.9677 0.9704
    F1 0.9657 0.9492 0.9496 0.9845 0.9684 0.9705 0.9653
    Acc_avg 0.9724 Prec_avg 0.9700 Recall_avg 0.9597 F1_avg 0.9647
    Total Loss 0.1800 Global Cls Loss 0.0894 Local Cls Loss 0.0906 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3565 (0.0038)
    Batch Time 18.0087 (0.1916)
    Learning Rate 1e-06
    Accuracy 0.7621 0.7621 0.7621 0.7621 0.7621 0.7621 0.7621
    Precision 0.7758 0.6600 0.4531 0.8581 0.7105 0.6974 0.6970
    Recall 0.7877 0.4853 0.3671 0.8933 0.6532 0.6625 0.7380
    F1 0.7817 0.5593 0.4056 0.8753 0.6807 0.6795 0.7169
Acc_avg 0.7621 Prec_avg 0.6931 Recall_avg 0.6553 F1_avg 0.6713
    Total Loss 1.8461 Global Cls Loss 0.9289 Local Cls Loss 0.9172 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0199 (0.0040)
    Batch Time 0.7974 (0.1595)
    Learning Rate 1e-06
    Accuracy 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713
    Precision 0.5000 0.0000 0.0000 0.2927 0.0000 0.2857 0.2676
    Recall 0.0952 0.0000 0.0000 0.5000 0.0000 0.1333 0.5758
    F1 0.1600 0.0000 0.0000 0.3692 0.0000 0.1818 0.3654
Acc_avg 0.2713 Prec_avg 0.1923 Recall_avg 0.1863 F1_avg 0.1538
    Total Loss 5.3475 Global Cls Loss 2.6828 Local Cls Loss 2.6646 AFN Loss 0.0000

    [Train]: 
    Epoch 51
    Data Time 2.2936 (0.0061)
    Batch Time 123.8817 (0.3312)
    Learning Rate 1e-06
    Accuracy 0.9698 0.9698 0.9698 0.9698 0.9698 0.9698 0.9698
    Precision 0.9736 0.9727 0.9373 0.9799 0.9714 0.9748 0.9553
    Recall 0.9651 0.9540 0.9229 0.9849 0.9565 0.9633 0.9708
    F1 0.9693 0.9632 0.9300 0.9824 0.9639 0.9690 0.9630
    Acc_avg 0.9698 Prec_avg 0.9664 Recall_avg 0.9596 F1_avg 0.9630
    Total Loss 0.1829 Global Cls Loss 0.0909 Local Cls Loss 0.0920 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3651 (0.0039)
    Batch Time 18.0632 (0.1922)
    Learning Rate 1e-06
    Accuracy 0.7618 0.7618 0.7618 0.7618 0.7618 0.7618 0.7618
    Precision 0.7829 0.6415 0.4460 0.8449 0.7021 0.6903 0.7240
    Recall 0.7877 0.5000 0.3924 0.9026 0.6644 0.6687 0.7033
    F1 0.7853 0.5620 0.4175 0.8728 0.6828 0.6794 0.7135
Acc_avg 0.7618 Prec_avg 0.6903 Recall_avg 0.6599 F1_avg 0.6733
    Total Loss 1.8641 Global Cls Loss 0.9382 Local Cls Loss 0.9259 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0162 (0.0032)
    Batch Time 0.8031 (0.1606)
    Learning Rate 1e-06
    Accuracy 0.2636 0.2636 0.2636 0.2636 0.2636 0.2636 0.2636
    Precision 0.6667 0.0000 0.0000 0.3200 0.0000 0.2000 0.2333
    Recall 0.0952 0.0000 0.0000 0.6667 0.0000 0.1333 0.4242
    F1 0.1667 0.0000 0.0000 0.4324 0.0000 0.1600 0.3011
Acc_avg 0.2636 Prec_avg 0.2029 Recall_avg 0.1885 F1_avg 0.1515
    Total Loss 5.3900 Global Cls Loss 2.7062 Local Cls Loss 2.6837 AFN Loss 0.0000

    [Train]: 
    Epoch 52
    Data Time 2.2884 (0.0061)
    Batch Time 137.2107 (0.3669)
    Learning Rate 1e-06
    Accuracy 0.9713 0.9713 0.9713 0.9713 0.9713 0.9713 0.9713
    Precision 0.9715 0.9603 0.9379 0.9835 0.9658 0.9675 0.9642
    Recall 0.9762 0.9237 0.9537 0.9868 0.9592 0.9589 0.9623
    F1 0.9739 0.9416 0.9458 0.9851 0.9625 0.9632 0.9632
    Acc_avg 0.9713 Prec_avg 0.9644 Recall_avg 0.9601 F1_avg 0.9622
    Total Loss 0.1801 Global Cls Loss 0.0897 Local Cls Loss 0.0904 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3510 (0.0037)
    Batch Time 18.2205 (0.1938)
    Learning Rate 1e-06
    Accuracy 0.7624 0.7624 0.7624 0.7624 0.7624 0.7624 0.7624
    Precision 0.7981 0.6531 0.4326 0.8715 0.6993 0.6752 0.6960
    Recall 0.7785 0.4706 0.3861 0.8804 0.6711 0.6625 0.7515
    F1 0.7882 0.5470 0.4080 0.8760 0.6849 0.6688 0.7227
Acc_avg 0.7624 Prec_avg 0.6894 Recall_avg 0.6572 F1_avg 0.6708
    Total Loss 1.8556 Global Cls Loss 0.9337 Local Cls Loss 0.9218 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0206 (0.0041)
    Batch Time 0.9568 (0.1914)
    Learning Rate 1e-06
    Accuracy 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791
    Precision 1.0000 0.0000 0.0000 0.2750 0.0000 0.1667 0.2973
    Recall 0.0952 0.0000 0.0000 0.4583 0.0000 0.0667 0.6667
    F1 0.1739 0.0000 0.0000 0.3437 0.0000 0.0952 0.4112
Acc_avg 0.2791 Prec_avg 0.2484 Recall_avg 0.1838 F1_avg 0.1463
    Total Loss 5.3481 Global Cls Loss 2.6838 Local Cls Loss 2.6644 AFN Loss 0.0000

    [Train]: 
    Epoch 53
    Data Time 2.1889 (0.0059)
    Batch Time 128.9391 (0.3448)
    Learning Rate 1e-06
    Accuracy 0.9711 0.9711 0.9711 0.9711 0.9711 0.9711 0.9711
    Precision 0.9775 0.9648 0.9607 0.9832 0.9627 0.9750 0.9537
    Recall 0.9658 0.9427 0.9257 0.9860 0.9592 0.9736 0.9700
    F1 0.9716 0.9537 0.9429 0.9846 0.9609 0.9743 0.9618
    Acc_avg 0.9711 Prec_avg 0.9683 Recall_avg 0.9604 F1_avg 0.9643
    Total Loss 0.1811 Global Cls Loss 0.0898 Local Cls Loss 0.0913 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3714 (0.0040)
    Batch Time 21.7259 (0.2311)
    Learning Rate 1e-06
    Accuracy 0.7661 0.7661 0.7661 0.7661 0.7661 0.7661 0.7661
    Precision 0.7774 0.6809 0.4580 0.8488 0.7074 0.7000 0.7250
    Recall 0.8062 0.4706 0.3797 0.9009 0.6868 0.6562 0.7108
    F1 0.7915 0.5565 0.4152 0.8741 0.6969 0.6774 0.7179
Acc_avg 0.7661 Prec_avg 0.6996 Recall_avg 0.6588 F1_avg 0.6757
    Total Loss 1.8631 Global Cls Loss 0.9375 Local Cls Loss 0.9256 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0235 (0.0047)
    Batch Time 0.9077 (0.1815)
    Learning Rate 1e-06
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 0.6667 0.0000 0.0000 0.2963 0.0000 0.0000 0.2459
    Recall 0.0952 0.0000 0.0000 0.6667 0.0000 0.0000 0.4545
    F1 0.1667 0.0000 0.0000 0.4103 0.0000 0.0000 0.3191
Acc_avg 0.2558 Prec_avg 0.1727 Recall_avg 0.1738 F1_avg 0.1280
    Total Loss 5.6724 Global Cls Loss 2.8524 Local Cls Loss 2.8200 AFN Loss 0.0000

    [Train]: 
    Epoch 54
    Data Time 2.1768 (0.0058)
    Batch Time 124.6742 (0.3334)
    Learning Rate 1e-06
    Accuracy 0.9730 0.9730 0.9730 0.9730 0.9730 0.9730 0.9730
    Precision 0.9737 0.9658 0.9540 0.9841 0.9624 0.9821 0.9631
    Recall 0.9698 0.9695 0.9312 0.9887 0.9650 0.9677 0.9647
    F1 0.9717 0.9676 0.9424 0.9864 0.9637 0.9749 0.9639
    Acc_avg 0.9730 Prec_avg 0.9693 Recall_avg 0.9652 F1_avg 0.9672
    Total Loss 0.1689 Global Cls Loss 0.0840 Local Cls Loss 0.0849 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3718 (0.0040)
    Batch Time 18.5734 (0.1976)
    Learning Rate 1e-06
    Accuracy 0.7641 0.7641 0.7641 0.7641 0.7641 0.7641 0.7641
    Precision 0.8272 0.6800 0.4345 0.8631 0.6957 0.6795 0.7024
    Recall 0.7662 0.5000 0.3987 0.8881 0.6801 0.6625 0.7395
    F1 0.7955 0.5763 0.4158 0.8754 0.6878 0.6709 0.7205
Acc_avg 0.7641 Prec_avg 0.6975 Recall_avg 0.6622 F1_avg 0.6775
    Total Loss 1.8632 Global Cls Loss 0.9376 Local Cls Loss 0.9256 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0178 (0.0036)
    Batch Time 0.8034 (0.1607)
    Learning Rate 1e-06
    Accuracy 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791
    Precision 1.0000 0.0000 0.0000 0.2632 0.0000 0.2222 0.2933
    Recall 0.0952 0.0000 0.0000 0.4167 0.0000 0.1333 0.6667
    F1 0.1739 0.0000 0.0000 0.3226 0.0000 0.1667 0.4074
Acc_avg 0.2791 Prec_avg 0.2541 Recall_avg 0.1874 F1_avg 0.1529
    Total Loss 5.4541 Global Cls Loss 2.7385 Local Cls Loss 2.7156 AFN Loss 0.0000

    [Train]: 
    Epoch 55
    Data Time 2.1638 (0.0058)
    Batch Time 121.9018 (0.3259)
    Learning Rate 1e-06
    Accuracy 0.9722 0.9722 0.9722 0.9722 0.9722 0.9722 0.9722
    Precision 0.9761 0.9504 0.9466 0.9829 0.9626 0.9777 0.9651
    Recall 0.9722 0.9504 0.9453 0.9883 0.9565 0.9663 0.9651
    F1 0.9741 0.9504 0.9460 0.9856 0.9596 0.9720 0.9651
    Acc_avg 0.9722 Prec_avg 0.9659 Recall_avg 0.9634 F1_avg 0.9647
    Total Loss 0.1731 Global Cls Loss 0.0861 Local Cls Loss 0.0870 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3722 (0.0040)
    Batch Time 17.9814 (0.1913)
    Learning Rate 1e-06
    Accuracy 0.7621 0.7621 0.7621 0.7621 0.7621 0.7621 0.7621
    Precision 0.8045 0.7111 0.4314 0.8573 0.6923 0.6815 0.7128
    Recall 0.7723 0.4706 0.4177 0.8924 0.6846 0.6687 0.7139
    F1 0.7881 0.5664 0.4244 0.8745 0.6884 0.6751 0.7133
Acc_avg 0.7621 Prec_avg 0.6987 Recall_avg 0.6600 F1_avg 0.6757
    Total Loss 1.8591 Global Cls Loss 0.9356 Local Cls Loss 0.9235 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0169 (0.0034)
    Batch Time 0.7965 (0.1593)
    Learning Rate 1e-06
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 0.6667 0.0000 0.0000 0.2667 0.0000 0.3333 0.2500
    Recall 0.0952 0.0000 0.0000 0.5000 0.0000 0.1333 0.5152
    F1 0.1667 0.0000 0.0000 0.3478 0.0000 0.1905 0.3366
Acc_avg 0.2558 Prec_avg 0.2167 Recall_avg 0.1777 F1_avg 0.1488
    Total Loss 5.4225 Global Cls Loss 2.7224 Local Cls Loss 2.7001 AFN Loss 0.0000

    [Train]: 
    Epoch 56
    Data Time 2.2785 (0.0061)
    Batch Time 128.2467 (0.3429)
    Learning Rate 1e-06
    Accuracy 0.9730 0.9730 0.9730 0.9730 0.9730 0.9730 0.9730
    Precision 0.9677 0.9533 0.9437 0.9845 0.9644 0.9718 0.9711
    Recall 0.9746 0.9351 0.9397 0.9885 0.9634 0.9589 0.9675
    F1 0.9711 0.9441 0.9417 0.9865 0.9639 0.9653 0.9693
    Acc_avg 0.9730 Prec_avg 0.9652 Recall_avg 0.9611 F1_avg 0.9631
    Total Loss 0.1679 Global Cls Loss 0.0836 Local Cls Loss 0.0843 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4056 (0.0043)
    Batch Time 19.4631 (0.2071)
    Learning Rate 1e-06
    Accuracy 0.7611 0.7611 0.7611 0.7611 0.7611 0.7611 0.7611
    Precision 0.8158 0.7143 0.4662 0.8401 0.6747 0.6730 0.7273
    Recall 0.7631 0.5147 0.3924 0.9061 0.6913 0.6687 0.6867
    F1 0.7886 0.5983 0.4261 0.8718 0.6829 0.6708 0.7064
Acc_avg 0.7611 Prec_avg 0.7016 Recall_avg 0.6604 F1_avg 0.6778
    Total Loss 1.8841 Global Cls Loss 0.9483 Local Cls Loss 0.9358 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0186 (0.0037)
    Batch Time 0.8113 (0.1623)
    Learning Rate 1e-06
    Accuracy 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791
    Precision 1.0000 0.0000 0.0000 0.3016 0.0000 0.0000 0.2679
    Recall 0.0952 0.0000 0.0000 0.7917 0.0000 0.0000 0.4545
    F1 0.1739 0.0000 0.0000 0.4368 0.0000 0.0000 0.3371
Acc_avg 0.2791 Prec_avg 0.2242 Recall_avg 0.1916 F1_avg 0.1354
    Total Loss 5.7062 Global Cls Loss 2.8712 Local Cls Loss 2.8350 AFN Loss 0.0000

    [Train]: 
    Epoch 57
    Data Time 2.1740 (0.0058)
    Batch Time 127.7298 (0.3415)
    Learning Rate 1e-06
    Accuracy 0.9758 0.9758 0.9758 0.9758 0.9758 0.9758 0.9758
    Precision 0.9809 0.9718 0.9555 0.9860 0.9690 0.9807 0.9635
    Recall 0.9809 0.9198 0.9341 0.9898 0.9634 0.9692 0.9757
    F1 0.9809 0.9451 0.9447 0.9879 0.9662 0.9749 0.9696
    Acc_avg 0.9758 Prec_avg 0.9725 Recall_avg 0.9618 F1_avg 0.9670
    Total Loss 0.1600 Global Cls Loss 0.0794 Local Cls Loss 0.0806 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3765 (0.0040)
    Batch Time 18.2322 (0.1940)
    Learning Rate 1e-06
    Accuracy 0.7638 0.7638 0.7638 0.7638 0.7638 0.7638 0.7638
    Precision 0.7896 0.6875 0.4286 0.8688 0.6998 0.6626 0.7109
    Recall 0.7969 0.4853 0.3987 0.8822 0.6779 0.6750 0.7334
    F1 0.7933 0.5690 0.4131 0.8754 0.6886 0.6687 0.7220
Acc_avg 0.7638 Prec_avg 0.6925 Recall_avg 0.6642 F1_avg 0.6757
    Total Loss 1.8613 Global Cls Loss 0.9370 Local Cls Loss 0.9243 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0170 (0.0034)
    Batch Time 0.8063 (0.1613)
    Learning Rate 1e-06
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 0.5000 0.0000 0.0000 0.2500 0.0000 0.1818 0.2740
    Recall 0.0952 0.0000 0.0000 0.3750 0.0000 0.1333 0.6061
    F1 0.1600 0.0000 0.0000 0.3000 0.0000 0.1538 0.3774
Acc_avg 0.2558 Prec_avg 0.1723 Recall_avg 0.1728 F1_avg 0.1416
    Total Loss 5.2756 Global Cls Loss 2.6486 Local Cls Loss 2.6271 AFN Loss 0.0000

    [Train]: 
    Epoch 58
    Data Time 2.2672 (0.0061)
    Batch Time 122.1032 (0.3265)
    Learning Rate 1e-06
    Accuracy 0.9723 0.9723 0.9723 0.9723 0.9723 0.9723 0.9723
    Precision 0.9690 0.9504 0.9555 0.9851 0.9609 0.9747 0.9648
    Recall 0.9690 0.9504 0.9341 0.9866 0.9655 0.9619 0.9684
    F1 0.9690 0.9504 0.9447 0.9859 0.9632 0.9683 0.9666
    Acc_avg 0.9723 Prec_avg 0.9658 Recall_avg 0.9623 F1_avg 0.9640
    Total Loss 0.1718 Global Cls Loss 0.0853 Local Cls Loss 0.0865 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3748 (0.0040)
    Batch Time 19.3111 (0.2054)
    Learning Rate 1e-06
    Accuracy 0.7641 0.7641 0.7641 0.7641 0.7641 0.7641 0.7641
    Precision 0.8032 0.6731 0.4366 0.8873 0.6795 0.6730 0.6966
    Recall 0.7785 0.5147 0.3924 0.8676 0.7114 0.6687 0.7470
    F1 0.7906 0.5833 0.4133 0.8774 0.6951 0.6708 0.7209
Acc_avg 0.7641 Prec_avg 0.6928 Recall_avg 0.6686 F1_avg 0.6788
    Total Loss 1.8739 Global Cls Loss 0.9432 Local Cls Loss 0.9307 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0192 (0.0038)
    Batch Time 0.8004 (0.1601)
    Learning Rate 1e-06
    Accuracy 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791 0.2791
    Precision 0.5000 0.0000 0.0000 0.2727 0.0000 0.3000 0.2973
    Recall 0.0952 0.0000 0.0000 0.3750 0.0000 0.2000 0.6667
    F1 0.1600 0.0000 0.0000 0.3158 0.0000 0.2400 0.4112
Acc_avg 0.2791 Prec_avg 0.1957 Recall_avg 0.1910 F1_avg 0.1610
    Total Loss 5.2839 Global Cls Loss 2.6546 Local Cls Loss 2.6293 AFN Loss 0.0000

    [Train]: 
    Epoch 59
    Data Time 2.3008 (0.0062)
    Batch Time 135.6522 (0.3627)
    Learning Rate 1e-06
    Accuracy 0.9727 0.9727 0.9727 0.9727 0.9727 0.9727 0.9727
    Precision 0.9729 0.9535 0.9552 0.9835 0.9668 0.9780 0.9617
    Recall 0.9706 0.9389 0.9271 0.9887 0.9586 0.9780 0.9692
    F1 0.9718 0.9462 0.9409 0.9861 0.9627 0.9780 0.9654
    Acc_avg 0.9727 Prec_avg 0.9674 Recall_avg 0.9616 F1_avg 0.9644
    Total Loss 0.1758 Global Cls Loss 0.0876 Local Cls Loss 0.0882 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3772 (0.0040)
    Batch Time 18.2638 (0.1943)
    Learning Rate 1e-06
    Accuracy 0.7621 0.7621 0.7621 0.7621 0.7621 0.7621 0.7621
    Precision 0.8091 0.7174 0.4476 0.8553 0.6920 0.7034 0.7009
    Recall 0.7692 0.4853 0.4051 0.8933 0.6734 0.6375 0.7304
    F1 0.7886 0.5789 0.4252 0.8739 0.6825 0.6689 0.7153
Acc_avg 0.7621 Prec_avg 0.7036 Recall_avg 0.6563 F1_avg 0.6762
    Total Loss 1.8806 Global Cls Loss 0.9466 Local Cls Loss 0.9340 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0186 (0.0037)
    Batch Time 0.8015 (0.1603)
    Learning Rate 1e-06
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 0.6667 0.0000 0.0000 0.2449 0.0000 0.0000 0.2424
    Recall 0.0952 0.0000 0.0000 0.5000 0.0000 0.0000 0.4848
    F1 0.1667 0.0000 0.0000 0.3288 0.0000 0.0000 0.3232
Acc_avg 0.2326 Prec_avg 0.1649 Recall_avg 0.1543 F1_avg 0.1170
    Total Loss 5.6628 Global Cls Loss 2.8454 Local Cls Loss 2.8174 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 90.070069s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 14.375353s

    [Train]: 
    Epoch 60
    Data Time 2.5153 (0.0067)
    Batch Time 141.1125 (0.3773)
    Learning Rate 1e-06
    Accuracy 0.9718 0.9718 0.9718 0.9718 0.9718 0.9718 0.9718
    Precision 0.9743 0.9531 0.9488 0.9847 0.9610 0.9777 0.9613
    Recall 0.9651 0.9313 0.9355 0.9875 0.9671 0.9633 0.9663
    F1 0.9697 0.9421 0.9421 0.9861 0.9640 0.9705 0.9638
    Acc_avg 0.9718 Prec_avg 0.9658 Recall_avg 0.9594 F1_avg 0.9626
    Total Loss 0.1724 Global Cls Loss 0.0859 Local Cls Loss 0.0866 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3608 (0.0038)
    Batch Time 17.9595 (0.1911)
    Learning Rate 1e-06
    Accuracy 0.7601 0.7601 0.7601 0.7601 0.7601 0.7601 0.7601
    Precision 0.8025 0.6800 0.4476 0.8457 0.6865 0.6980 0.7154
    Recall 0.7877 0.5000 0.4051 0.8941 0.6711 0.6500 0.7078
    F1 0.7950 0.5763 0.4252 0.8692 0.6787 0.6731 0.7116
Acc_avg 0.7601 Prec_avg 0.6965 Recall_avg 0.6594 F1_avg 0.6756
    Total Loss 1.8727 Global Cls Loss 0.9425 Local Cls Loss 0.9302 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0160 (0.0032)
    Batch Time 0.8058 (0.1612)
    Learning Rate 1e-06
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 0.5000 0.0000 0.0000 0.2619 0.0000 0.3333 0.2571
    Recall 0.0952 0.0000 0.0000 0.4583 0.0000 0.1333 0.5455
    F1 0.1600 0.0000 0.0000 0.3333 0.0000 0.1905 0.3495
Acc_avg 0.2558 Prec_avg 0.1932 Recall_avg 0.1761 F1_avg 0.1476
    Total Loss 5.4003 Global Cls Loss 2.7120 Local Cls Loss 2.6883 AFN Loss 0.0000
