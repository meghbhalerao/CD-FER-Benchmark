log : ResNet50_CropNet_GCNwithIntraMatrixAndInterMatrix_useCluster_withoutAFN_trainOnSourceDomain_RAFtoAFED out-pth . net: ResNet50 pretrained None dev 0
Use 112 * 112 Image source RAF target CK+ train bs 32 test bs 32
Ep: 60 LR 0.000100 mu: 0.900000 WD: 0.000100
================================================
Num cls : 7
Use global feature and local feature.
Use Intra GCN.
Use Inter GCN.
Use Mean in Cluster.
================================================
Building Train and Test Dataloader...
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
 test source dataset qty: 2993
 test source dataset dist: 325, 68, 158, 1171, 447, 160, 664
 test target dataset qty: 129
 test target dataset dist: 21, 9, 15, 24, 12, 15, 33
Done!
================================================
Building Model...
No Resume Model
Done!
================================================
Initialize Mean in Cluster....
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 80.719285s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
2021-04-28 16:27:22.432370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
[Target Domain] Cost time : 16.015285s
Done!
================================================
Building Optimizer...
Done!
================================================
Run Experiment...

    [Train]: 
    Epoch 1
    Data Time 2.5968 (0.0069)
    Batch Time 127.4819 (0.3409)
    Learning Rate 0.0001
    Accuracy 0.4368 0.4368 0.4368 0.4368 0.4368 0.4368 0.4368
    Precision 0.2369 0.0000 0.1250 0.4867 0.3085 0.2297 0.3544
    Recall 0.0540 0.0000 0.0014 0.8471 0.1475 0.0499 0.3501
    F1 0.0880 0.0000 0.0028 0.6182 0.1996 0.0819 0.3522
    Acc_avg 0.4368 Prec_avg 0.2488 Recall_avg 0.2071 F1_avg 0.1918
    Total Loss 2.9972 Global Cls Loss 1.5005 Local Cls Loss 1.4967 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3542 (0.0038)
    Batch Time 17.9947 (0.1914)
    Learning Rate 0.0001
    Accuracy 0.5122 0.5122 0.5122 0.5122 0.5122 0.5122 0.5122
    Precision 0.4545 0.0000 0.0000 0.5486 0.3462 0.4000 0.4865
    Recall 0.2923 0.0000 0.0000 0.9112 0.1812 0.1250 0.4066
    F1 0.3558 0.0000 0.0000 0.6849 0.2379 0.1905 0.4430
Acc_avg 0.5122 Prec_avg 0.3194 Recall_avg 0.2738 F1_avg 0.2731
    Total Loss 2.6339 Global Cls Loss 1.3172 Local Cls Loss 1.3167 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.2738.

    Test Target: 
    Data Time 0.0195 (0.0039)
    Batch Time 0.8429 (0.1686)
    Learning Rate 0.0001
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 0.1875 0.0000 0.0000 0.2062 0.0000 0.0000 0.4375
    Recall 0.1429 0.0000 0.0000 0.8333 0.0000 0.0000 0.2121
    F1 0.1622 0.0000 0.0000 0.3306 0.0000 0.0000 0.2857
Acc_avg 0.2326 Prec_avg 0.1187 Recall_avg 0.1698 F1_avg 0.1112
    Total Loss 3.7344 Global Cls Loss 1.8882 Local Cls Loss 1.8462 AFN Loss 0.0000

    [Train]: 
    Epoch 2
    Data Time 2.1013 (0.0056)
    Batch Time 131.9211 (0.3527)
    Learning Rate 0.0001
    Accuracy 0.5643 0.5643 0.5643 0.5643 0.5643 0.5643 0.5643
    Precision 0.5232 0.0000 0.3750 0.6496 0.4303 0.4555 0.4871
    Recall 0.4305 0.0000 0.0042 0.8410 0.3604 0.2625 0.5659
    F1 0.4723 0.0000 0.0083 0.7330 0.3923 0.3330 0.5236
    Acc_avg 0.5643 Prec_avg 0.4172 Recall_avg 0.3521 F1_avg 0.3518
    Total Loss 2.4374 Global Cls Loss 1.2210 Local Cls Loss 1.2163 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3881 (0.0041)
    Batch Time 18.6008 (0.1979)
    Learning Rate 0.0001
    Accuracy 0.6088 0.6088 0.6088 0.6088 0.6088 0.6088 0.6088
    Precision 0.5457 1.0000 0.5000 0.7217 0.4589 0.5684 0.5275
    Recall 0.6062 0.0735 0.0127 0.8215 0.4251 0.3375 0.6205
    F1 0.5743 0.1370 0.0247 0.7684 0.4413 0.4235 0.5702
Acc_avg 0.6088 Prec_avg 0.6175 Recall_avg 0.4138 F1_avg 0.4199
    Total Loss 2.1782 Global Cls Loss 1.0906 Local Cls Loss 1.0876 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.4138.

    Test Target: 
    Data Time 0.0189 (0.0038)
    Batch Time 0.8203 (0.1641)
    Learning Rate 0.0001
    Accuracy 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705
    Precision 0.1818 0.0000 0.0000 0.1696 0.0000 0.0000 0.5000
    Recall 0.0952 0.0000 0.0000 0.7917 0.0000 0.0000 0.0303
    F1 0.1250 0.0000 0.0000 0.2794 0.0000 0.0000 0.0571
Acc_avg 0.1705 Prec_avg 0.1216 Recall_avg 0.1310 F1_avg 0.0659
    Total Loss 4.0075 Global Cls Loss 2.0613 Local Cls Loss 1.9461 AFN Loss 0.0000

    [Train]: 
    Epoch 3
    Data Time 2.6154 (0.0070)
    Batch Time 174.7509 (0.4672)
    Learning Rate 0.0001
    Accuracy 0.6165 0.6165 0.6165 0.6165 0.6165 0.6165 0.6165
    Precision 0.5955 0.5660 0.3790 0.7082 0.5080 0.5127 0.5342
    Recall 0.5449 0.1145 0.0659 0.8521 0.4365 0.3856 0.6173
    F1 0.5691 0.1905 0.1123 0.7735 0.4696 0.4402 0.5728
    Acc_avg 0.6165 Prec_avg 0.5434 Recall_avg 0.4310 F1_avg 0.4468
    Total Loss 2.1362 Global Cls Loss 1.0691 Local Cls Loss 1.0671 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4851 (0.0052)
    Batch Time 55.1975 (0.5872)
    Learning Rate 0.0001
    Accuracy 0.6355 0.6355 0.6355 0.6355 0.6355 0.6355 0.6355
    Precision 0.7230 0.6000 0.3617 0.6632 0.5620 0.5161 0.6069
    Recall 0.6185 0.2647 0.1076 0.9129 0.3244 0.5000 0.5602
    F1 0.6667 0.3673 0.1659 0.7682 0.4113 0.5079 0.5826
Acc_avg 0.6355 Prec_avg 0.5761 Recall_avg 0.4698 F1_avg 0.4957
    Total Loss 2.0458 Global Cls Loss 1.0242 Local Cls Loss 1.0216 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.4698.

    Test Target: 
    Data Time 0.0177 (0.0035)
    Batch Time 2.3404 (0.4681)
    Learning Rate 0.0001
    Accuracy 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938
    Precision 0.1579 0.0000 0.0000 0.1928 0.0000 0.0000 0.6000
    Recall 0.2857 0.0000 0.0000 0.6667 0.0000 0.0000 0.0909
    F1 0.2034 0.0000 0.0000 0.2991 0.0000 0.0000 0.1579
Acc_avg 0.1938 Prec_avg 0.1358 Recall_avg 0.1490 F1_avg 0.0943
    Total Loss 3.8485 Global Cls Loss 1.9376 Local Cls Loss 1.9109 AFN Loss 0.0000

    [Train]: 
    Epoch 4
    Data Time 2.5184 (0.0067)
    Batch Time 147.6791 (0.3949)
    Learning Rate 0.0001
    Accuracy 0.6496 0.6496 0.6496 0.6496 0.6496 0.6496 0.6496
    Precision 0.6344 0.6667 0.3944 0.7521 0.5503 0.5731 0.5565
    Recall 0.6208 0.1908 0.1388 0.8597 0.4844 0.4883 0.6311
    F1 0.6276 0.2967 0.2054 0.8023 0.5152 0.5273 0.5915
    Acc_avg 0.6496 Prec_avg 0.5897 Recall_avg 0.4877 F1_avg 0.5094
    Total Loss 1.9561 Global Cls Loss 0.9793 Local Cls Loss 0.9768 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4149 (0.0044)
    Batch Time 19.1558 (0.2038)
    Learning Rate 0.0001
    Accuracy 0.6555 0.6555 0.6555 0.6555 0.6555 0.6555 0.6555
    Precision 0.6657 0.7917 0.3947 0.7530 0.5036 0.5703 0.5854
    Recall 0.6800 0.2794 0.0949 0.8514 0.4743 0.4562 0.6401
    F1 0.6728 0.4130 0.1531 0.7992 0.4885 0.5069 0.6115
Acc_avg 0.6555 Prec_avg 0.6092 Recall_avg 0.4966 F1_avg 0.5207
    Total Loss 1.9031 Global Cls Loss 0.9542 Local Cls Loss 0.9489 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.4966.

    Test Target: 
    Data Time 0.0182 (0.0036)
    Batch Time 0.8127 (0.1625)
    Learning Rate 0.0001
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 1.0000 0.0000 0.0000 0.2162 0.0000 0.0000 0.2000
    Recall 0.0476 0.0000 0.0000 1.0000 0.0000 0.0000 0.0606
    F1 0.0909 0.0000 0.0000 0.3556 0.0000 0.0000 0.0930
Acc_avg 0.2093 Prec_avg 0.2023 Recall_avg 0.1583 F1_avg 0.0771
    Total Loss 4.0520 Global Cls Loss 2.0503 Local Cls Loss 2.0017 AFN Loss 0.0000

    [Train]: 
    Epoch 5
    Data Time 2.1949 (0.0059)
    Batch Time 126.8651 (0.3392)
    Learning Rate 0.0001
    Accuracy 0.6771 0.6771 0.6771 0.6771 0.6771 0.6771 0.6771
    Precision 0.6702 0.6545 0.4557 0.7717 0.5858 0.6037 0.5981
    Recall 0.6463 0.2748 0.2090 0.8650 0.5271 0.5293 0.6677
    F1 0.6580 0.3871 0.2865 0.8157 0.5549 0.5641 0.6310
    Acc_avg 0.6771 Prec_avg 0.6200 Recall_avg 0.5313 F1_avg 0.5568
    Total Loss 1.7953 Global Cls Loss 0.8996 Local Cls Loss 0.8957 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4124 (0.0044)
    Batch Time 20.0718 (0.2135)
    Learning Rate 0.0001
    Accuracy 0.6676 0.6676 0.6676 0.6676 0.6676 0.6676 0.6676
    Precision 0.7358 0.8182 0.3088 0.8053 0.5191 0.5569 0.5995
    Recall 0.6000 0.2647 0.2658 0.8266 0.5481 0.5813 0.6581
    F1 0.6610 0.4000 0.2857 0.8158 0.5332 0.5688 0.6274
Acc_avg 0.6676 Prec_avg 0.6205 Recall_avg 0.5350 F1_avg 0.5560
    Total Loss 1.8379 Global Cls Loss 0.9194 Local Cls Loss 0.9185 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5350.

    Test Target: 
    Data Time 0.0184 (0.0037)
    Batch Time 0.8156 (0.1631)
    Learning Rate 0.0001
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 0.3333 0.0000 0.0000 0.1919 0.0000 0.0000 0.3810
    Recall 0.1429 0.0000 0.0000 0.7917 0.0000 0.0000 0.2424
    F1 0.2000 0.0000 0.0000 0.3089 0.0000 0.0000 0.2963
Acc_avg 0.2326 Prec_avg 0.1295 Recall_avg 0.1681 F1_avg 0.1150
    Total Loss 3.9507 Global Cls Loss 1.9803 Local Cls Loss 1.9704 AFN Loss 0.0000

    [Train]: 
    Epoch 6
    Data Time 2.1131 (0.0056)
    Batch Time 121.4454 (0.3247)
    Learning Rate 0.0001
    Accuracy 0.6989 0.6989 0.6989 0.6989 0.6989 0.6989 0.6989
    Precision 0.7210 0.6863 0.5191 0.7963 0.6041 0.6112 0.6125
    Recall 0.6820 0.2672 0.2665 0.8718 0.5496 0.5601 0.7010
    F1 0.7010 0.3846 0.3522 0.8323 0.5756 0.5845 0.6538
    Acc_avg 0.6989 Prec_avg 0.6501 Recall_avg 0.5569 F1_avg 0.5834
    Total Loss 1.7020 Global Cls Loss 0.8514 Local Cls Loss 0.8506 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3896 (0.0041)
    Batch Time 19.9711 (0.2125)
    Learning Rate 0.0001
    Accuracy 0.6729 0.6729 0.6729 0.6729 0.6729 0.6729 0.6729
    Precision 0.8259 0.6667 0.4133 0.7989 0.4601 0.6370 0.6062
    Recall 0.6277 0.3529 0.1962 0.8548 0.6197 0.5375 0.5889
    F1 0.7133 0.4615 0.2661 0.8259 0.5281 0.5831 0.5974
Acc_avg 0.6729 Prec_avg 0.6297 Recall_avg 0.5397 F1_avg 0.5679
    Total Loss 1.8231 Global Cls Loss 0.9103 Local Cls Loss 0.9128 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5397.

    Test Target: 
    Data Time 0.0181 (0.0036)
    Batch Time 0.9519 (0.1904)
    Learning Rate 0.0001
    Accuracy 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938
    Precision 0.0000 0.0000 0.0000 0.1935 0.0000 0.0000 0.2000
    Recall 0.0000 0.0000 0.0000 1.0000 0.0000 0.0000 0.0303
    F1 0.0000 0.0000 0.0000 0.3243 0.0000 0.0000 0.0526
Acc_avg 0.1938 Prec_avg 0.0562 Recall_avg 0.1472 F1_avg 0.0539
    Total Loss 4.0216 Global Cls Loss 2.0061 Local Cls Loss 2.0155 AFN Loss 0.0000

    [Train]: 
    Epoch 7
    Data Time 2.0899 (0.0056)
    Batch Time 121.5824 (0.3251)
    Learning Rate 0.0001
    Accuracy 0.7092 0.7092 0.7092 0.7092 0.7092 0.7092 0.7092
    Precision 0.7022 0.5692 0.5136 0.8099 0.6339 0.6524 0.6224
    Recall 0.6704 0.2824 0.2903 0.8775 0.5817 0.6026 0.7014
    F1 0.6859 0.3776 0.3710 0.8423 0.6067 0.6265 0.6595
    Acc_avg 0.7092 Prec_avg 0.6434 Recall_avg 0.5724 F1_avg 0.5956
    Total Loss 1.6078 Global Cls Loss 0.8050 Local Cls Loss 0.8027 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5347 (0.0057)
    Batch Time 18.1858 (0.1935)
    Learning Rate 0.0001
    Accuracy 0.6833 0.6833 0.6833 0.6833 0.6833 0.6833 0.6833
    Precision 0.6770 0.6129 0.3507 0.7937 0.5206 0.6370 0.6608
    Recall 0.7415 0.2794 0.2975 0.8804 0.5369 0.5813 0.5633
    F1 0.7078 0.3838 0.3219 0.8348 0.5286 0.6078 0.6081
Acc_avg 0.6833 Prec_avg 0.6075 Recall_avg 0.5543 F1_avg 0.5704
    Total Loss 1.7635 Global Cls Loss 0.8807 Local Cls Loss 0.8829 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5543.

    Test Target: 
    Data Time 0.0188 (0.0038)
    Batch Time 0.8268 (0.1654)
    Learning Rate 0.0001
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.5000 0.0000 0.0000 0.1810 0.0000 0.0000 0.0000
    Recall 0.1429 0.0000 0.0000 0.8750 0.0000 0.0000 0.0000
    F1 0.2222 0.0000 0.0000 0.3000 0.0000 0.0000 0.0000
Acc_avg 0.1860 Prec_avg 0.0973 Recall_avg 0.1454 F1_avg 0.0746
    Total Loss 4.5491 Global Cls Loss 2.2725 Local Cls Loss 2.2767 AFN Loss 0.0000

    [Train]: 
    Epoch 8
    Data Time 2.2012 (0.0059)
    Batch Time 134.6828 (0.3601)
    Learning Rate 0.0001
    Accuracy 0.7319 0.7319 0.7319 0.7319 0.7319 0.7319 0.7319
    Precision 0.7123 0.6096 0.5852 0.8351 0.6550 0.6742 0.6444
    Recall 0.6942 0.3397 0.3324 0.8892 0.6233 0.6167 0.7228
    F1 0.7031 0.4363 0.4240 0.8613 0.6388 0.6442 0.6813
    Acc_avg 0.7319 Prec_avg 0.6737 Recall_avg 0.6026 F1_avg 0.6270
    Total Loss 1.5120 Global Cls Loss 0.7560 Local Cls Loss 0.7560 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4103 (0.0044)
    Batch Time 19.7190 (0.2098)
    Learning Rate 0.0001
    Accuracy 0.6993 0.6993 0.6993 0.6993 0.6993 0.6993 0.6993
    Precision 0.8140 0.7407 0.3868 0.7964 0.6551 0.6691 0.5836
    Recall 0.6062 0.2941 0.2595 0.8787 0.4206 0.5687 0.7937
    F1 0.6949 0.4211 0.3106 0.8356 0.5123 0.6149 0.6726
Acc_avg 0.6993 Prec_avg 0.6637 Recall_avg 0.5459 F1_avg 0.5803
    Total Loss 1.6807 Global Cls Loss 0.8404 Local Cls Loss 0.8403 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0200 (0.0040)
    Batch Time 0.8232 (0.1646)
    Learning Rate 0.0001
    Accuracy 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481
    Precision 0.0000 0.0000 0.0000 0.2330 1.0000 0.0000 0.2500
    Recall 0.0000 0.0000 0.0000 1.0000 0.1667 0.0000 0.1818
    F1 0.0000 0.0000 0.0000 0.3780 0.2857 0.0000 0.2105
Acc_avg 0.2481 Prec_avg 0.2119 Recall_avg 0.1926 F1_avg 0.1249
    Total Loss 4.7897 Global Cls Loss 2.4019 Local Cls Loss 2.3878 AFN Loss 0.0000

    [Train]: 
    Epoch 9
    Data Time 1.9648 (0.0053)
    Batch Time 132.4207 (0.3541)
    Learning Rate 0.0001
    Accuracy 0.7355 0.7355 0.7355 0.7355 0.7355 0.7355 0.7355
    Precision 0.7378 0.6412 0.5428 0.8274 0.6610 0.6885 0.6546
    Recall 0.7361 0.3218 0.3114 0.8935 0.6143 0.6481 0.7167
    F1 0.7370 0.4286 0.3957 0.8592 0.6368 0.6677 0.6842
    Acc_avg 0.7355 Prec_avg 0.6790 Recall_avg 0.6060 F1_avg 0.6299
    Total Loss 1.4613 Global Cls Loss 0.7319 Local Cls Loss 0.7294 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4749 (0.0051)
    Batch Time 20.5469 (0.2186)
    Learning Rate 0.0001
    Accuracy 0.7026 0.7026 0.7026 0.7026 0.7026 0.7026 0.7026
    Precision 0.8049 0.4828 0.3924 0.8126 0.6136 0.6593 0.5938
    Recall 0.6092 0.4118 0.1962 0.8890 0.4832 0.5563 0.7530
    F1 0.6935 0.4444 0.2616 0.8491 0.5407 0.6034 0.6640
Acc_avg 0.7026 Prec_avg 0.6228 Recall_avg 0.5570 F1_avg 0.5795
    Total Loss 1.6887 Global Cls Loss 0.8423 Local Cls Loss 0.8464 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5570.

    Test Target: 
    Data Time 0.0221 (0.0044)
    Batch Time 0.9875 (0.1975)
    Learning Rate 0.0001
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 0.7500 0.0000 0.0000 0.2308 0.0000 0.0000 0.2143
    Recall 0.1429 0.0000 0.0000 0.8750 0.0000 0.0000 0.1818
    F1 0.2400 0.0000 0.0000 0.3652 0.0000 0.0000 0.1967
Acc_avg 0.2326 Prec_avg 0.1707 Recall_avg 0.1714 F1_avg 0.1146
    Total Loss 4.1347 Global Cls Loss 2.0732 Local Cls Loss 2.0615 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 79.788096s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.889696s

    [Train]: 
    Epoch 10
    Data Time 2.2754 (0.0061)
    Batch Time 127.9843 (0.3422)
    Learning Rate 0.0001
    Accuracy 0.7559 0.7559 0.7559 0.7559 0.7559 0.7559 0.7559
    Precision 0.7648 0.6605 0.5551 0.8466 0.6884 0.7429 0.6746
    Recall 0.7387 0.4084 0.3745 0.8963 0.6398 0.6862 0.7523
    F1 0.7515 0.5047 0.4472 0.8707 0.6632 0.7134 0.7113
    Acc_avg 0.7559 Prec_avg 0.7047 Recall_avg 0.6423 F1_avg 0.6660
    Total Loss 1.3648 Global Cls Loss 0.6829 Local Cls Loss 0.6819 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3745 (0.0040)
    Batch Time 19.7241 (0.2098)
    Learning Rate 0.0001
    Accuracy 0.7157 0.7157 0.7157 0.7157 0.7157 0.7157 0.7157
    Precision 0.7739 0.6279 0.5312 0.8435 0.5508 0.6449 0.6442
    Recall 0.6738 0.3971 0.2152 0.8514 0.6667 0.5563 0.7199
    F1 0.7204 0.4865 0.3063 0.8474 0.6032 0.5973 0.6799
Acc_avg 0.7157 Prec_avg 0.6595 Recall_avg 0.5829 F1_avg 0.6059
    Total Loss 1.6314 Global Cls Loss 0.8155 Local Cls Loss 0.8159 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5829.

    Test Target: 
    Data Time 0.0221 (0.0044)
    Batch Time 0.9769 (0.1954)
    Learning Rate 0.0001
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2079 0.0000 0.0000 0.2400
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0000 0.1818
    F1 0.0000 0.0000 0.0000 0.3360 0.0000 0.0000 0.2069
Acc_avg 0.2093 Prec_avg 0.0640 Recall_avg 0.1510 F1_avg 0.0776
    Total Loss 4.3931 Global Cls Loss 2.1981 Local Cls Loss 2.1950 AFN Loss 0.0000

    [Train]: 
    Epoch 11
    Data Time 2.0292 (0.0054)
    Batch Time 124.9099 (0.3340)
    Learning Rate 0.0001
    Accuracy 0.7655 0.7655 0.7655 0.7655 0.7655 0.7655 0.7655
    Precision 0.7724 0.6800 0.6050 0.8532 0.6995 0.7296 0.6877
    Recall 0.7601 0.3893 0.4045 0.8986 0.6520 0.6804 0.7692
    F1 0.7662 0.4951 0.4848 0.8753 0.6749 0.7041 0.7262
    Acc_avg 0.7655 Prec_avg 0.7182 Recall_avg 0.6506 F1_avg 0.6752
    Total Loss 1.3078 Global Cls Loss 0.6547 Local Cls Loss 0.6531 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3815 (0.0041)
    Batch Time 19.6761 (0.2093)
    Learning Rate 0.0001
    Accuracy 0.7083 0.7083 0.7083 0.7083 0.7083 0.7083 0.7083
    Precision 0.7459 0.7059 0.3701 0.7904 0.6349 0.5806 0.6626
    Recall 0.7046 0.3529 0.2975 0.8984 0.5369 0.5625 0.6596
    F1 0.7247 0.4706 0.3298 0.8409 0.5818 0.5714 0.6611
Acc_avg 0.7083 Prec_avg 0.6415 Recall_avg 0.5732 F1_avg 0.5972
    Total Loss 1.6621 Global Cls Loss 0.8282 Local Cls Loss 0.8340 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0222 (0.0044)
    Batch Time 0.8147 (0.1629)
    Learning Rate 0.0001
    Accuracy 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403
    Precision 0.0000 0.0000 0.0000 0.2763 0.0000 0.0000 0.1923
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0000 0.3030
    F1 0.0000 0.0000 0.0000 0.4200 0.0000 0.0000 0.2353
Acc_avg 0.2403 Prec_avg 0.0669 Recall_avg 0.1683 F1_avg 0.0936
    Total Loss 4.0473 Global Cls Loss 2.0172 Local Cls Loss 2.0301 AFN Loss 0.0000

    [Train]: 
    Epoch 12
    Data Time 2.2243 (0.0059)
    Batch Time 126.3554 (0.3378)
    Learning Rate 0.0001
    Accuracy 0.7763 0.7763 0.7763 0.7763 0.7763 0.7763 0.7763
    Precision 0.7812 0.6686 0.6015 0.8640 0.7164 0.7446 0.7019
    Recall 0.7744 0.4313 0.4530 0.9039 0.6727 0.7097 0.7618
    F1 0.7778 0.5244 0.5168 0.8835 0.6938 0.7267 0.7306
    Acc_avg 0.7763 Prec_avg 0.7255 Recall_avg 0.6724 F1_avg 0.6934
    Total Loss 1.2264 Global Cls Loss 0.6138 Local Cls Loss 0.6125 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5018 (0.0053)
    Batch Time 17.8073 (0.1894)
    Learning Rate 0.0001
    Accuracy 0.7170 0.7170 0.7170 0.7170 0.7170 0.7170 0.7170
    Precision 0.7467 0.5946 0.4239 0.8369 0.6091 0.6280 0.6353
    Recall 0.6892 0.3235 0.2468 0.8634 0.5369 0.6438 0.7636
    F1 0.7168 0.4190 0.3120 0.8499 0.5707 0.6358 0.6936
Acc_avg 0.7170 Prec_avg 0.6392 Recall_avg 0.5810 F1_avg 0.5997
    Total Loss 1.6100 Global Cls Loss 0.8047 Local Cls Loss 0.8053 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0155 (0.0031)
    Batch Time 0.7930 (0.1586)
    Learning Rate 0.0001
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.6667 0.0000 0.0000 0.1875 0.0000 0.0000 0.3077
    Recall 0.0952 0.0000 0.0000 0.8750 0.0000 0.0000 0.1212
    F1 0.1667 0.0000 0.0000 0.3088 0.0000 0.0000 0.1739
Acc_avg 0.2093 Prec_avg 0.1660 Recall_avg 0.1559 F1_avg 0.0928
    Total Loss 4.5992 Global Cls Loss 2.2902 Local Cls Loss 2.3090 AFN Loss 0.0000

    [Train]: 
    Epoch 13
    Data Time 2.2215 (0.0059)
    Batch Time 133.4401 (0.3568)
    Learning Rate 0.0001
    Accuracy 0.7881 0.7881 0.7881 0.7881 0.7881 0.7881 0.7881
    Precision 0.7990 0.6949 0.6122 0.8692 0.7282 0.7577 0.7225
    Recall 0.7895 0.4695 0.4516 0.9067 0.7077 0.7199 0.7726
    F1 0.7942 0.5604 0.5198 0.8875 0.7178 0.7383 0.7467
    Acc_avg 0.7881 Prec_avg 0.7405 Recall_avg 0.6882 F1_avg 0.7093
    Total Loss 1.1760 Global Cls Loss 0.5882 Local Cls Loss 0.5878 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4254 (0.0045)
    Batch Time 20.5914 (0.2191)
    Learning Rate 0.0001
    Accuracy 0.7177 0.7177 0.7177 0.7177 0.7177 0.7177 0.7177
    Precision 0.7902 0.5077 0.3895 0.8301 0.5655 0.6783 0.6652
    Recall 0.6954 0.4853 0.2342 0.8762 0.6085 0.6062 0.6883
    F1 0.7398 0.4962 0.2925 0.8525 0.5862 0.6403 0.6765
Acc_avg 0.7177 Prec_avg 0.6324 Recall_avg 0.5991 F1_avg 0.6120
    Total Loss 1.6352 Global Cls Loss 0.8171 Local Cls Loss 0.8180 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5991.

    Test Target: 
    Data Time 0.0179 (0.0036)
    Batch Time 0.9504 (0.1901)
    Learning Rate 0.0001
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0000 0.0000 0.0000 0.1765 0.0000 0.0000 0.2432
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.2752 0.0000 0.0000 0.2571
Acc_avg 0.1860 Prec_avg 0.0600 Recall_avg 0.1282 F1_avg 0.0761
    Total Loss 5.4489 Global Cls Loss 2.7179 Local Cls Loss 2.7310 AFN Loss 0.0000

    [Train]: 
    Epoch 14
    Data Time 2.3298 (0.0062)
    Batch Time 190.4594 (0.5092)
    Learning Rate 0.0001
    Accuracy 0.7962 0.7962 0.7962 0.7962 0.7962 0.7962 0.7962
    Precision 0.8057 0.6769 0.6295 0.8803 0.7402 0.7814 0.7222
    Recall 0.7909 0.5038 0.4670 0.9115 0.7103 0.7390 0.7866
    F1 0.7982 0.5777 0.5362 0.8956 0.7250 0.7596 0.7530
    Acc_avg 0.7962 Prec_avg 0.7480 Recall_avg 0.7013 F1_avg 0.7208
    Total Loss 1.1252 Global Cls Loss 0.5636 Local Cls Loss 0.5615 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4575 (0.0049)
    Batch Time 51.3750 (0.5465)
    Learning Rate 0.0001
    Accuracy 0.7217 0.7217 0.7217 0.7217 0.7217 0.7217 0.7217
    Precision 0.7722 0.6429 0.3728 0.8373 0.6541 0.6978 0.6407
    Recall 0.7508 0.3971 0.3987 0.8480 0.5414 0.6062 0.7440
    F1 0.7613 0.4909 0.3853 0.8426 0.5924 0.6488 0.6885
Acc_avg 0.7217 Prec_avg 0.6597 Recall_avg 0.6123 F1_avg 0.6300
    Total Loss 1.5963 Global Cls Loss 0.7976 Local Cls Loss 0.7987 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6123.

    Test Target: 
    Data Time 0.0208 (0.0042)
    Batch Time 2.6507 (0.5301)
    Learning Rate 0.0001
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 0.0000 0.1875 0.0000 0.3019 0.0000 0.0000 0.2245
    Recall 0.0000 0.3333 0.0000 0.6667 0.0000 0.0000 0.3333
    F1 0.0000 0.2400 0.0000 0.4156 0.0000 0.0000 0.2683
Acc_avg 0.2326 Prec_avg 0.1020 Recall_avg 0.1905 F1_avg 0.1320
    Total Loss 4.0469 Global Cls Loss 2.0351 Local Cls Loss 2.0117 AFN Loss 0.0000

    [Train]: 
    Epoch 15
    Data Time 2.6650 (0.0071)
    Batch Time 245.6268 (0.6568)
    Learning Rate 0.0001
    Accuracy 0.8077 0.8077 0.8077 0.8077 0.8077 0.8077 0.8077
    Precision 0.8176 0.7656 0.6588 0.8867 0.7539 0.7720 0.7380
    Recall 0.8046 0.5611 0.5119 0.9169 0.7219 0.7199 0.8024
    F1 0.8110 0.6476 0.5762 0.9015 0.7375 0.7451 0.7688
    Acc_avg 0.8077 Prec_avg 0.7704 Recall_avg 0.7198 F1_avg 0.7411
    Total Loss 1.0515 Global Cls Loss 0.5262 Local Cls Loss 0.5253 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4598 (0.0049)
    Batch Time 51.2049 (0.5447)
    Learning Rate 0.0001
    Accuracy 0.7153 0.7153 0.7153 0.7153 0.7153 0.7153 0.7153
    Precision 0.7447 0.6053 0.3393 0.8244 0.7236 0.6104 0.6350
    Recall 0.7631 0.3382 0.3608 0.8702 0.4452 0.5875 0.7545
    F1 0.7538 0.4340 0.3497 0.8467 0.5512 0.5987 0.6896
Acc_avg 0.7153 Prec_avg 0.6404 Recall_avg 0.5885 F1_avg 0.6034
    Total Loss 1.7554 Global Cls Loss 0.8777 Local Cls Loss 0.8777 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0202 (0.0040)
    Batch Time 1.7011 (0.3402)
    Learning Rate 0.0001
    Accuracy 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713 0.2713
    Precision 0.5000 0.0000 0.0000 0.3000 0.0870 0.0000 0.3137
    Recall 0.0952 0.0000 0.0000 0.6250 0.1667 0.0000 0.4848
    F1 0.1600 0.0000 0.0000 0.4054 0.1143 0.0000 0.3810
Acc_avg 0.2713 Prec_avg 0.1715 Recall_avg 0.1960 F1_avg 0.1515
    Total Loss 4.2810 Global Cls Loss 2.1547 Local Cls Loss 2.1263 AFN Loss 0.0000

    [Train]: 
    Epoch 16
    Data Time 2.6162 (0.0070)
    Batch Time 284.2101 (0.7599)
    Learning Rate 0.0001
    Accuracy 0.8198 0.8198 0.8198 0.8198 0.8198 0.8198 0.8198
    Precision 0.8218 0.6713 0.6815 0.8908 0.7832 0.7791 0.7638
    Recall 0.8133 0.5534 0.5372 0.9222 0.7533 0.7551 0.8063
    F1 0.8176 0.6067 0.6008 0.9062 0.7680 0.7669 0.7844
    Acc_avg 0.8198 Prec_avg 0.7702 Recall_avg 0.7344 F1_avg 0.7501
    Total Loss 1.0238 Global Cls Loss 0.5122 Local Cls Loss 0.5116 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.6273 (0.0067)
    Batch Time 52.7737 (0.5614)
    Learning Rate 0.0001
    Accuracy 0.7300 0.7300 0.7300 0.7300 0.7300 0.7300 0.7300
    Precision 0.7609 0.5532 0.4779 0.8109 0.6648 0.6917 0.6722
    Recall 0.6954 0.3824 0.4114 0.8933 0.5414 0.5750 0.7349
    F1 0.7267 0.4522 0.4422 0.8501 0.5968 0.6280 0.7022
Acc_avg 0.7300 Prec_avg 0.6617 Recall_avg 0.6048 F1_avg 0.6283
    Total Loss 1.6760 Global Cls Loss 0.8379 Local Cls Loss 0.8381 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0209 (0.0042)
    Batch Time 1.4297 (0.2859)
    Learning Rate 0.0001
    Accuracy 0.2636 0.2636 0.2636 0.2636 0.2636 0.2636 0.2636
    Precision 0.2857 0.0000 0.0000 0.2045 0.0000 0.0000 0.5217
    Recall 0.1905 0.0000 0.0000 0.7500 0.0000 0.0000 0.3636
    F1 0.2286 0.0000 0.0000 0.3214 0.0000 0.0000 0.4286
Acc_avg 0.2636 Prec_avg 0.1446 Recall_avg 0.1863 F1_avg 0.1398
    Total Loss 4.1234 Global Cls Loss 2.0833 Local Cls Loss 2.0401 AFN Loss 0.0000

    [Train]: 
    Epoch 17
    Data Time 2.8130 (0.0075)
    Batch Time 256.9940 (0.6871)
    Learning Rate 0.0001
    Accuracy 0.8244 0.8244 0.8244 0.8244 0.8244 0.8244 0.8244
    Precision 0.8267 0.7513 0.7103 0.8982 0.7683 0.8241 0.7581
    Recall 0.8116 0.5534 0.5787 0.9224 0.7443 0.7830 0.8166
    F1 0.8191 0.6374 0.6378 0.9101 0.7561 0.8030 0.7862
    Acc_avg 0.8244 Prec_avg 0.7910 Recall_avg 0.7443 F1_avg 0.7642
    Total Loss 0.9763 Global Cls Loss 0.4882 Local Cls Loss 0.4881 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3664 (0.0039)
    Batch Time 17.9023 (0.1905)
    Learning Rate 0.0001
    Accuracy 0.7220 0.7220 0.7220 0.7220 0.7220 0.7220 0.7220
    Precision 0.7469 0.7241 0.3688 0.8434 0.6553 0.5587 0.6616
    Recall 0.7354 0.3088 0.3734 0.8693 0.5570 0.6250 0.7154
    F1 0.7411 0.4330 0.3711 0.8562 0.6022 0.5900 0.6874
Acc_avg 0.7220 Prec_avg 0.6512 Recall_avg 0.5978 F1_avg 0.6116
    Total Loss 1.6603 Global Cls Loss 0.8302 Local Cls Loss 0.8301 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0202 (0.0040)
    Batch Time 0.8027 (0.1605)
    Learning Rate 0.0001
    Accuracy 0.3256 0.3256 0.3256 0.3256 0.3256 0.3256 0.3256
    Precision 0.2826 0.0000 0.0000 0.2632 0.0000 0.0000 0.6364
    Recall 0.6190 0.0000 0.0000 0.6250 0.0000 0.0000 0.4242
    F1 0.3881 0.0000 0.0000 0.3704 0.0000 0.0000 0.5091
Acc_avg 0.3256 Prec_avg 0.1689 Recall_avg 0.2383 F1_avg 0.1811
    Total Loss 4.1719 Global Cls Loss 2.0930 Local Cls Loss 2.0789 AFN Loss 0.0000

    [Train]: 
    Epoch 18
    Data Time 2.2139 (0.0059)
    Batch Time 125.2544 (0.3349)
    Learning Rate 0.0001
    Accuracy 0.8349 0.8349 0.8349 0.8349 0.8349 0.8349 0.8349
    Precision 0.8490 0.7243 0.7115 0.9023 0.7870 0.8186 0.7769
    Recall 0.8308 0.5916 0.5716 0.9288 0.7686 0.8006 0.8198
    F1 0.8398 0.6513 0.6340 0.9154 0.7777 0.8095 0.7978
    Acc_avg 0.8349 Prec_avg 0.7957 Recall_avg 0.7588 F1_avg 0.7751
    Total Loss 0.9170 Global Cls Loss 0.4591 Local Cls Loss 0.4579 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3775 (0.0040)
    Batch Time 18.6974 (0.1989)
    Learning Rate 0.0001
    Accuracy 0.7264 0.7264 0.7264 0.7264 0.7264 0.7264 0.7264
    Precision 0.7180 0.7097 0.3657 0.8241 0.6493 0.6544 0.6813
    Recall 0.7600 0.3235 0.3101 0.8881 0.5839 0.5563 0.7018
    F1 0.7384 0.4444 0.3356 0.8549 0.6148 0.6014 0.6914
Acc_avg 0.7264 Prec_avg 0.6575 Recall_avg 0.5891 F1_avg 0.6116
    Total Loss 1.7064 Global Cls Loss 0.8528 Local Cls Loss 0.8536 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0224 (0.0045)
    Batch Time 0.8398 (0.1680)
    Learning Rate 0.0001
    Accuracy 0.3023 0.3023 0.3023 0.3023 0.3023 0.3023 0.3023
    Precision 0.3077 0.0000 0.0000 0.3235 0.0000 0.0000 0.3288
    Recall 0.1905 0.0000 0.0000 0.4583 0.0000 0.0000 0.7273
    F1 0.2353 0.0000 0.0000 0.3793 0.0000 0.0000 0.4528
Acc_avg 0.3023 Prec_avg 0.1371 Recall_avg 0.1966 F1_avg 0.1525
    Total Loss 3.9532 Global Cls Loss 1.9781 Local Cls Loss 1.9751 AFN Loss 0.0000

    [Train]: 
    Epoch 19
    Data Time 2.1822 (0.0058)
    Batch Time 124.5137 (0.3329)
    Learning Rate 0.0001
    Accuracy 0.8443 0.8443 0.8443 0.8443 0.8443 0.8443 0.8443
    Precision 0.8533 0.7512 0.7194 0.9045 0.8147 0.8012 0.7972
    Recall 0.8316 0.6107 0.6194 0.9267 0.7883 0.7930 0.8402
    F1 0.8423 0.6737 0.6657 0.9155 0.8013 0.7970 0.8181
    Acc_avg 0.8443 Prec_avg 0.8059 Recall_avg 0.7728 F1_avg 0.7877
    Total Loss 0.8745 Global Cls Loss 0.4371 Local Cls Loss 0.4374 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3627 (0.0039)
    Batch Time 18.0873 (0.1924)
    Learning Rate 0.0001
    Accuracy 0.7257 0.7257 0.7257 0.7257 0.7257 0.7257 0.7257
    Precision 0.7932 0.6136 0.3590 0.8492 0.6529 0.6012 0.6341
    Recall 0.7200 0.3971 0.2658 0.8702 0.6018 0.6312 0.7229
    F1 0.7548 0.4821 0.3055 0.8596 0.6263 0.6159 0.6756
Acc_avg 0.7257 Prec_avg 0.6433 Recall_avg 0.6013 F1_avg 0.6171
    Total Loss 1.7058 Global Cls Loss 0.8538 Local Cls Loss 0.8520 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0188 (0.0038)
    Batch Time 0.7953 (0.1591)
    Learning Rate 0.0001
    Accuracy 0.1783 0.1783 0.1783 0.1783 0.1783 0.1783 0.1783
    Precision 0.0000 0.0000 0.0000 0.1579 0.0000 0.0000 0.2125
    Recall 0.0000 0.0000 0.0000 0.2500 0.0000 0.0000 0.5152
    F1 0.0000 0.0000 0.0000 0.1935 0.0000 0.0000 0.3009
Acc_avg 0.1783 Prec_avg 0.0529 Recall_avg 0.1093 F1_avg 0.0706
    Total Loss 4.3842 Global Cls Loss 2.1945 Local Cls Loss 2.1896 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 80.696305s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.998857s

    [Train]: 
    Epoch 20
    Data Time 2.2636 (0.0061)
    Batch Time 132.2184 (0.3535)
    Learning Rate 0.0001
    Accuracy 0.8483 0.8483 0.8483 0.8483 0.8483 0.8483 0.8483
    Precision 0.8679 0.7748 0.7171 0.9114 0.8073 0.8388 0.7902
    Recall 0.8610 0.6565 0.6185 0.9345 0.7846 0.7933 0.8283
    F1 0.8644 0.7107 0.6642 0.9228 0.7958 0.8154 0.8088
    Acc_avg 0.8483 Prec_avg 0.8153 Recall_avg 0.7824 F1_avg 0.7974
    Total Loss 0.8394 Global Cls Loss 0.4202 Local Cls Loss 0.4192 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.5592 (0.0059)
    Batch Time 18.4648 (0.1964)
    Learning Rate 0.0001
    Accuracy 0.7294 0.7294 0.7294 0.7294 0.7294 0.7294 0.7294
    Precision 0.7211 0.5600 0.5395 0.8462 0.6183 0.6199 0.6657
    Recall 0.7477 0.4118 0.2595 0.8642 0.6197 0.6625 0.7169
    F1 0.7341 0.4746 0.3504 0.8551 0.6190 0.6405 0.6904
Acc_avg 0.7294 Prec_avg 0.6529 Recall_avg 0.6117 F1_avg 0.6234
    Total Loss 1.6684 Global Cls Loss 0.8346 Local Cls Loss 0.8338 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0190 (0.0038)
    Batch Time 0.7906 (0.1581)
    Learning Rate 0.0001
    Accuracy 0.1628 0.1628 0.1628 0.1628 0.1628 0.1628 0.1628
    Precision 1.0000 0.0000 0.0000 0.1552 0.0000 0.0625 0.2778
    Recall 0.0476 0.0000 0.0000 0.3750 0.0000 0.0667 0.3030
    F1 0.0909 0.0000 0.0000 0.2195 0.0000 0.0645 0.2899
Acc_avg 0.1628 Prec_avg 0.2136 Recall_avg 0.1132 F1_avg 0.0950
    Total Loss 4.4001 Global Cls Loss 2.2147 Local Cls Loss 2.1854 AFN Loss 0.0000

    [Train]: 
    Epoch 21
    Data Time 2.2663 (0.0061)
    Batch Time 125.5063 (0.3356)
    Learning Rate 1e-05
    Accuracy 0.8915 0.8915 0.8915 0.8915 0.8915 0.8915 0.8915
    Precision 0.8757 0.8414 0.8448 0.9446 0.8616 0.8874 0.8403
    Recall 0.8896 0.7290 0.6872 0.9494 0.8593 0.8561 0.8925
    F1 0.8826 0.7812 0.7579 0.9470 0.8605 0.8714 0.8656
    Acc_avg 0.8915 Prec_avg 0.8708 Recall_avg 0.8376 F1_avg 0.8523
    Total Loss 0.6201 Global Cls Loss 0.3099 Local Cls Loss 0.3102 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3753 (0.0040)
    Batch Time 18.0226 (0.1917)
    Learning Rate 1e-05
    Accuracy 0.7511 0.7511 0.7511 0.7511 0.7511 0.7511 0.7511
    Precision 0.8089 0.6327 0.4580 0.8310 0.6746 0.6800 0.7046
    Recall 0.7292 0.4559 0.3797 0.9026 0.6353 0.6375 0.7184
    F1 0.7670 0.5299 0.4152 0.8653 0.6544 0.6581 0.7114
Acc_avg 0.7511 Prec_avg 0.6842 Recall_avg 0.6370 F1_avg 0.6573
    Total Loss 1.5562 Global Cls Loss 0.7786 Local Cls Loss 0.7776 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6370.

    Test Target: 
    Data Time 0.0185 (0.0037)
    Batch Time 0.8047 (0.1609)
    Learning Rate 1e-05
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.0000 0.0000 0.0000 0.2466 0.0000 0.0000 0.2857
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.3030
    F1 0.0000 0.0000 0.0000 0.3711 0.0000 0.0000 0.2941
Acc_avg 0.2171 Prec_avg 0.0760 Recall_avg 0.1504 F1_avg 0.0950
    Total Loss 4.9019 Global Cls Loss 2.4656 Local Cls Loss 2.4363 AFN Loss 0.0000

    [Train]: 
    Epoch 22
    Data Time 2.1450 (0.0057)
    Batch Time 125.2077 (0.3348)
    Learning Rate 1e-05
    Accuracy 0.9159 0.9159 0.9159 0.9159 0.9159 0.9159 0.9159
    Precision 0.9241 0.8856 0.8712 0.9509 0.8963 0.9169 0.8744
    Recall 0.9095 0.7977 0.7588 0.9639 0.8859 0.8900 0.9156
    F1 0.9167 0.8394 0.8111 0.9573 0.8911 0.9033 0.8945
    Acc_avg 0.9159 Prec_avg 0.9028 Recall_avg 0.8745 F1_avg 0.8876
    Total Loss 0.5172 Global Cls Loss 0.2584 Local Cls Loss 0.2588 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3634 (0.0039)
    Batch Time 18.0456 (0.1920)
    Learning Rate 1e-05
    Accuracy 0.7518 0.7518 0.7518 0.7518 0.7518 0.7518 0.7518
    Precision 0.7850 0.6667 0.4504 0.8389 0.6620 0.6871 0.7089
    Recall 0.7754 0.4412 0.3734 0.8984 0.6398 0.6312 0.7078
    F1 0.7802 0.5310 0.4083 0.8676 0.6507 0.6580 0.7084
Acc_avg 0.7518 Prec_avg 0.6856 Recall_avg 0.6382 F1_avg 0.6577
    Total Loss 1.5460 Global Cls Loss 0.7737 Local Cls Loss 0.7723 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6382.

    Test Target: 
    Data Time 0.0182 (0.0036)
    Batch Time 0.8052 (0.1610)
    Learning Rate 1e-05
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2400 0.0000 0.0000 0.2647
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3636 0.0000 0.0000 0.2687
Acc_avg 0.2093 Prec_avg 0.0721 Recall_avg 0.1461 F1_avg 0.0903
    Total Loss 4.9163 Global Cls Loss 2.4728 Local Cls Loss 2.4435 AFN Loss 0.0000

    [Train]: 
    Epoch 23
    Data Time 2.1435 (0.0057)
    Batch Time 127.6547 (0.3413)
    Learning Rate 1e-05
    Accuracy 0.9206 0.9206 0.9206 0.9206 0.9206 0.9206 0.9206
    Precision 0.9205 0.9087 0.8706 0.9518 0.9035 0.9357 0.8848
    Recall 0.9205 0.8008 0.7924 0.9656 0.8843 0.8959 0.9193
    F1 0.9205 0.8513 0.8297 0.9586 0.8938 0.9154 0.9017
    Acc_avg 0.9206 Prec_avg 0.9108 Recall_avg 0.8827 F1_avg 0.8959
    Total Loss 0.4870 Global Cls Loss 0.2430 Local Cls Loss 0.2440 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3967 (0.0042)
    Batch Time 21.1393 (0.2249)
    Learning Rate 1e-05
    Accuracy 0.7524 0.7524 0.7524 0.7524 0.7524 0.7524 0.7524
    Precision 0.7910 0.5965 0.4688 0.8379 0.6489 0.6600 0.7294
    Recall 0.7569 0.5000 0.3797 0.9052 0.6532 0.6188 0.6943
    F1 0.7736 0.5440 0.4196 0.8703 0.6511 0.6387 0.7114
Acc_avg 0.7524 Prec_avg 0.6761 Recall_avg 0.6440 F1_avg 0.6584
    Total Loss 1.5689 Global Cls Loss 0.7860 Local Cls Loss 0.7829 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6440.

    Test Target: 
    Data Time 0.0193 (0.0039)
    Batch Time 0.8050 (0.1610)
    Learning Rate 1e-05
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2400 0.0000 0.0000 0.2500
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3636 0.0000 0.0000 0.2609
Acc_avg 0.2093 Prec_avg 0.0700 Recall_avg 0.1461 F1_avg 0.0892
    Total Loss 5.1268 Global Cls Loss 2.5821 Local Cls Loss 2.5447 AFN Loss 0.0000

    [Train]: 
    Epoch 24
    Data Time 2.2512 (0.0060)
    Batch Time 122.8544 (0.3285)
    Learning Rate 1e-05
    Accuracy 0.9257 0.9257 0.9257 0.9257 0.9257 0.9257 0.9257
    Precision 0.9287 0.8605 0.8721 0.9592 0.9059 0.9413 0.8928
    Recall 0.9206 0.8473 0.7938 0.9647 0.9045 0.9178 0.9189
    F1 0.9246 0.8538 0.8311 0.9620 0.9052 0.9294 0.9056
    Acc_avg 0.9257 Prec_avg 0.9086 Recall_avg 0.8954 F1_avg 0.9017
    Total Loss 0.4470 Global Cls Loss 0.2232 Local Cls Loss 0.2239 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.6071 (0.0065)
    Batch Time 19.5110 (0.2076)
    Learning Rate 1e-05
    Accuracy 0.7541 0.7541 0.7541 0.7541 0.7541 0.7541 0.7541
    Precision 0.7974 0.5789 0.4238 0.8502 0.6689 0.6884 0.7149
    Recall 0.7631 0.4853 0.4051 0.8967 0.6555 0.5938 0.7139
    F1 0.7799 0.5280 0.4142 0.8728 0.6621 0.6376 0.7144
Acc_avg 0.7541 Prec_avg 0.6747 Recall_avg 0.6447 F1_avg 0.6584
    Total Loss 1.5705 Global Cls Loss 0.7869 Local Cls Loss 0.7836 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6447.

    Test Target: 
    Data Time 0.0171 (0.0034)
    Batch Time 0.8096 (0.1619)
    Learning Rate 1e-05
    Accuracy 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016
    Precision 0.0000 0.0000 0.0000 0.2222 0.0000 0.0000 0.2667
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2424
    F1 0.0000 0.0000 0.0000 0.3429 0.0000 0.0000 0.2540
Acc_avg 0.2016 Prec_avg 0.0698 Recall_avg 0.1418 F1_avg 0.0853
    Total Loss 5.6772 Global Cls Loss 2.8609 Local Cls Loss 2.8162 AFN Loss 0.0000

    [Train]: 
    Epoch 25
    Data Time 2.0997 (0.0056)
    Batch Time 121.3996 (0.3246)
    Learning Rate 1e-05
    Accuracy 0.9311 0.9311 0.9311 0.9311 0.9311 0.9311 0.9311
    Precision 0.9393 0.9087 0.8791 0.9605 0.9201 0.9291 0.8963
    Recall 0.9221 0.8359 0.7952 0.9717 0.9113 0.9223 0.9254
    F1 0.9306 0.8708 0.8351 0.9661 0.9157 0.9257 0.9106
    Acc_avg 0.9311 Prec_avg 0.9190 Recall_avg 0.8977 F1_avg 0.9078
    Total Loss 0.4168 Global Cls Loss 0.2079 Local Cls Loss 0.2089 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3956 (0.0042)
    Batch Time 18.3166 (0.1949)
    Learning Rate 1e-05
    Accuracy 0.7554 0.7554 0.7554 0.7554 0.7554 0.7554 0.7554
    Precision 0.8282 0.6111 0.4706 0.8373 0.6737 0.6765 0.7019
    Recall 0.7415 0.4853 0.3544 0.9052 0.6421 0.5750 0.7410
    F1 0.7825 0.5410 0.4043 0.8699 0.6575 0.6216 0.7209
Acc_avg 0.7554 Prec_avg 0.6856 Recall_avg 0.6349 F1_avg 0.6568
    Total Loss 1.6062 Global Cls Loss 0.8049 Local Cls Loss 0.8013 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0189 (0.0038)
    Batch Time 0.9524 (0.1905)
    Learning Rate 1e-05
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2368 0.0000 0.0000 0.2432
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3600 0.0000 0.0000 0.2571
Acc_avg 0.2093 Prec_avg 0.0686 Recall_avg 0.1461 F1_avg 0.0882
    Total Loss 5.5674 Global Cls Loss 2.8050 Local Cls Loss 2.7624 AFN Loss 0.0000

    [Train]: 
    Epoch 26
    Data Time 2.1886 (0.0059)
    Batch Time 127.2593 (0.3403)
    Learning Rate 1e-05
    Accuracy 0.9357 0.9357 0.9357 0.9357 0.9357 0.9357 0.9357
    Precision 0.9361 0.9500 0.8921 0.9619 0.9200 0.9499 0.9047
    Recall 0.9301 0.8702 0.8345 0.9709 0.9146 0.9206 0.9282
    F1 0.9331 0.9084 0.8623 0.9664 0.9173 0.9350 0.9163
    Acc_avg 0.9357 Prec_avg 0.9307 Recall_avg 0.9099 F1_avg 0.9198
    Total Loss 0.3795 Global Cls Loss 0.1894 Local Cls Loss 0.1901 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3693 (0.0039)
    Batch Time 21.0619 (0.2241)
    Learning Rate 1e-05
    Accuracy 0.7518 0.7518 0.7518 0.7518 0.7518 0.7518 0.7518
    Precision 0.8345 0.6600 0.4069 0.8548 0.6591 0.6970 0.6879
    Recall 0.7446 0.4853 0.3734 0.8847 0.6532 0.5750 0.7470
    F1 0.7870 0.5593 0.3894 0.8695 0.6562 0.6301 0.7162
Acc_avg 0.7518 Prec_avg 0.6857 Recall_avg 0.6376 F1_avg 0.6583
    Total Loss 1.6227 Global Cls Loss 0.8134 Local Cls Loss 0.8093 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0150 (0.0030)
    Batch Time 0.8035 (0.1607)
    Learning Rate 1e-05
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0000 0.0000 0.0000 0.2113 0.0000 0.0000 0.2308
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3158 0.0000 0.0000 0.2500
Acc_avg 0.1860 Prec_avg 0.0631 Recall_avg 0.1282 F1_avg 0.0808
    Total Loss 5.5474 Global Cls Loss 2.7902 Local Cls Loss 2.7572 AFN Loss 0.0000

    [Train]: 
    Epoch 27
    Data Time 2.1263 (0.0057)
    Batch Time 122.6670 (0.3280)
    Learning Rate 1e-05
    Accuracy 0.9377 0.9377 0.9377 0.9377 0.9377 0.9377 0.9377
    Precision 0.9424 0.9241 0.8954 0.9620 0.9245 0.9504 0.9083
    Recall 0.9372 0.8359 0.8413 0.9736 0.9156 0.9267 0.9278
    F1 0.9398 0.8778 0.8675 0.9678 0.9200 0.9384 0.9179
    Acc_avg 0.9377 Prec_avg 0.9296 Recall_avg 0.9083 F1_avg 0.9185
    Total Loss 0.3683 Global Cls Loss 0.1839 Local Cls Loss 0.1844 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3718 (0.0040)
    Batch Time 18.2911 (0.1946)
    Learning Rate 1e-05
    Accuracy 0.7538 0.7538 0.7538 0.7538 0.7538 0.7538 0.7538
    Precision 0.8179 0.5965 0.4296 0.8438 0.6621 0.6358 0.7255
    Recall 0.7600 0.5000 0.3861 0.8992 0.6532 0.6000 0.7123
    F1 0.7879 0.5440 0.4067 0.8706 0.6577 0.6174 0.7188
Acc_avg 0.7538 Prec_avg 0.6730 Recall_avg 0.6444 F1_avg 0.6576
    Total Loss 1.6418 Global Cls Loss 0.8237 Local Cls Loss 0.8182 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0180 (0.0036)
    Batch Time 0.8001 (0.1600)
    Learning Rate 1e-05
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 0.0000 0.0000 0.0000 0.2593 0.0000 0.0000 0.2368
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.4000 0.0000 0.0000 0.2535
Acc_avg 0.2326 Prec_avg 0.0709 Recall_avg 0.1640 F1_avg 0.0934
    Total Loss 5.8175 Global Cls Loss 2.9272 Local Cls Loss 2.8903 AFN Loss 0.0000

    [Train]: 
    Epoch 28
    Data Time 2.1175 (0.0057)
    Batch Time 134.4803 (0.3596)
    Learning Rate 1e-05
    Accuracy 0.9403 0.9403 0.9403 0.9403 0.9403 0.9403 0.9403
    Precision 0.9439 0.9027 0.9060 0.9656 0.9290 0.9475 0.9107
    Recall 0.9357 0.8855 0.8513 0.9730 0.9092 0.9267 0.9395
    F1 0.9398 0.8940 0.8778 0.9693 0.9190 0.9370 0.9249
    Acc_avg 0.9403 Prec_avg 0.9293 Recall_avg 0.9173 F1_avg 0.9231
    Total Loss 0.3578 Global Cls Loss 0.1785 Local Cls Loss 0.1793 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3885 (0.0041)
    Batch Time 18.7176 (0.1991)
    Learning Rate 1e-05
    Accuracy 0.7511 0.7511 0.7511 0.7511 0.7511 0.7511 0.7511
    Precision 0.8306 0.6200 0.4225 0.8518 0.6606 0.6531 0.6942
    Recall 0.7692 0.4559 0.3797 0.8881 0.6532 0.6000 0.7214
    F1 0.7987 0.5254 0.4000 0.8696 0.6569 0.6254 0.7075
Acc_avg 0.7511 Prec_avg 0.6761 Recall_avg 0.6382 F1_avg 0.6548
    Total Loss 1.6536 Global Cls Loss 0.8298 Local Cls Loss 0.8238 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0214 (0.0043)
    Batch Time 0.8058 (0.1612)
    Learning Rate 1e-05
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0000 0.0000 0.0000 0.1944 0.0000 0.0000 0.1818
    Recall 0.0000 0.0000 0.0000 0.5833 0.0000 0.0000 0.3030
    F1 0.0000 0.0000 0.0000 0.2917 0.0000 0.0000 0.2273
Acc_avg 0.1860 Prec_avg 0.0538 Recall_avg 0.1266 F1_avg 0.0741
    Total Loss 5.5220 Global Cls Loss 2.7833 Local Cls Loss 2.7387 AFN Loss 0.0000

    [Train]: 
    Epoch 29
    Data Time 2.0135 (0.0054)
    Batch Time 121.4746 (0.3248)
    Learning Rate 1e-05
    Accuracy 0.9423 0.9423 0.9423 0.9423 0.9423 0.9423 0.9423
    Precision 0.9497 0.9292 0.8818 0.9649 0.9248 0.9451 0.9254
    Recall 0.9444 0.8511 0.8373 0.9756 0.9273 0.9354 0.9310
    F1 0.9470 0.8884 0.8590 0.9702 0.9261 0.9402 0.9282
    Acc_avg 0.9423 Prec_avg 0.9316 Recall_avg 0.9146 F1_avg 0.9227
    Total Loss 0.3388 Global Cls Loss 0.1692 Local Cls Loss 0.1696 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3889 (0.0041)
    Batch Time 18.3571 (0.1953)
    Learning Rate 1e-05
    Accuracy 0.7484 0.7484 0.7484 0.7484 0.7484 0.7484 0.7484
    Precision 0.8246 0.6000 0.4186 0.8517 0.6667 0.6525 0.6840
    Recall 0.7231 0.4853 0.3418 0.8830 0.6532 0.5750 0.7530
    F1 0.7705 0.5366 0.3763 0.8671 0.6599 0.6113 0.7168
Acc_avg 0.7484 Prec_avg 0.6711 Recall_avg 0.6306 F1_avg 0.6484
    Total Loss 1.6907 Global Cls Loss 0.8481 Local Cls Loss 0.8426 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0243 (0.0049)
    Batch Time 0.9137 (0.1827)
    Learning Rate 1e-05
    Accuracy 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016
    Precision 0.0000 0.0000 0.0000 0.2319 0.0000 0.0000 0.1786
    Recall 0.0000 0.0000 0.0000 0.6667 0.0000 0.0000 0.3030
    F1 0.0000 0.0000 0.0000 0.3441 0.0000 0.0000 0.2247
Acc_avg 0.2016 Prec_avg 0.0586 Recall_avg 0.1385 F1_avg 0.0813
    Total Loss 5.9658 Global Cls Loss 3.0056 Local Cls Loss 2.9602 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 91.920019s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.561939s

    [Train]: 
    Epoch 30
    Data Time 2.4133 (0.0065)
    Batch Time 128.1196 (0.3426)
    Learning Rate 1e-05
    Accuracy 0.9487 0.9487 0.9487 0.9487 0.9487 0.9487 0.9487
    Precision 0.9547 0.9355 0.9071 0.9694 0.9412 0.9502 0.9245
    Recall 0.9539 0.8855 0.8766 0.9766 0.9257 0.9238 0.9448
    F1 0.9543 0.9098 0.8916 0.9730 0.9334 0.9368 0.9345
    Acc_avg 0.9487 Prec_avg 0.9404 Recall_avg 0.9267 F1_avg 0.9333
    Total Loss 0.3128 Global Cls Loss 0.1562 Local Cls Loss 0.1566 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3664 (0.0039)
    Batch Time 18.2263 (0.1939)
    Learning Rate 1e-05
    Accuracy 0.7471 0.7471 0.7471 0.7471 0.7471 0.7471 0.7471
    Precision 0.8406 0.6200 0.4444 0.8289 0.6667 0.6443 0.6981
    Recall 0.7138 0.4559 0.3797 0.9018 0.6264 0.6000 0.7244
    F1 0.7720 0.5254 0.4096 0.8638 0.6459 0.6214 0.7110
Acc_avg 0.7471 Prec_avg 0.6776 Recall_avg 0.6289 F1_avg 0.6499
    Total Loss 1.7224 Global Cls Loss 0.8637 Local Cls Loss 0.8587 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0196 (0.0039)
    Batch Time 0.7933 (0.1587)
    Learning Rate 1e-05
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.0000 0.0000 0.0000 0.2297 0.0000 0.0000 0.2200
    Recall 0.0000 0.0000 0.0000 0.7083 0.0000 0.0000 0.3333
    F1 0.0000 0.0000 0.0000 0.3469 0.0000 0.0000 0.2651
Acc_avg 0.2171 Prec_avg 0.0642 Recall_avg 0.1488 F1_avg 0.0874
    Total Loss 5.6595 Global Cls Loss 2.8459 Local Cls Loss 2.8136 AFN Loss 0.0000

    [Train]: 
    Epoch 31
    Data Time 2.0536 (0.0055)
    Batch Time 121.4657 (0.3248)
    Learning Rate 1e-05
    Accuracy 0.9523 0.9523 0.9523 0.9523 0.9523 0.9523 0.9523
    Precision 0.9600 0.9240 0.9152 0.9736 0.9369 0.9636 0.9297
    Recall 0.9531 0.8817 0.8780 0.9798 0.9384 0.9326 0.9444
    F1 0.9566 0.9023 0.8962 0.9767 0.9377 0.9478 0.9370
    Acc_avg 0.9523 Prec_avg 0.9433 Recall_avg 0.9297 F1_avg 0.9363
    Total Loss 0.2923 Global Cls Loss 0.1458 Local Cls Loss 0.1465 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3942 (0.0042)
    Batch Time 18.6612 (0.1985)
    Learning Rate 1e-05
    Accuracy 0.7491 0.7491 0.7491 0.7491 0.7491 0.7491 0.7491
    Precision 0.8207 0.5789 0.4150 0.8447 0.6682 0.6463 0.7054
    Recall 0.7323 0.4853 0.3861 0.8915 0.6532 0.5938 0.7214
    F1 0.7740 0.5280 0.4000 0.8675 0.6606 0.6189 0.7133
Acc_avg 0.7491 Prec_avg 0.6685 Recall_avg 0.6377 F1_avg 0.6518
    Total Loss 1.7240 Global Cls Loss 0.8649 Local Cls Loss 0.8591 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0210 (0.0042)
    Batch Time 0.8183 (0.1637)
    Learning Rate 1e-05
    Accuracy 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481
    Precision 1.0000 0.0000 0.0000 0.2469 0.0000 0.0000 0.2368
    Recall 0.1429 0.0000 0.0000 0.8333 0.0000 0.0000 0.2727
    F1 0.2500 0.0000 0.0000 0.3810 0.0000 0.0000 0.2535
Acc_avg 0.2481 Prec_avg 0.2120 Recall_avg 0.1784 F1_avg 0.1264
    Total Loss 5.7048 Global Cls Loss 2.8697 Local Cls Loss 2.8351 AFN Loss 0.0000

    [Train]: 
    Epoch 32
    Data Time 2.0595 (0.0055)
    Batch Time 123.2492 (0.3295)
    Learning Rate 1e-05
    Accuracy 0.9510 0.9510 0.9510 0.9510 0.9510 0.9510 0.9510
    Precision 0.9525 0.9478 0.9118 0.9719 0.9305 0.9526 0.9367
    Recall 0.9563 0.9008 0.8696 0.9785 0.9305 0.9428 0.9428
    F1 0.9544 0.9237 0.8902 0.9752 0.9305 0.9477 0.9397
    Acc_avg 0.9510 Prec_avg 0.9434 Recall_avg 0.9316 F1_avg 0.9373
    Total Loss 0.3023 Global Cls Loss 0.1508 Local Cls Loss 0.1516 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3775 (0.0040)
    Batch Time 19.7424 (0.2100)
    Learning Rate 1e-05
    Accuracy 0.7451 0.7451 0.7451 0.7451 0.7451 0.7451 0.7451
    Precision 0.7898 0.5789 0.4296 0.8306 0.6757 0.6200 0.7112
    Recall 0.7631 0.4853 0.3861 0.9044 0.6107 0.5813 0.6973
    F1 0.7762 0.5280 0.4067 0.8659 0.6416 0.6000 0.7042
Acc_avg 0.7451 Prec_avg 0.6623 Recall_avg 0.6326 F1_avg 0.6461
    Total Loss 1.7336 Global Cls Loss 0.8699 Local Cls Loss 0.8637 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0206 (0.0041)
    Batch Time 0.8244 (0.1649)
    Learning Rate 1e-05
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 1.0000 0.0000 0.0000 0.2360 0.0000 0.0000 0.2000
    Recall 0.0476 0.0000 0.0000 0.8750 0.0000 0.0000 0.1818
    F1 0.0909 0.0000 0.0000 0.3717 0.0000 0.0000 0.1905
Acc_avg 0.2171 Prec_avg 0.2051 Recall_avg 0.1578 F1_avg 0.0933
    Total Loss 6.9167 Global Cls Loss 3.4834 Local Cls Loss 3.4333 AFN Loss 0.0000

    [Train]: 
    Epoch 33
    Data Time 2.1705 (0.0058)
    Batch Time 122.5409 (0.3276)
    Learning Rate 1e-05
    Accuracy 0.9555 0.9555 0.9555 0.9555 0.9555 0.9555 0.9555
    Precision 0.9590 0.9506 0.9364 0.9710 0.9448 0.9689 0.9347
    Recall 0.9491 0.8817 0.9088 0.9811 0.9347 0.9604 0.9460
    F1 0.9541 0.9149 0.9224 0.9760 0.9397 0.9647 0.9403
    Acc_avg 0.9555 Prec_avg 0.9522 Recall_avg 0.9374 F1_avg 0.9446
    Total Loss 0.2739 Global Cls Loss 0.1367 Local Cls Loss 0.1373 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3851 (0.0041)
    Batch Time 19.8282 (0.2109)
    Learning Rate 1e-05
    Accuracy 0.7457 0.7457 0.7457 0.7457 0.7457 0.7457 0.7457
    Precision 0.8160 0.5833 0.4225 0.8244 0.7046 0.6364 0.6948
    Recall 0.7231 0.5147 0.3797 0.9103 0.5817 0.5687 0.7304
    F1 0.7667 0.5469 0.4000 0.8653 0.6373 0.6007 0.7122
Acc_avg 0.7457 Prec_avg 0.6689 Recall_avg 0.6298 F1_avg 0.6470
    Total Loss 1.8051 Global Cls Loss 0.9056 Local Cls Loss 0.8994 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0198 (0.0040)
    Batch Time 0.9623 (0.1925)
    Learning Rate 1e-05
    Accuracy 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481
    Precision 1.0000 0.0000 0.0000 0.2625 0.0000 0.0000 0.2432
    Recall 0.0952 0.0000 0.0000 0.8750 0.0000 0.0000 0.2727
    F1 0.1739 0.0000 0.0000 0.4038 0.0000 0.0000 0.2571
Acc_avg 0.2481 Prec_avg 0.2151 Recall_avg 0.1776 F1_avg 0.1193
    Total Loss 6.3928 Global Cls Loss 3.2161 Local Cls Loss 3.1767 AFN Loss 0.0000

    [Train]: 
    Epoch 34
    Data Time 2.0121 (0.0054)
    Batch Time 122.6343 (0.3279)
    Learning Rate 1e-05
    Accuracy 0.9564 0.9564 0.9564 0.9564 0.9564 0.9564 0.9564
    Precision 0.9622 0.9388 0.9264 0.9762 0.9453 0.9587 0.9336
    Recall 0.9706 0.8779 0.8834 0.9781 0.9438 0.9545 0.9472
    F1 0.9664 0.9073 0.9044 0.9772 0.9445 0.9566 0.9404
    Acc_avg 0.9564 Prec_avg 0.9487 Recall_avg 0.9365 F1_avg 0.9424
    Total Loss 0.2644 Global Cls Loss 0.1318 Local Cls Loss 0.1326 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3694 (0.0039)
    Batch Time 18.1797 (0.1934)
    Learning Rate 1e-05
    Accuracy 0.7524 0.7524 0.7524 0.7524 0.7524 0.7524 0.7524
    Precision 0.8000 0.6346 0.4503 0.8416 0.6822 0.6346 0.7119
    Recall 0.7508 0.4853 0.4304 0.8984 0.6242 0.6188 0.7184
    F1 0.7746 0.5500 0.4401 0.8691 0.6519 0.6266 0.7151
Acc_avg 0.7524 Prec_avg 0.6793 Recall_avg 0.6466 F1_avg 0.6611
    Total Loss 1.7495 Global Cls Loss 0.8780 Local Cls Loss 0.8715 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6466.

    Test Target: 
    Data Time 0.0188 (0.0038)
    Batch Time 0.8499 (0.1700)
    Learning Rate 1e-05
    Accuracy 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403
    Precision 0.5000 0.0000 0.0000 0.2468 0.0000 0.0000 0.2903
    Recall 0.1429 0.0000 0.0000 0.7917 0.0000 0.0000 0.2727
    F1 0.2222 0.0000 0.0000 0.3762 0.0000 0.0000 0.2812
Acc_avg 0.2403 Prec_avg 0.1482 Recall_avg 0.1725 F1_avg 0.1257
    Total Loss 6.4603 Global Cls Loss 3.2495 Local Cls Loss 3.2107 AFN Loss 0.0000

    [Train]: 
    Epoch 35
    Data Time 2.2735 (0.0061)
    Batch Time 128.1282 (0.3426)
    Learning Rate 1e-05
    Accuracy 0.9579 0.9579 0.9579 0.9579 0.9579 0.9579 0.9579
    Precision 0.9553 0.9590 0.9198 0.9752 0.9521 0.9645 0.9391
    Recall 0.9682 0.8966 0.8850 0.9800 0.9485 0.9560 0.9456
    F1 0.9617 0.9267 0.9021 0.9776 0.9503 0.9602 0.9424
    Acc_avg 0.9579 Prec_avg 0.9522 Recall_avg 0.9400 F1_avg 0.9459
    Total Loss 0.2563 Global Cls Loss 0.1279 Local Cls Loss 0.1285 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3810 (0.0041)
    Batch Time 17.8208 (0.1896)
    Learning Rate 1e-05
    Accuracy 0.7568 0.7568 0.7568 0.7568 0.7568 0.7568 0.7568
    Precision 0.8059 0.6600 0.4483 0.8426 0.7062 0.6786 0.6952
    Recall 0.7538 0.4853 0.4114 0.9095 0.6130 0.5938 0.7349
    F1 0.7790 0.5593 0.4290 0.8747 0.6563 0.6333 0.7145
Acc_avg 0.7568 Prec_avg 0.6910 Recall_avg 0.6431 F1_avg 0.6637
    Total Loss 1.7704 Global Cls Loss 0.8888 Local Cls Loss 0.8816 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0200 (0.0040)
    Batch Time 0.7893 (0.1579)
    Learning Rate 1e-05
    Accuracy 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481
    Precision 0.0000 0.0000 0.0000 0.2763 0.0000 0.2500 0.2273
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0667 0.3030
    F1 0.0000 0.0000 0.0000 0.4200 0.0000 0.1053 0.2597
Acc_avg 0.2481 Prec_avg 0.1077 Recall_avg 0.1778 F1_avg 0.1121
    Total Loss 6.1813 Global Cls Loss 3.1143 Local Cls Loss 3.0670 AFN Loss 0.0000

    [Train]: 
    Epoch 36
    Data Time 2.1324 (0.0057)
    Batch Time 123.0648 (0.3291)
    Learning Rate 1e-05
    Accuracy 0.9577 0.9577 0.9577 0.9577 0.9577 0.9577 0.9577
    Precision 0.9624 0.9447 0.9246 0.9749 0.9498 0.9585 0.9391
    Recall 0.9571 0.9122 0.8948 0.9811 0.9432 0.9486 0.9501
    F1 0.9597 0.9282 0.9095 0.9780 0.9465 0.9535 0.9445
    Acc_avg 0.9577 Prec_avg 0.9506 Recall_avg 0.9410 F1_avg 0.9457
    Total Loss 0.2508 Global Cls Loss 0.1248 Local Cls Loss 0.1260 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3902 (0.0042)
    Batch Time 21.8367 (0.2323)
    Learning Rate 1e-05
    Accuracy 0.7524 0.7524 0.7524 0.7524 0.7524 0.7524 0.7524
    Precision 0.8033 0.7111 0.4366 0.8634 0.6421 0.6667 0.6976
    Recall 0.7538 0.4706 0.3924 0.8856 0.6823 0.6125 0.7123
    F1 0.7778 0.5664 0.4133 0.8744 0.6616 0.6384 0.7049
Acc_avg 0.7524 Prec_avg 0.6887 Recall_avg 0.6442 F1_avg 0.6624
    Total Loss 1.7822 Global Cls Loss 0.8949 Local Cls Loss 0.8873 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0211 (0.0042)
    Batch Time 0.8181 (0.1636)
    Learning Rate 1e-05
    Accuracy 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705
    Precision 0.0000 0.0000 0.0000 0.1818 0.0000 0.0000 0.2128
    Recall 0.0000 0.0000 0.0000 0.5000 0.0000 0.0000 0.3030
    F1 0.0000 0.0000 0.0000 0.2667 0.0000 0.0000 0.2500
Acc_avg 0.1705 Prec_avg 0.0564 Recall_avg 0.1147 F1_avg 0.0738
    Total Loss 6.0655 Global Cls Loss 3.0553 Local Cls Loss 3.0102 AFN Loss 0.0000

    [Train]: 
    Epoch 37
    Data Time 2.0477 (0.0055)
    Batch Time 124.0816 (0.3318)
    Learning Rate 1e-05
    Accuracy 0.9601 0.9601 0.9601 0.9601 0.9601 0.9601 0.9601
    Precision 0.9694 0.9272 0.9233 0.9776 0.9475 0.9674 0.9434
    Recall 0.9563 0.9237 0.8948 0.9811 0.9490 0.9575 0.9537
    F1 0.9628 0.9254 0.9088 0.9793 0.9483 0.9624 0.9485
    Acc_avg 0.9601 Prec_avg 0.9508 Recall_avg 0.9452 F1_avg 0.9479
    Total Loss 0.2355 Global Cls Loss 0.1173 Local Cls Loss 0.1183 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.6278 (0.0067)
    Batch Time 19.3318 (0.2057)
    Learning Rate 1e-05
    Accuracy 0.7514 0.7514 0.7514 0.7514 0.7514 0.7514 0.7514
    Precision 0.7827 0.6182 0.4338 0.8619 0.6628 0.6059 0.7077
    Recall 0.7538 0.5000 0.3734 0.8898 0.6465 0.6438 0.7184
    F1 0.7680 0.5528 0.4014 0.8756 0.6546 0.6242 0.7130
Acc_avg 0.7514 Prec_avg 0.6676 Recall_avg 0.6465 F1_avg 0.6557
    Total Loss 1.7941 Global Cls Loss 0.9009 Local Cls Loss 0.8933 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0203 (0.0041)
    Batch Time 0.8025 (0.1605)
    Learning Rate 1e-05
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 1.0000 0.0000 0.0000 0.2368 0.0000 0.0000 0.2571
    Recall 0.0952 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.1739 0.0000 0.0000 0.3600 0.0000 0.0000 0.2647
Acc_avg 0.2248 Prec_avg 0.2134 Recall_avg 0.1597 F1_avg 0.1141
    Total Loss 6.8112 Global Cls Loss 3.4301 Local Cls Loss 3.3810 AFN Loss 0.0000

    [Train]: 
    Epoch 38
    Data Time 2.3182 (0.0062)
    Batch Time 127.3744 (0.3406)
    Learning Rate 1e-05
    Accuracy 0.9612 0.9612 0.9612 0.9612 0.9612 0.9612 0.9612
    Precision 0.9618 0.9451 0.9407 0.9778 0.9473 0.9601 0.9477
    Recall 0.9595 0.9198 0.8917 0.9813 0.9538 0.9516 0.9566
    F1 0.9606 0.9323 0.9155 0.9795 0.9506 0.9558 0.9522
    Acc_avg 0.9612 Prec_avg 0.9543 Recall_avg 0.9449 F1_avg 0.9495
    Total Loss 0.2341 Global Cls Loss 0.1167 Local Cls Loss 0.1173 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5568 (0.0059)
    Batch Time 19.1619 (0.2039)
    Learning Rate 1e-05
    Accuracy 0.7548 0.7548 0.7548 0.7548 0.7548 0.7548 0.7548
    Precision 0.8087 0.7111 0.4072 0.8468 0.6667 0.6369 0.7323
    Recall 0.7415 0.4706 0.4304 0.9061 0.6532 0.6250 0.7003
    F1 0.7737 0.5664 0.4185 0.8754 0.6599 0.6309 0.7159
Acc_avg 0.7548 Prec_avg 0.6871 Recall_avg 0.6467 F1_avg 0.6630
    Total Loss 1.8331 Global Cls Loss 0.9206 Local Cls Loss 0.9126 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6467.

    Test Target: 
    Data Time 0.0221 (0.0044)
    Batch Time 0.9676 (0.1935)
    Learning Rate 1e-05
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2308 0.0000 0.0000 0.2000
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3529 0.0000 0.0000 0.2308
Acc_avg 0.2093 Prec_avg 0.0615 Recall_avg 0.1461 F1_avg 0.0834
    Total Loss 6.6501 Global Cls Loss 3.3487 Local Cls Loss 3.3014 AFN Loss 0.0000

    [Train]: 
    Epoch 39
    Data Time 2.0543 (0.0055)
    Batch Time 122.6992 (0.3281)
    Learning Rate 1e-05
    Accuracy 0.9649 0.9649 0.9649 0.9649 0.9649 0.9649 0.9649
    Precision 0.9684 0.9918 0.9287 0.9800 0.9573 0.9678 0.9471
    Recall 0.9722 0.9198 0.9130 0.9811 0.9517 0.9707 0.9586
    F1 0.9703 0.9545 0.9208 0.9806 0.9545 0.9693 0.9528
    Acc_avg 0.9649 Prec_avg 0.9630 Recall_avg 0.9525 F1_avg 0.9575
    Total Loss 0.2190 Global Cls Loss 0.1092 Local Cls Loss 0.1097 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4089 (0.0044)
    Batch Time 19.3957 (0.2063)
    Learning Rate 1e-05
    Accuracy 0.7538 0.7538 0.7538 0.7538 0.7538 0.7538 0.7538
    Precision 0.7955 0.6875 0.4094 0.8458 0.6541 0.6761 0.7257
    Recall 0.7662 0.4853 0.3861 0.9044 0.6600 0.6000 0.6973
    F1 0.7806 0.5690 0.3974 0.8741 0.6570 0.6358 0.7112
Acc_avg 0.7538 Prec_avg 0.6849 Recall_avg 0.6427 F1_avg 0.6607
    Total Loss 1.8515 Global Cls Loss 0.9300 Local Cls Loss 0.9215 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0193 (0.0039)
    Batch Time 0.8331 (0.1666)
    Learning Rate 1e-05
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2535 0.0000 0.0000 0.1837
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3789 0.0000 0.0000 0.2195
Acc_avg 0.2093 Prec_avg 0.0625 Recall_avg 0.1461 F1_avg 0.0855
    Total Loss 5.9632 Global Cls Loss 3.0010 Local Cls Loss 2.9622 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 82.013122s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.690982s

    [Train]: 
    Epoch 40
    Data Time 2.2229 (0.0059)
    Batch Time 121.3877 (0.3246)
    Learning Rate 1e-05
    Accuracy 0.9665 0.9665 0.9665 0.9665 0.9665 0.9665 0.9665
    Precision 0.9667 0.9529 0.9567 0.9795 0.9572 0.9717 0.9513
    Recall 0.9682 0.9275 0.9299 0.9862 0.9491 0.9560 0.9590
    F1 0.9675 0.9400 0.9431 0.9828 0.9531 0.9638 0.9552
    Acc_avg 0.9665 Prec_avg 0.9623 Recall_avg 0.9537 F1_avg 0.9579
    Total Loss 0.2099 Global Cls Loss 0.1045 Local Cls Loss 0.1054 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3778 (0.0040)
    Batch Time 18.6171 (0.1981)
    Learning Rate 1e-05
    Accuracy 0.7511 0.7511 0.7511 0.7511 0.7511 0.7511 0.7511
    Precision 0.8086 0.6957 0.4257 0.8419 0.6674 0.6500 0.7062
    Recall 0.7538 0.4706 0.3987 0.9001 0.6421 0.5687 0.7169
    F1 0.7803 0.5614 0.4118 0.8700 0.6545 0.6067 0.7115
Acc_avg 0.7511 Prec_avg 0.6851 Recall_avg 0.6358 F1_avg 0.6566
    Total Loss 1.8681 Global Cls Loss 0.9391 Local Cls Loss 0.9290 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0179 (0.0036)
    Batch Time 0.7935 (0.1587)
    Learning Rate 1e-05
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2368 0.0000 0.0000 0.1957
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3600 0.0000 0.0000 0.2278
Acc_avg 0.2093 Prec_avg 0.0618 Recall_avg 0.1461 F1_avg 0.0840
    Total Loss 6.8138 Global Cls Loss 3.4357 Local Cls Loss 3.3780 AFN Loss 0.0000

    [Train]: 
    Epoch 41
    Data Time 2.1981 (0.0059)
    Batch Time 128.4971 (0.3436)
    Learning Rate 1e-06
    Accuracy 0.9652 0.9652 0.9652 0.9652 0.9652 0.9652 0.9652
    Precision 0.9698 0.9759 0.9443 0.9776 0.9629 0.9504 0.9496
    Recall 0.9682 0.9275 0.9032 0.9847 0.9491 0.9574 0.9627
    F1 0.9690 0.9511 0.9233 0.9811 0.9559 0.9539 0.9561
    Acc_avg 0.9652 Prec_avg 0.9615 Recall_avg 0.9504 F1_avg 0.9558
    Total Loss 0.2088 Global Cls Loss 0.1040 Local Cls Loss 0.1047 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3676 (0.0039)
    Batch Time 17.9382 (0.1908)
    Learning Rate 1e-06
    Accuracy 0.7521 0.7521 0.7521 0.7521 0.7521 0.7521 0.7521
    Precision 0.8151 0.6415 0.4380 0.8436 0.6594 0.6250 0.7187
    Recall 0.7323 0.5000 0.3797 0.8984 0.6756 0.5938 0.7078
    F1 0.7715 0.5620 0.4068 0.8701 0.6674 0.6090 0.7132
Acc_avg 0.7521 Prec_avg 0.6773 Recall_avg 0.6411 F1_avg 0.6571
    Total Loss 1.8639 Global Cls Loss 0.9373 Local Cls Loss 0.9266 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0207 (0.0041)
    Batch Time 0.7893 (0.1579)
    Learning Rate 1e-06
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.0000 0.0000 0.0000 0.2500 0.0000 0.0000 0.1951
    Recall 0.0000 0.0000 0.0000 0.8333 0.0000 0.0000 0.2424
    F1 0.0000 0.0000 0.0000 0.3846 0.0000 0.0000 0.2162
Acc_avg 0.2171 Prec_avg 0.0636 Recall_avg 0.1537 F1_avg 0.0858
    Total Loss 6.8782 Global Cls Loss 3.4693 Local Cls Loss 3.4089 AFN Loss 0.0000

    [Train]: 
    Epoch 42
    Data Time 2.1715 (0.0058)
    Batch Time 125.9739 (0.3368)
    Learning Rate 1e-06
    Accuracy 0.9682 0.9682 0.9682 0.9682 0.9682 0.9682 0.9682
    Precision 0.9704 0.9593 0.9647 0.9765 0.9657 0.9721 0.9537
    Recall 0.9658 0.9008 0.9187 0.9877 0.9575 0.9692 0.9615
    F1 0.9681 0.9291 0.9411 0.9820 0.9616 0.9706 0.9576
    Acc_avg 0.9682 Prec_avg 0.9661 Recall_avg 0.9516 F1_avg 0.9586
    Total Loss 0.1984 Global Cls Loss 0.0990 Local Cls Loss 0.0995 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3783 (0.0040)
    Batch Time 20.2040 (0.2149)
    Learning Rate 1e-06
    Accuracy 0.7487 0.7487 0.7487 0.7487 0.7487 0.7487 0.7487
    Precision 0.8123 0.6471 0.4106 0.8507 0.6497 0.6169 0.7172
    Recall 0.7323 0.4853 0.3924 0.8907 0.6846 0.5938 0.6988
    F1 0.7702 0.5546 0.4013 0.8703 0.6667 0.6051 0.7079
Acc_avg 0.7487 Prec_avg 0.6721 Recall_avg 0.6397 F1_avg 0.6537
    Total Loss 1.8705 Global Cls Loss 0.9403 Local Cls Loss 0.9303 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0209 (0.0042)
    Batch Time 0.8274 (0.1655)
    Learning Rate 1e-06
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2368 0.0000 0.0000 0.1957
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3600 0.0000 0.0000 0.2278
Acc_avg 0.2093 Prec_avg 0.0618 Recall_avg 0.1461 F1_avg 0.0840
    Total Loss 6.4621 Global Cls Loss 3.2548 Local Cls Loss 3.2072 AFN Loss 0.0000

    [Train]: 
    Epoch 43
    Data Time 2.0487 (0.0055)
    Batch Time 122.2994 (0.3270)
    Learning Rate 1e-06
    Accuracy 0.9687 0.9687 0.9687 0.9687 0.9687 0.9687 0.9687
    Precision 0.9775 0.9685 0.9604 0.9795 0.9598 0.9720 0.9516
    Recall 0.9674 0.9389 0.9185 0.9868 0.9511 0.9677 0.9659
    F1 0.9725 0.9535 0.9390 0.9832 0.9555 0.9699 0.9587
    Acc_avg 0.9687 Prec_avg 0.9671 Recall_avg 0.9566 F1_avg 0.9617
    Total Loss 0.1920 Global Cls Loss 0.0955 Local Cls Loss 0.0965 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3744 (0.0040)
    Batch Time 17.8777 (0.1902)
    Learning Rate 1e-06
    Accuracy 0.7541 0.7541 0.7541 0.7541 0.7541 0.7541 0.7541
    Precision 0.7961 0.6538 0.4306 0.8491 0.6667 0.6443 0.7200
    Recall 0.7569 0.5000 0.3924 0.8941 0.6801 0.6000 0.7048
    F1 0.7760 0.5667 0.4106 0.8710 0.6733 0.6214 0.7123
Acc_avg 0.7541 Prec_avg 0.6801 Recall_avg 0.6469 F1_avg 0.6616
    Total Loss 1.8351 Global Cls Loss 0.9224 Local Cls Loss 0.9127 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6469.

    Test Target: 
    Data Time 0.0212 (0.0042)
    Batch Time 0.8312 (0.1662)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2727 0.0000 0.0000 0.1951
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0000 0.2424
    F1 0.0000 0.0000 0.0000 0.4158 0.0000 0.0000 0.2162
Acc_avg 0.2248 Prec_avg 0.0668 Recall_avg 0.1596 F1_avg 0.0903
    Total Loss 6.5813 Global Cls Loss 3.3147 Local Cls Loss 3.2666 AFN Loss 0.0000

    [Train]: 
    Epoch 44
    Data Time 2.0382 (0.0054)
    Batch Time 125.4605 (0.3355)
    Learning Rate 1e-06
    Accuracy 0.9701 0.9701 0.9701 0.9701 0.9701 0.9701 0.9701
    Precision 0.9661 0.9603 0.9438 0.9818 0.9663 0.9633 0.9628
    Recall 0.9754 0.9237 0.9187 0.9868 0.9581 0.9648 0.9659
    F1 0.9707 0.9416 0.9311 0.9843 0.9622 0.9640 0.9643
    Acc_avg 0.9701 Prec_avg 0.9635 Recall_avg 0.9562 F1_avg 0.9598
    Total Loss 0.1864 Global Cls Loss 0.0928 Local Cls Loss 0.0935 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3706 (0.0039)
    Batch Time 18.0959 (0.1925)
    Learning Rate 1e-06
    Accuracy 0.7518 0.7518 0.7518 0.7518 0.7518 0.7518 0.7518
    Precision 0.7987 0.6600 0.4245 0.8454 0.6737 0.6486 0.7040
    Recall 0.7446 0.4853 0.3734 0.9009 0.6421 0.6000 0.7199
    F1 0.7707 0.5593 0.3973 0.8723 0.6575 0.6234 0.7118
Acc_avg 0.7518 Prec_avg 0.6793 Recall_avg 0.6380 F1_avg 0.6560
    Total Loss 1.8583 Global Cls Loss 0.9338 Local Cls Loss 0.9245 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0184 (0.0037)
    Batch Time 0.7829 (0.1566)
    Learning Rate 1e-06
    Accuracy 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403
    Precision 1.0000 0.0000 0.0000 0.2597 0.0000 0.0000 0.2143
    Recall 0.0952 0.0000 0.0000 0.8333 0.0000 0.0000 0.2727
    F1 0.1739 0.0000 0.0000 0.3960 0.0000 0.0000 0.2400
Acc_avg 0.2403 Prec_avg 0.2106 Recall_avg 0.1716 F1_avg 0.1157
    Total Loss 6.8462 Global Cls Loss 3.4447 Local Cls Loss 3.4015 AFN Loss 0.0000

    [Train]: 
    Epoch 45
    Data Time 2.0722 (0.0055)
    Batch Time 122.6480 (0.3279)
    Learning Rate 1e-06
    Accuracy 0.9713 0.9713 0.9713 0.9713 0.9713 0.9713 0.9713
    Precision 0.9685 0.9425 0.9522 0.9822 0.9705 0.9722 0.9604
    Recall 0.9754 0.9389 0.9229 0.9872 0.9597 0.9736 0.9643
    F1 0.9719 0.9407 0.9373 0.9847 0.9650 0.9729 0.9623
    Acc_avg 0.9713 Prec_avg 0.9641 Recall_avg 0.9603 F1_avg 0.9621
    Total Loss 0.1875 Global Cls Loss 0.0936 Local Cls Loss 0.0939 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4623 (0.0049)
    Batch Time 19.5275 (0.2077)
    Learning Rate 1e-06
    Accuracy 0.7544 0.7544 0.7544 0.7544 0.7544 0.7544 0.7544
    Precision 0.8000 0.6939 0.4380 0.8297 0.6792 0.6463 0.7280
    Recall 0.7508 0.5000 0.3797 0.9155 0.6488 0.5938 0.6973
    F1 0.7746 0.5812 0.4068 0.8705 0.6636 0.6189 0.7123
Acc_avg 0.7544 Prec_avg 0.6879 Recall_avg 0.6408 F1_avg 0.6611
    Total Loss 1.9024 Global Cls Loss 0.9570 Local Cls Loss 0.9454 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0184 (0.0037)
    Batch Time 0.9407 (0.1881)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2561 0.0000 0.0000 0.2222
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0000 0.2424
    F1 0.0000 0.0000 0.0000 0.3962 0.0000 0.0000 0.2319
Acc_avg 0.2248 Prec_avg 0.0683 Recall_avg 0.1596 F1_avg 0.0897
    Total Loss 7.2461 Global Cls Loss 3.6532 Local Cls Loss 3.5929 AFN Loss 0.0000

    [Train]: 
    Epoch 46
    Data Time 1.9233 (0.0051)
    Batch Time 124.3668 (0.3325)
    Learning Rate 1e-06
    Accuracy 0.9684 0.9684 0.9684 0.9684 0.9684 0.9684 0.9684
    Precision 0.9767 0.9468 0.9490 0.9816 0.9565 0.9675 0.9562
    Recall 0.9650 0.9504 0.9130 0.9872 0.9554 0.9604 0.9643
    F1 0.9708 0.9486 0.9307 0.9844 0.9559 0.9639 0.9602
    Acc_avg 0.9684 Prec_avg 0.9620 Recall_avg 0.9565 F1_avg 0.9592
    Total Loss 0.1901 Global Cls Loss 0.0947 Local Cls Loss 0.0954 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3792 (0.0040)
    Batch Time 17.9954 (0.1914)
    Learning Rate 1e-06
    Accuracy 0.7541 0.7541 0.7541 0.7541 0.7541 0.7541 0.7541
    Precision 0.7908 0.6415 0.4496 0.8340 0.6860 0.6443 0.7178
    Recall 0.7446 0.5000 0.3671 0.9137 0.6353 0.6000 0.7123
    F1 0.7670 0.5620 0.4042 0.8720 0.6597 0.6214 0.7150
Acc_avg 0.7541 Prec_avg 0.6806 Recall_avg 0.6390 F1_avg 0.6573
    Total Loss 1.8958 Global Cls Loss 0.9535 Local Cls Loss 0.9424 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0191 (0.0038)
    Batch Time 0.8025 (0.1605)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2593 0.0000 0.0000 0.2051
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0000 0.2424
    F1 0.0000 0.0000 0.0000 0.4000 0.0000 0.0000 0.2222
Acc_avg 0.2248 Prec_avg 0.0663 Recall_avg 0.1596 F1_avg 0.0889
    Total Loss 6.8030 Global Cls Loss 3.4305 Local Cls Loss 3.3725 AFN Loss 0.0000

    [Train]: 
    Epoch 47
    Data Time 2.2554 (0.0060)
    Batch Time 128.9769 (0.3449)
    Learning Rate 1e-06
    Accuracy 0.9690 0.9690 0.9690 0.9690 0.9690 0.9690 0.9690
    Precision 0.9722 0.9560 0.9539 0.9809 0.9597 0.9777 0.9550
    Recall 0.9722 0.9122 0.9285 0.9830 0.9613 0.9663 0.9651
    F1 0.9722 0.9336 0.9410 0.9819 0.9605 0.9720 0.9600
    Acc_avg 0.9690 Prec_avg 0.9651 Recall_avg 0.9555 F1_avg 0.9602
    Total Loss 0.1878 Global Cls Loss 0.0935 Local Cls Loss 0.0943 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3772 (0.0040)
    Batch Time 17.8989 (0.1904)
    Learning Rate 1e-06
    Accuracy 0.7518 0.7518 0.7518 0.7518 0.7518 0.7518 0.7518
    Precision 0.7806 0.6182 0.3916 0.8654 0.6726 0.5988 0.7242
    Recall 0.7662 0.5000 0.4114 0.8839 0.6711 0.6062 0.7078
    F1 0.7733 0.5528 0.4012 0.8745 0.6719 0.6025 0.7159
Acc_avg 0.7518 Prec_avg 0.6645 Recall_avg 0.6495 F1_avg 0.6560
    Total Loss 1.8640 Global Cls Loss 0.9372 Local Cls Loss 0.9268 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6495.

    Test Target: 
    Data Time 0.0182 (0.0036)
    Batch Time 0.8058 (0.1612)
    Learning Rate 1e-06
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2432 0.0000 0.1000 0.2000
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0667 0.2424
    F1 0.0000 0.0000 0.0000 0.3673 0.0000 0.0800 0.2192
Acc_avg 0.2093 Prec_avg 0.0776 Recall_avg 0.1513 F1_avg 0.0952
    Total Loss 6.1915 Global Cls Loss 3.1125 Local Cls Loss 3.0790 AFN Loss 0.0000

    [Train]: 
    Epoch 48
    Data Time 1.9864 (0.0053)
    Batch Time 123.5093 (0.3302)
    Learning Rate 1e-06
    Accuracy 0.9707 0.9707 0.9707 0.9707 0.9707 0.9707 0.9707
    Precision 0.9762 0.9611 0.9536 0.9827 0.9621 0.9706 0.9573
    Recall 0.9762 0.9427 0.9215 0.9875 0.9565 0.9677 0.9647
    F1 0.9762 0.9518 0.9372 0.9851 0.9593 0.9692 0.9610
    Acc_avg 0.9707 Prec_avg 0.9662 Recall_avg 0.9595 F1_avg 0.9628
    Total Loss 0.1958 Global Cls Loss 0.0976 Local Cls Loss 0.0982 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3458 (0.0037)
    Batch Time 17.8918 (0.1903)
    Learning Rate 1e-06
    Accuracy 0.7551 0.7551 0.7551 0.7551 0.7551 0.7551 0.7551
    Precision 0.7774 0.6538 0.4214 0.8648 0.6638 0.6815 0.7066
    Recall 0.7631 0.5000 0.3734 0.8796 0.6890 0.5750 0.7364
    F1 0.7702 0.5667 0.3960 0.8721 0.6762 0.6237 0.7212
Acc_avg 0.7551 Prec_avg 0.6813 Recall_avg 0.6452 F1_avg 0.6609
    Total Loss 1.8516 Global Cls Loss 0.9311 Local Cls Loss 0.9205 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0186 (0.0037)
    Batch Time 0.7916 (0.1583)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 1.0000 0.0000 0.0000 0.2500 0.0000 0.0000 0.1915
    Recall 0.0952 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.1739 0.0000 0.0000 0.3750 0.0000 0.0000 0.2250
Acc_avg 0.2248 Prec_avg 0.2059 Recall_avg 0.1597 F1_avg 0.1106
    Total Loss 6.3285 Global Cls Loss 3.1844 Local Cls Loss 3.1441 AFN Loss 0.0000

    [Train]: 
    Epoch 49
    Data Time 2.0237 (0.0054)
    Batch Time 123.6419 (0.3306)
    Learning Rate 1e-06
    Accuracy 0.9720 0.9720 0.9720 0.9720 0.9720 0.9720 0.9720
    Precision 0.9807 0.9609 0.9524 0.9837 0.9685 0.9651 0.9568
    Recall 0.9690 0.9389 0.9270 0.9866 0.9613 0.9736 0.9700
    F1 0.9748 0.9498 0.9395 0.9851 0.9649 0.9693 0.9633
    Acc_avg 0.9720 Prec_avg 0.9669 Recall_avg 0.9609 F1_avg 0.9638
    Total Loss 0.1787 Global Cls Loss 0.0889 Local Cls Loss 0.0897 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4129 (0.0044)
    Batch Time 19.8417 (0.2111)
    Learning Rate 1e-06
    Accuracy 0.7544 0.7544 0.7544 0.7544 0.7544 0.7544 0.7544
    Precision 0.7778 0.6538 0.4118 0.8569 0.6990 0.6234 0.7076
    Recall 0.7538 0.5000 0.3987 0.8950 0.6443 0.6000 0.7289
    F1 0.7656 0.5667 0.4051 0.8755 0.6705 0.6115 0.7181
Acc_avg 0.7544 Prec_avg 0.6758 Recall_avg 0.6458 F1_avg 0.6590
    Total Loss 1.8641 Global Cls Loss 0.9373 Local Cls Loss 0.9268 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0185 (0.0037)
    Batch Time 0.7888 (0.1578)
    Learning Rate 1e-06
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2368 0.0000 0.0000 0.2000
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3600 0.0000 0.0000 0.2308
Acc_avg 0.2093 Prec_avg 0.0624 Recall_avg 0.1461 F1_avg 0.0844
    Total Loss 6.6199 Global Cls Loss 3.3337 Local Cls Loss 3.2861 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 81.754682s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 14.640991s

    [Train]: 
    Epoch 50
    Data Time 2.3339 (0.0062)
    Batch Time 130.6937 (0.3494)
    Learning Rate 1e-06
    Accuracy 0.9715 0.9715 0.9715 0.9715 0.9715 0.9715 0.9715
    Precision 0.9752 0.9680 0.9594 0.9803 0.9640 0.9748 0.9613
    Recall 0.9682 0.9237 0.9271 0.9860 0.9671 0.9662 0.9683
    F1 0.9717 0.9453 0.9429 0.9831 0.9656 0.9705 0.9648
    Acc_avg 0.9715 Prec_avg 0.9690 Recall_avg 0.9581 F1_avg 0.9634
    Total Loss 0.1806 Global Cls Loss 0.0899 Local Cls Loss 0.0906 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.4186 (0.0045)
    Batch Time 20.2655 (0.2156)
    Learning Rate 1e-06
    Accuracy 0.7524 0.7524 0.7524 0.7524 0.7524 0.7524 0.7524
    Precision 0.7538 0.6538 0.4266 0.8554 0.6850 0.6414 0.7075
    Recall 0.7723 0.5000 0.3861 0.8941 0.6421 0.5813 0.7214
    F1 0.7629 0.5667 0.4053 0.8743 0.6628 0.6098 0.7144
Acc_avg 0.7524 Prec_avg 0.6748 Recall_avg 0.6425 F1_avg 0.6566
    Total Loss 1.8478 Global Cls Loss 0.9286 Local Cls Loss 0.9192 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0213 (0.0043)
    Batch Time 0.8051 (0.1610)
    Learning Rate 1e-06
    Accuracy 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481 0.2481
    Precision 1.0000 0.0000 0.0000 0.2727 0.0000 0.0000 0.2143
    Recall 0.0952 0.0000 0.0000 0.8750 0.0000 0.0000 0.2727
    F1 0.1739 0.0000 0.0000 0.4158 0.0000 0.0000 0.2400
Acc_avg 0.2481 Prec_avg 0.2124 Recall_avg 0.1776 F1_avg 0.1185
    Total Loss 6.6592 Global Cls Loss 3.3690 Local Cls Loss 3.2902 AFN Loss 0.0000

    [Train]: 
    Epoch 51
    Data Time 2.3830 (0.0064)
    Batch Time 126.7552 (0.3389)
    Learning Rate 1e-06
    Accuracy 0.9707 0.9707 0.9707 0.9707 0.9707 0.9707 0.9707
    Precision 0.9707 0.9490 0.9609 0.9845 0.9668 0.9621 0.9549
    Recall 0.9722 0.9272 0.9299 0.9843 0.9581 0.9677 0.9708
    F1 0.9714 0.9380 0.9451 0.9844 0.9624 0.9649 0.9628
    Acc_avg 0.9707 Prec_avg 0.9641 Recall_avg 0.9586 F1_avg 0.9613
    Total Loss 0.1803 Global Cls Loss 0.0899 Local Cls Loss 0.0905 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4558 (0.0048)
    Batch Time 19.7300 (0.2099)
    Learning Rate 1e-06
    Accuracy 0.7501 0.7501 0.7501 0.7501 0.7501 0.7501 0.7501
    Precision 0.7760 0.6182 0.4079 0.8466 0.6797 0.6351 0.7165
    Recall 0.7569 0.5000 0.3924 0.9001 0.6600 0.5875 0.6928
    F1 0.7664 0.5528 0.4000 0.8725 0.6697 0.6104 0.7044
Acc_avg 0.7501 Prec_avg 0.6686 Recall_avg 0.6414 F1_avg 0.6537
    Total Loss 1.8667 Global Cls Loss 0.9384 Local Cls Loss 0.9283 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0195 (0.0039)
    Batch Time 0.9299 (0.1860)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2593 0.0000 0.0000 0.2000
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0000 0.2424
    F1 0.0000 0.0000 0.0000 0.4000 0.0000 0.0000 0.2192
Acc_avg 0.2248 Prec_avg 0.0656 Recall_avg 0.1596 F1_avg 0.0885
    Total Loss 7.0937 Global Cls Loss 3.5925 Local Cls Loss 3.5012 AFN Loss 0.0000

    [Train]: 
    Epoch 52
    Data Time 2.1411 (0.0057)
    Batch Time 127.9207 (0.3420)
    Learning Rate 1e-06
    Accuracy 0.9712 0.9712 0.9712 0.9712 0.9712 0.9712 0.9712
    Precision 0.9716 0.9881 0.9372 0.9835 0.9648 0.9732 0.9599
    Recall 0.9778 0.9542 0.9425 0.9862 0.9607 0.9589 0.9606
    F1 0.9747 0.9709 0.9399 0.9848 0.9628 0.9660 0.9603
    Acc_avg 0.9712 Prec_avg 0.9683 Recall_avg 0.9630 F1_avg 0.9656
    Total Loss 0.1772 Global Cls Loss 0.0884 Local Cls Loss 0.0888 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3539 (0.0038)
    Batch Time 17.9337 (0.1908)
    Learning Rate 1e-06
    Accuracy 0.7531 0.7531 0.7531 0.7531 0.7531 0.7531 0.7531
    Precision 0.7806 0.6800 0.4200 0.8638 0.6859 0.6395 0.6928
    Recall 0.7662 0.5000 0.3987 0.8830 0.6398 0.5875 0.7440
    F1 0.7733 0.5763 0.4091 0.8733 0.6620 0.6124 0.7175
Acc_avg 0.7531 Prec_avg 0.6804 Recall_avg 0.6456 F1_avg 0.6606
    Total Loss 1.8567 Global Cls Loss 0.9330 Local Cls Loss 0.9237 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0214 (0.0043)
    Batch Time 0.8087 (0.1617)
    Learning Rate 1e-06
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2466 0.0000 0.0000 0.1875
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3711 0.0000 0.0000 0.2222
Acc_avg 0.2093 Prec_avg 0.0620 Recall_avg 0.1461 F1_avg 0.0848
    Total Loss 6.5345 Global Cls Loss 3.3053 Local Cls Loss 3.2292 AFN Loss 0.0000

    [Train]: 
    Epoch 53
    Data Time 2.2394 (0.0060)
    Batch Time 127.1977 (0.3401)
    Learning Rate 1e-06
    Accuracy 0.9709 0.9709 0.9709 0.9709 0.9709 0.9709 0.9709
    Precision 0.9705 0.9881 0.9566 0.9829 0.9653 0.9865 0.9509
    Recall 0.9658 0.9504 0.9271 0.9875 0.9597 0.9633 0.9675
    F1 0.9682 0.9689 0.9416 0.9852 0.9625 0.9748 0.9592
    Acc_avg 0.9709 Prec_avg 0.9715 Recall_avg 0.9602 F1_avg 0.9657
    Total Loss 0.1833 Global Cls Loss 0.0910 Local Cls Loss 0.0924 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3847 (0.0041)
    Batch Time 17.9570 (0.1910)
    Learning Rate 1e-06
    Accuracy 0.7514 0.7514 0.7514 0.7514 0.7514 0.7514 0.7514
    Precision 0.7553 0.6296 0.4380 0.8441 0.6712 0.6597 0.7215
    Recall 0.7692 0.5000 0.3797 0.9018 0.6667 0.5938 0.6867
    F1 0.7622 0.5574 0.4068 0.8720 0.6689 0.6250 0.7037
Acc_avg 0.7514 Prec_avg 0.6742 Recall_avg 0.6426 F1_avg 0.6566
    Total Loss 1.8802 Global Cls Loss 0.9450 Local Cls Loss 0.9352 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0190 (0.0038)
    Batch Time 0.7867 (0.1573)
    Learning Rate 1e-06
    Accuracy 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403
    Precision 1.0000 0.0000 0.0000 0.2597 0.0000 0.0000 0.2195
    Recall 0.0952 0.0000 0.0000 0.8333 0.0000 0.0000 0.2727
    F1 0.1739 0.0000 0.0000 0.3960 0.0000 0.0000 0.2432
Acc_avg 0.2403 Prec_avg 0.2113 Recall_avg 0.1716 F1_avg 0.1162
    Total Loss 6.9272 Global Cls Loss 3.5042 Local Cls Loss 3.4230 AFN Loss 0.0000

    [Train]: 
    Epoch 54
    Data Time 2.0680 (0.0055)
    Batch Time 126.8354 (0.3391)
    Learning Rate 1e-06
    Accuracy 0.9702 0.9702 0.9702 0.9702 0.9702 0.9702 0.9702
    Precision 0.9704 0.9506 0.9497 0.9835 0.9628 0.9692 0.9583
    Recall 0.9643 0.9542 0.9284 0.9870 0.9623 0.9706 0.9606
    F1 0.9673 0.9524 0.9389 0.9853 0.9626 0.9699 0.9595
    Acc_avg 0.9702 Prec_avg 0.9635 Recall_avg 0.9611 F1_avg 0.9623
    Total Loss 0.1781 Global Cls Loss 0.0887 Local Cls Loss 0.0894 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3687 (0.0039)
    Batch Time 17.9202 (0.1906)
    Learning Rate 1e-06
    Accuracy 0.7534 0.7534 0.7534 0.7534 0.7534 0.7534 0.7534
    Precision 0.8040 0.6538 0.4161 0.8600 0.6773 0.6129 0.7052
    Recall 0.7446 0.5000 0.3924 0.8864 0.6622 0.5938 0.7349
    F1 0.7732 0.5667 0.4039 0.8730 0.6697 0.6032 0.7198
Acc_avg 0.7534 Prec_avg 0.6756 Recall_avg 0.6449 F1_avg 0.6585
    Total Loss 1.8709 Global Cls Loss 0.9401 Local Cls Loss 0.9308 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0205 (0.0041)
    Batch Time 0.9387 (0.1877)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2647 0.0000 0.2500 0.1961
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0667 0.3030
    F1 0.0000 0.0000 0.0000 0.3913 0.0000 0.1053 0.2381
Acc_avg 0.2248 Prec_avg 0.1015 Recall_avg 0.1600 F1_avg 0.1050
    Total Loss 6.5173 Global Cls Loss 3.2937 Local Cls Loss 3.2236 AFN Loss 0.0000

    [Train]: 
    Epoch 55
    Data Time 2.0921 (0.0056)
    Batch Time 121.1812 (0.3240)
    Learning Rate 1e-06
    Accuracy 0.9712 0.9712 0.9712 0.9712 0.9712 0.9712 0.9712
    Precision 0.9792 0.9646 0.9449 0.9818 0.9621 0.9820 0.9588
    Recall 0.9730 0.9351 0.9383 0.9889 0.9565 0.9604 0.9639
    F1 0.9761 0.9496 0.9416 0.9854 0.9593 0.9711 0.9613
    Acc_avg 0.9712 Prec_avg 0.9676 Recall_avg 0.9594 F1_avg 0.9635
    Total Loss 0.1823 Global Cls Loss 0.0907 Local Cls Loss 0.0917 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4833 (0.0051)
    Batch Time 20.7523 (0.2208)
    Learning Rate 1e-06
    Accuracy 0.7521 0.7521 0.7521 0.7521 0.7521 0.7521 0.7521
    Precision 0.7961 0.6538 0.4013 0.8540 0.6659 0.6242 0.7215
    Recall 0.7446 0.5000 0.3987 0.8941 0.6779 0.5813 0.7063
    F1 0.7695 0.5667 0.4000 0.8736 0.6718 0.6019 0.7139
Acc_avg 0.7521 Prec_avg 0.6738 Recall_avg 0.6433 F1_avg 0.6568
    Total Loss 1.8774 Global Cls Loss 0.9435 Local Cls Loss 0.9339 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0183 (0.0037)
    Batch Time 0.9333 (0.1867)
    Learning Rate 1e-06
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2400 0.0000 0.0000 0.1957
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.0000 0.0000 0.0000 0.3636 0.0000 0.0000 0.2278
Acc_avg 0.2093 Prec_avg 0.0622 Recall_avg 0.1461 F1_avg 0.0845
    Total Loss 6.5400 Global Cls Loss 3.3042 Local Cls Loss 3.2359 AFN Loss 0.0000

    [Train]: 
    Epoch 56
    Data Time 2.1952 (0.0059)
    Batch Time 122.3405 (0.3271)
    Learning Rate 1e-06
    Accuracy 0.9725 0.9725 0.9725 0.9725 0.9725 0.9725 0.9725
    Precision 0.9693 0.9535 0.9562 0.9860 0.9655 0.9636 0.9628
    Recall 0.9793 0.9389 0.9187 0.9870 0.9644 0.9692 0.9675
    F1 0.9743 0.9462 0.9371 0.9865 0.9649 0.9664 0.9652
    Acc_avg 0.9725 Prec_avg 0.9653 Recall_avg 0.9607 F1_avg 0.9629
    Total Loss 0.1696 Global Cls Loss 0.0845 Local Cls Loss 0.0852 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4616 (0.0049)
    Batch Time 18.4333 (0.1961)
    Learning Rate 1e-06
    Accuracy 0.7514 0.7514 0.7514 0.7514 0.7514 0.7514 0.7514
    Precision 0.8116 0.5862 0.4348 0.8389 0.6610 0.6316 0.7295
    Recall 0.7292 0.5000 0.3797 0.9026 0.6980 0.6000 0.6822
    F1 0.7682 0.5397 0.4054 0.8696 0.6790 0.6154 0.7051
Acc_avg 0.7514 Prec_avg 0.6705 Recall_avg 0.6417 F1_avg 0.6546
    Total Loss 1.8997 Global Cls Loss 0.9549 Local Cls Loss 0.9448 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0215 (0.0043)
    Batch Time 0.8391 (0.1678)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2593 0.0000 0.0000 0.2105
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0000 0.2424
    F1 0.0000 0.0000 0.0000 0.4000 0.0000 0.0000 0.2254
Acc_avg 0.2248 Prec_avg 0.0671 Recall_avg 0.1596 F1_avg 0.0893
    Total Loss 6.9420 Global Cls Loss 3.5121 Local Cls Loss 3.4299 AFN Loss 0.0000

    [Train]: 
    Epoch 57
    Data Time 2.2346 (0.0060)
    Batch Time 124.1074 (0.3318)
    Learning Rate 1e-06
    Accuracy 0.9734 0.9734 0.9734 0.9734 0.9734 0.9734 0.9734
    Precision 0.9724 0.9612 0.9563 0.9854 0.9681 0.9762 0.9606
    Recall 0.9801 0.9466 0.9215 0.9875 0.9666 0.9633 0.9692
    F1 0.9762 0.9538 0.9386 0.9864 0.9673 0.9697 0.9649
    Acc_avg 0.9734 Prec_avg 0.9686 Recall_avg 0.9621 F1_avg 0.9653
    Total Loss 0.1728 Global Cls Loss 0.0859 Local Cls Loss 0.0869 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3693 (0.0039)
    Batch Time 18.0059 (0.1916)
    Learning Rate 1e-06
    Accuracy 0.7501 0.7501 0.7501 0.7501 0.7501 0.7501 0.7501
    Precision 0.7729 0.6034 0.3974 0.8653 0.6744 0.6164 0.7074
    Recall 0.7538 0.5147 0.3797 0.8830 0.6532 0.6125 0.7244
    F1 0.7632 0.5556 0.3883 0.8740 0.6636 0.6144 0.7158
Acc_avg 0.7501 Prec_avg 0.6624 Recall_avg 0.6459 F1_avg 0.6536
    Total Loss 1.8661 Global Cls Loss 0.9379 Local Cls Loss 0.9282 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0189 (0.0038)
    Batch Time 0.7881 (0.1576)
    Learning Rate 1e-06
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.0000 0.0000 0.0000 0.2535 0.0000 0.2000 0.1875
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0667 0.2727
    F1 0.0000 0.0000 0.0000 0.3789 0.0000 0.1000 0.2222
Acc_avg 0.2171 Prec_avg 0.0916 Recall_avg 0.1556 F1_avg 0.1002
    Total Loss 6.5305 Global Cls Loss 3.2983 Local Cls Loss 3.2322 AFN Loss 0.0000

    [Train]: 
    Epoch 58
    Data Time 2.1503 (0.0057)
    Batch Time 121.8604 (0.3258)
    Learning Rate 1e-06
    Accuracy 0.9723 0.9723 0.9723 0.9723 0.9723 0.9723 0.9723
    Precision 0.9800 0.9511 0.9638 0.9822 0.9619 0.9804 0.9601
    Recall 0.9714 0.9656 0.9327 0.9877 0.9644 0.9516 0.9675
    F1 0.9757 0.9583 0.9480 0.9849 0.9631 0.9658 0.9638
    Acc_avg 0.9723 Prec_avg 0.9685 Recall_avg 0.9630 F1_avg 0.9657
    Total Loss 0.1745 Global Cls Loss 0.0868 Local Cls Loss 0.0877 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3668 (0.0039)
    Batch Time 21.0727 (0.2242)
    Learning Rate 1e-06
    Accuracy 0.7511 0.7511 0.7511 0.7511 0.7511 0.7511 0.7511
    Precision 0.7993 0.6481 0.3958 0.8808 0.6541 0.6226 0.6941
    Recall 0.7477 0.5147 0.3608 0.8642 0.6980 0.6188 0.7380
    F1 0.7727 0.5738 0.3775 0.8724 0.6753 0.6207 0.7153
Acc_avg 0.7511 Prec_avg 0.6707 Recall_avg 0.6489 F1_avg 0.6582
    Total Loss 1.8863 Global Cls Loss 0.9482 Local Cls Loss 0.9382 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0183 (0.0037)
    Batch Time 0.9333 (0.1867)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2647 0.0000 0.2500 0.1961
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0667 0.3030
    F1 0.0000 0.0000 0.0000 0.3913 0.0000 0.1053 0.2381
Acc_avg 0.2248 Prec_avg 0.1015 Recall_avg 0.1600 F1_avg 0.1050
    Total Loss 6.2441 Global Cls Loss 3.1517 Local Cls Loss 3.0925 AFN Loss 0.0000

    [Train]: 
    Epoch 59
    Data Time 2.1338 (0.0057)
    Batch Time 122.4444 (0.3274)
    Learning Rate 1e-06
    Accuracy 0.9718 0.9718 0.9718 0.9718 0.9718 0.9718 0.9718
    Precision 0.9623 0.9464 0.9542 0.9830 0.9701 0.9763 0.9631
    Recall 0.9730 0.9427 0.9355 0.9862 0.9650 0.9663 0.9643
    F1 0.9676 0.9446 0.9448 0.9846 0.9675 0.9713 0.9637
    Acc_avg 0.9718 Prec_avg 0.9651 Recall_avg 0.9618 F1_avg 0.9634
    Total Loss 0.1722 Global Cls Loss 0.0858 Local Cls Loss 0.0864 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3642 (0.0039)
    Batch Time 18.9079 (0.2011)
    Learning Rate 1e-06
    Accuracy 0.7568 0.7568 0.7568 0.7568 0.7568 0.7568 0.7568
    Precision 0.8113 0.6939 0.4106 0.8595 0.6814 0.6767 0.6962
    Recall 0.7538 0.5000 0.3924 0.8933 0.6555 0.5625 0.7455
    F1 0.7815 0.5812 0.4013 0.8760 0.6682 0.6143 0.7200
Acc_avg 0.7568 Prec_avg 0.6899 Recall_avg 0.6433 F1_avg 0.6632
    Total Loss 1.8777 Global Cls Loss 0.9438 Local Cls Loss 0.9339 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0181 (0.0036)
    Batch Time 0.7927 (0.1585)
    Learning Rate 1e-06
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.0000 0.0000 0.0000 0.2571 0.0000 0.0000 0.1961
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.3030
    F1 0.0000 0.0000 0.0000 0.3830 0.0000 0.0000 0.2381
Acc_avg 0.2171 Prec_avg 0.0647 Recall_avg 0.1504 F1_avg 0.0887
    Total Loss 6.6157 Global Cls Loss 3.3436 Local Cls Loss 3.2721 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 79.101150s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.374594s

    [Train]: 
    Epoch 60
    Data Time 2.1047 (0.0056)
    Batch Time 122.6409 (0.3279)
    Learning Rate 1e-06
    Accuracy 0.9709 0.9709 0.9709 0.9709 0.9709 0.9709 0.9709
    Precision 0.9798 0.9462 0.9448 0.9834 0.9635 0.9792 0.9564
    Recall 0.9611 0.9389 0.9369 0.9836 0.9655 0.9648 0.9708
    F1 0.9703 0.9425 0.9408 0.9835 0.9645 0.9719 0.9636
    Acc_avg 0.9709 Prec_avg 0.9647 Recall_avg 0.9602 F1_avg 0.9625
    Total Loss 0.1795 Global Cls Loss 0.0898 Local Cls Loss 0.0897 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3669 (0.0039)
    Batch Time 17.8495 (0.1899)
    Learning Rate 1e-06
    Accuracy 0.7531 0.7531 0.7531 0.7531 0.7531 0.7531 0.7531
    Precision 0.7896 0.6182 0.4067 0.8570 0.6704 0.6549 0.7106
    Recall 0.7508 0.5000 0.3861 0.8958 0.6689 0.5813 0.7139
    F1 0.7697 0.5528 0.3961 0.8760 0.6697 0.6159 0.7122
Acc_avg 0.7531 Prec_avg 0.6725 Recall_avg 0.6424 F1_avg 0.6561
    Total Loss 1.8673 Global Cls Loss 0.9390 Local Cls Loss 0.9283 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0183 (0.0037)
    Batch Time 0.8150 (0.1630)
    Learning Rate 1e-06
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 1.0000 0.0000 0.0000 0.2535 0.0000 0.0000 0.1957
    Recall 0.1429 0.0000 0.0000 0.7500 0.0000 0.0000 0.2727
    F1 0.2500 0.0000 0.0000 0.3789 0.0000 0.0000 0.2278
Acc_avg 0.2326 Prec_avg 0.2070 Recall_avg 0.1665 F1_avg 0.1224
    Total Loss 6.3537 Global Cls Loss 3.2023 Local Cls Loss 3.1514 AFN Loss 0.0000
