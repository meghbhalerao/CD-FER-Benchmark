log : ResNet50_CropNet_GCNwithIntraMatrixAndInterMatrix_useCluster_withoutAFN_trainOnSourceDomain_RAFtoAFED out-pth . net: ResNet50 pretrained None dev 1
Use 112 * 112 Image source RAF target CK+ train bs 32 test bs 32
Ep: 60 LR 0.000100 mu: 0.900000 WD: 0.000100
Use AFN Loss: SAFN
Delta Radius of SAFN Loss: 0.001000
Weight L2 nrom of AFN Loss: 0.050000
================================================
Num cls : 7
Use global feature and local feature.
Use Intra GCN.
Use Inter GCN.
Use Mean in Cluster.
================================================
Building Train and Test Dataloader...
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
 test source dataset qty: 2993
 test source dataset dist: 325, 68, 158, 1171, 447, 160, 664
 test target dataset qty: 129
 test target dataset dist: 21, 9, 15, 24, 12, 15, 33
Done!
================================================
Building Model...
No Resume Model
Done!
================================================
Initialize Mean in Cluster....
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 79.151628s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
2021-04-28 16:39:16.156467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
[Target Domain] Cost time : 13.807634s
Done!
================================================
Building Optimizer...
Done!
================================================
Run Experiment...

    [Train]: 
    Epoch 1
    Data Time 2.9022 (0.0078)
    Batch Time 130.5720 (0.3491)
    Learning Rate 0.0001
    Accuracy 0.4375 0.4375 0.4375 0.4375 0.4375 0.4375 0.4375
    Precision 0.2483 0.0000 0.1250 0.4891 0.2978 0.2013 0.3575
    Recall 0.0564 0.0000 0.0014 0.8458 0.1438 0.0455 0.3586
    F1 0.0919 0.0000 0.0028 0.6198 0.1939 0.0742 0.3580
    Acc_avg 0.4375 Prec_avg 0.2456 Recall_avg 0.2074 F1_avg 0.1915
    Total Loss 2.9983 Global Cls Loss 1.5016 Local Cls Loss 1.4968 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.4226 (0.0045)
    Batch Time 18.6161 (0.1980)
    Learning Rate 0.0001
    Accuracy 0.5125 0.5125 0.5125 0.5125 0.5125 0.5125 0.5125
    Precision 0.4767 0.0000 0.0000 0.5565 0.3318 0.3934 0.4637
    Recall 0.2831 0.0000 0.0000 0.9044 0.1611 0.1500 0.4322
    F1 0.3552 0.0000 0.0000 0.6890 0.2169 0.2172 0.4474
Acc_avg 0.5125 Prec_avg 0.3174 Recall_avg 0.2758 F1_avg 0.2751
    Total Loss 2.5995 Global Cls Loss 1.3002 Local Cls Loss 1.2992 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.2758.

    Test Target: 
    Data Time 0.0221 (0.0044)
    Batch Time 0.8847 (0.1769)
    Learning Rate 0.0001
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.1875 0.0000 0.0000 0.1963 0.0000 0.0000 0.5000
    Recall 0.1429 0.0000 0.0000 0.8750 0.0000 0.0000 0.0909
    F1 0.1622 0.0000 0.0000 0.3206 0.0000 0.0000 0.1538
Acc_avg 0.2093 Prec_avg 0.1263 Recall_avg 0.1584 F1_avg 0.0909
    Total Loss 3.7891 Global Cls Loss 1.9067 Local Cls Loss 1.8824 AFN Loss 0.0000

    [Train]: 
    Epoch 2
    Data Time 2.3345 (0.0062)
    Batch Time 127.7199 (0.3415)
    Learning Rate 0.0001
    Accuracy 0.5594 0.5594 0.5594 0.5594 0.5594 0.5594 0.5594
    Precision 0.5184 0.5714 0.3750 0.6456 0.4265 0.4455 0.4808
    Recall 0.4361 0.0153 0.0042 0.8322 0.3466 0.2698 0.5631
    F1 0.4737 0.0297 0.0083 0.7271 0.3824 0.3361 0.5187
    Acc_avg 0.5594 Prec_avg 0.4947 Recall_avg 0.3525 F1_avg 0.3537
    Total Loss 2.4312 Global Cls Loss 1.2182 Local Cls Loss 1.2129 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4423 (0.0047)
    Batch Time 18.4551 (0.1963)
    Learning Rate 0.0001
    Accuracy 0.6151 0.6151 0.6151 0.6151 0.6151 0.6151 0.6151
    Precision 0.5850 0.9167 0.7500 0.7107 0.4648 0.5600 0.5360
    Recall 0.6246 0.1618 0.0190 0.8309 0.3982 0.3500 0.6280
    F1 0.6042 0.2750 0.0370 0.7661 0.4289 0.4308 0.5784
Acc_avg 0.6151 Prec_avg 0.6462 Recall_avg 0.4304 F1_avg 0.4458
    Total Loss 2.1762 Global Cls Loss 1.0887 Local Cls Loss 1.0875 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.4304.

    Test Target: 
    Data Time 0.0198 (0.0040)
    Batch Time 0.8172 (0.1634)
    Learning Rate 0.0001
    Accuracy 0.1783 0.1783 0.1783 0.1783 0.1783 0.1783 0.1783
    Precision 0.2500 0.0000 0.0000 0.1532 0.0000 0.0000 1.0000
    Recall 0.1905 0.0000 0.0000 0.7083 0.0000 0.0000 0.0606
    F1 0.2162 0.0000 0.0000 0.2519 0.0000 0.0000 0.1143
Acc_avg 0.1783 Prec_avg 0.2005 Recall_avg 0.1371 F1_avg 0.0832
    Total Loss 3.9139 Global Cls Loss 1.9984 Local Cls Loss 1.9155 AFN Loss 0.0000

    [Train]: 
    Epoch 3
    Data Time 2.5409 (0.0068)
    Batch Time 124.1338 (0.3319)
    Learning Rate 0.0001
    Accuracy 0.6186 0.6186 0.6186 0.6186 0.6186 0.6186 0.6186
    Precision 0.5916 0.6250 0.4237 0.7156 0.4994 0.5201 0.5357
    Recall 0.5465 0.1145 0.0701 0.8491 0.4413 0.3988 0.6238
    F1 0.5681 0.1935 0.1203 0.7766 0.4686 0.4515 0.5764
    Acc_avg 0.6186 Prec_avg 0.5587 Recall_avg 0.4349 F1_avg 0.4507
    Total Loss 2.1354 Global Cls Loss 1.0693 Local Cls Loss 1.0661 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3892 (0.0041)
    Batch Time 17.7833 (0.1892)
    Learning Rate 0.0001
    Accuracy 0.6331 0.6331 0.6331 0.6331 0.6331 0.6331 0.6331
    Precision 0.7154 0.6452 0.4043 0.6660 0.5220 0.5683 0.5971
    Recall 0.5877 0.2941 0.1203 0.9078 0.3445 0.4938 0.5557
    F1 0.6453 0.4040 0.1854 0.7683 0.4151 0.5284 0.5757
Acc_avg 0.6331 Prec_avg 0.5883 Recall_avg 0.4720 F1_avg 0.5032
    Total Loss 2.0518 Global Cls Loss 1.0250 Local Cls Loss 1.0268 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.4720.

    Test Target: 
    Data Time 0.0188 (0.0038)
    Batch Time 0.8113 (0.1623)
    Learning Rate 0.0001
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.1429 0.1429 0.0000 0.2055 0.0000 0.0000 0.4000
    Recall 0.2857 0.1111 0.0000 0.6250 0.0000 0.0000 0.0606
    F1 0.1905 0.1250 0.0000 0.3093 0.0000 0.0000 0.1053
Acc_avg 0.1860 Prec_avg 0.1273 Recall_avg 0.1546 F1_avg 0.1043
    Total Loss 3.9342 Global Cls Loss 1.9670 Local Cls Loss 1.9672 AFN Loss 0.0000

    [Train]: 
    Epoch 4
    Data Time 2.3878 (0.0064)
    Batch Time 122.9221 (0.3287)
    Learning Rate 0.0001
    Accuracy 0.6429 0.6429 0.6429 0.6429 0.6429 0.6429 0.6429
    Precision 0.6171 0.5802 0.3879 0.7489 0.5368 0.5702 0.5501
    Recall 0.6073 0.1794 0.1164 0.8571 0.4753 0.4765 0.6278
    F1 0.6122 0.2741 0.1791 0.7994 0.5042 0.5192 0.5864
    Acc_avg 0.6429 Prec_avg 0.5702 Recall_avg 0.4771 F1_avg 0.4964
    Total Loss 1.9644 Global Cls Loss 0.9830 Local Cls Loss 0.9814 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4719 (0.0050)
    Batch Time 18.5610 (0.1975)
    Learning Rate 0.0001
    Accuracy 0.6539 0.6539 0.6539 0.6539 0.6539 0.6539 0.6539
    Precision 0.6667 0.6286 0.3333 0.7608 0.5175 0.5479 0.5728
    Recall 0.6708 0.3235 0.0759 0.8446 0.4631 0.5000 0.6461
    F1 0.6687 0.4272 0.1237 0.8005 0.4888 0.5229 0.6072
Acc_avg 0.6539 Prec_avg 0.5754 Recall_avg 0.5034 F1_avg 0.5199
    Total Loss 1.9210 Global Cls Loss 0.9618 Local Cls Loss 0.9592 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5034.

    Test Target: 
    Data Time 0.0196 (0.0039)
    Batch Time 0.8390 (0.1678)
    Learning Rate 0.0001
    Accuracy 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938
    Precision 0.0000 0.0000 0.0000 0.2255 0.0000 0.0000 0.1333
    Recall 0.0000 0.0000 0.0000 0.9583 0.0000 0.0000 0.0606
    F1 0.0000 0.0000 0.0000 0.3651 0.0000 0.0000 0.0833
Acc_avg 0.1938 Prec_avg 0.0513 Recall_avg 0.1456 F1_avg 0.0641
    Total Loss 4.0490 Global Cls Loss 2.0544 Local Cls Loss 1.9946 AFN Loss 0.0000

    [Train]: 
    Epoch 5
    Data Time 2.3133 (0.0062)
    Batch Time 122.6232 (0.3279)
    Learning Rate 0.0001
    Accuracy 0.6740 0.6740 0.6740 0.6740 0.6740 0.6740 0.6740
    Precision 0.6653 0.5872 0.4294 0.7718 0.5839 0.6003 0.5959
    Recall 0.6415 0.2443 0.2048 0.8642 0.5281 0.5220 0.6629
    F1 0.6532 0.3450 0.2773 0.8154 0.5546 0.5584 0.6276
    Acc_avg 0.6740 Prec_avg 0.6048 Recall_avg 0.5240 F1_avg 0.5474
    Total Loss 1.8046 Global Cls Loss 0.9039 Local Cls Loss 0.9007 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3954 (0.0042)
    Batch Time 17.9585 (0.1910)
    Learning Rate 0.0001
    Accuracy 0.6702 0.6702 0.6702 0.6702 0.6702 0.6702 0.6702
    Precision 0.7531 0.7407 0.3143 0.8043 0.5172 0.4975 0.6231
    Recall 0.5631 0.2941 0.2785 0.8352 0.5034 0.6125 0.6898
    F1 0.6444 0.4211 0.2953 0.8194 0.5102 0.5490 0.6548
Acc_avg 0.6702 Prec_avg 0.6072 Recall_avg 0.5395 F1_avg 0.5563
    Total Loss 1.8255 Global Cls Loss 0.9138 Local Cls Loss 0.9117 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5395.

    Test Target: 
    Data Time 0.0216 (0.0043)
    Batch Time 0.8217 (0.1643)
    Learning Rate 0.0001
    Accuracy 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403
    Precision 0.0000 0.0000 0.0000 0.2222 0.0000 0.0000 0.3500
    Recall 0.0000 0.0000 0.0000 1.0000 0.0000 0.0000 0.2121
    F1 0.0000 0.0000 0.0000 0.3636 0.0000 0.0000 0.2642
Acc_avg 0.2403 Prec_avg 0.0817 Recall_avg 0.1732 F1_avg 0.0897
    Total Loss 4.0165 Global Cls Loss 2.0189 Local Cls Loss 1.9977 AFN Loss 0.0000

    [Train]: 
    Epoch 6
    Data Time 2.4143 (0.0065)
    Batch Time 122.3341 (0.3271)
    Learning Rate 0.0001
    Accuracy 0.6966 0.6966 0.6966 0.6966 0.6966 0.6966 0.6966
    Precision 0.7246 0.6552 0.5000 0.7920 0.6057 0.6252 0.6072
    Recall 0.6860 0.2901 0.2623 0.8714 0.5533 0.5528 0.6868
    F1 0.7048 0.4021 0.3441 0.8298 0.5783 0.5868 0.6446
    Acc_avg 0.6966 Prec_avg 0.6443 Recall_avg 0.5575 F1_avg 0.5843
    Total Loss 1.6955 Global Cls Loss 0.8479 Local Cls Loss 0.8476 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.6522 (0.0069)
    Batch Time 18.1051 (0.1926)
    Learning Rate 0.0001
    Accuracy 0.6726 0.6726 0.6726 0.6726 0.6726 0.6726 0.6726
    Precision 0.8578 0.5500 0.3656 0.8070 0.4587 0.5800 0.6256
    Recall 0.5938 0.3235 0.2152 0.8642 0.6465 0.5437 0.5663
    F1 0.7018 0.4074 0.2709 0.8346 0.5367 0.5613 0.5945
Acc_avg 0.6726 Prec_avg 0.6064 Recall_avg 0.5362 F1_avg 0.5582
    Total Loss 1.8314 Global Cls Loss 0.9156 Local Cls Loss 0.9159 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0211 (0.0042)
    Batch Time 0.7840 (0.1568)
    Learning Rate 0.0001
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0000 0.0000 0.0000 0.1967 0.0000 0.0000 0.0000
    Recall 0.0000 0.0000 0.0000 1.0000 0.0000 0.0000 0.0000
    F1 0.0000 0.0000 0.0000 0.3288 0.0000 0.0000 0.0000
Acc_avg 0.1860 Prec_avg 0.0281 Recall_avg 0.1429 F1_avg 0.0470
    Total Loss 4.0292 Global Cls Loss 1.9991 Local Cls Loss 2.0300 AFN Loss 0.0000

    [Train]: 
    Epoch 7
    Data Time 2.2599 (0.0060)
    Batch Time 125.2681 (0.3349)
    Learning Rate 0.0001
    Accuracy 0.7114 0.7114 0.7114 0.7114 0.7114 0.7114 0.7114
    Precision 0.7064 0.5806 0.5165 0.8086 0.6379 0.6546 0.6278
    Recall 0.6823 0.2748 0.2861 0.8756 0.5929 0.5836 0.7083
    F1 0.6941 0.3731 0.3682 0.8408 0.6146 0.6171 0.6657
    Acc_avg 0.7114 Prec_avg 0.6475 Recall_avg 0.5719 F1_avg 0.5962
    Total Loss 1.6188 Global Cls Loss 0.8107 Local Cls Loss 0.8081 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4060 (0.0043)
    Batch Time 18.1746 (0.1933)
    Learning Rate 0.0001
    Accuracy 0.6752 0.6752 0.6752 0.6752 0.6752 0.6752 0.6752
    Precision 0.7799 0.6000 0.3176 0.7850 0.4933 0.6207 0.6630
    Recall 0.6431 0.2647 0.3418 0.8822 0.5749 0.5625 0.5422
    F1 0.7049 0.3673 0.3293 0.8307 0.5310 0.5902 0.5965
Acc_avg 0.6752 Prec_avg 0.6085 Recall_avg 0.5445 F1_avg 0.5643
    Total Loss 1.7814 Global Cls Loss 0.8910 Local Cls Loss 0.8904 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5445.

    Test Target: 
    Data Time 0.0227 (0.0045)
    Batch Time 0.8406 (0.1681)
    Learning Rate 0.0001
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 1.0000 0.2000 0.0000 0.2000 0.0000 0.0000 0.5000
    Recall 0.0952 0.2222 0.0000 0.8750 0.0000 0.0000 0.0909
    F1 0.1739 0.2105 0.0000 0.3256 0.0000 0.0000 0.1538
Acc_avg 0.2171 Prec_avg 0.2714 Recall_avg 0.1833 F1_avg 0.1234
    Total Loss 4.5564 Global Cls Loss 2.2852 Local Cls Loss 2.2712 AFN Loss 0.0000

    [Train]: 
    Epoch 8
    Data Time 2.2931 (0.0061)
    Batch Time 125.4743 (0.3355)
    Learning Rate 0.0001
    Accuracy 0.7318 0.7318 0.7318 0.7318 0.7318 0.7318 0.7318
    Precision 0.7113 0.6197 0.5831 0.8295 0.6527 0.6782 0.6511
    Recall 0.7006 0.3359 0.3198 0.8916 0.6111 0.6314 0.7240
    F1 0.7059 0.4356 0.4130 0.8594 0.6312 0.6540 0.6856
    Acc_avg 0.7318 Prec_avg 0.6751 Recall_avg 0.6021 F1_avg 0.6264
    Total Loss 1.5150 Global Cls Loss 0.7580 Local Cls Loss 0.7570 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4531 (0.0048)
    Batch Time 18.3355 (0.1951)
    Learning Rate 0.0001
    Accuracy 0.7063 0.7063 0.7063 0.7063 0.7063 0.7063 0.7063
    Precision 0.7791 0.8214 0.3900 0.8022 0.6384 0.6918 0.5995
    Recall 0.6185 0.3382 0.2468 0.8864 0.4541 0.6312 0.7666
    F1 0.6895 0.4792 0.3023 0.8422 0.5307 0.6601 0.6728
Acc_avg 0.7063 Prec_avg 0.6746 Recall_avg 0.5631 F1_avg 0.5967
    Total Loss 1.6752 Global Cls Loss 0.8380 Local Cls Loss 0.8372 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5631.

    Test Target: 
    Data Time 0.0202 (0.0040)
    Batch Time 0.8121 (0.1624)
    Learning Rate 0.0001
    Accuracy 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938
    Precision 0.0000 0.1304 0.0000 0.2062 0.6667 0.0000 0.0000
    Recall 0.0000 0.3333 0.0000 0.8333 0.1667 0.0000 0.0000
    F1 0.0000 0.1875 0.0000 0.3306 0.2667 0.0000 0.0000
Acc_avg 0.1938 Prec_avg 0.1433 Recall_avg 0.1905 F1_avg 0.1121
    Total Loss 4.8031 Global Cls Loss 2.4269 Local Cls Loss 2.3762 AFN Loss 0.0000

    [Train]: 
    Epoch 9
    Data Time 2.1695 (0.0058)
    Batch Time 123.6114 (0.3305)
    Learning Rate 0.0001
    Accuracy 0.7329 0.7329 0.7329 0.7329 0.7329 0.7329 0.7329
    Precision 0.7350 0.7143 0.5457 0.8278 0.6548 0.6891 0.6464
    Recall 0.7186 0.3257 0.3268 0.8910 0.6170 0.6466 0.7114
    F1 0.7267 0.4474 0.4088 0.8582 0.6353 0.6672 0.6774
    Acc_avg 0.7329 Prec_avg 0.6876 Recall_avg 0.6053 F1_avg 0.6316
    Total Loss 1.4723 Global Cls Loss 0.7371 Local Cls Loss 0.7352 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4296 (0.0046)
    Batch Time 18.2376 (0.1940)
    Learning Rate 0.0001
    Accuracy 0.6993 0.6993 0.6993 0.6993 0.6993 0.6993 0.6993
    Precision 0.7954 0.5000 0.4255 0.7896 0.6224 0.6911 0.5977
    Recall 0.6338 0.4706 0.2532 0.8975 0.4720 0.5312 0.7048
    F1 0.7055 0.4848 0.3175 0.8401 0.5369 0.6007 0.6469
Acc_avg 0.6993 Prec_avg 0.6317 Recall_avg 0.5662 F1_avg 0.5903
    Total Loss 1.7057 Global Cls Loss 0.8521 Local Cls Loss 0.8536 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5662.

    Test Target: 
    Data Time 0.0224 (0.0045)
    Batch Time 0.8616 (0.1723)
    Learning Rate 0.0001
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 0.2500 0.2727 0.0000 0.2381 0.0000 0.0000 0.3182
    Recall 0.1429 0.3333 0.0000 0.8333 0.0000 0.0000 0.2121
    F1 0.1818 0.3000 0.0000 0.3704 0.0000 0.0000 0.2545
Acc_avg 0.2558 Prec_avg 0.1541 Recall_avg 0.2174 F1_avg 0.1581
    Total Loss 4.2773 Global Cls Loss 2.1385 Local Cls Loss 2.1388 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 80.106221s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.536029s

    [Train]: 
    Epoch 10
    Data Time 2.4015 (0.0064)
    Batch Time 124.0203 (0.3316)
    Learning Rate 0.0001
    Accuracy 0.7512 0.7512 0.7512 0.7512 0.7512 0.7512 0.7512
    Precision 0.7717 0.6688 0.5526 0.8458 0.6725 0.7209 0.6688
    Recall 0.7331 0.4008 0.3829 0.8946 0.6297 0.6628 0.7479
    F1 0.7519 0.5012 0.4524 0.8695 0.6504 0.6906 0.7062
    Acc_avg 0.7512 Prec_avg 0.7002 Recall_avg 0.6360 F1_avg 0.6603
    Total Loss 1.3765 Global Cls Loss 0.6886 Local Cls Loss 0.6878 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.4309 (0.0046)
    Batch Time 18.8027 (0.2000)
    Learning Rate 0.0001
    Accuracy 0.7070 0.7070 0.7070 0.7070 0.7070 0.7070 0.7070
    Precision 0.7213 0.6512 0.5000 0.8272 0.5517 0.6216 0.6488
    Recall 0.6769 0.4118 0.2152 0.8582 0.6443 0.5750 0.6762
    F1 0.6984 0.5045 0.3009 0.8424 0.5944 0.5974 0.6622
Acc_avg 0.7070 Prec_avg 0.6460 Recall_avg 0.5797 F1_avg 0.6000
    Total Loss 1.6183 Global Cls Loss 0.8088 Local Cls Loss 0.8095 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5797.

    Test Target: 
    Data Time 0.0236 (0.0047)
    Batch Time 0.8131 (0.1626)
    Learning Rate 0.0001
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.1963 0.0000 0.0000 0.2857
    Recall 0.0000 0.0000 0.0000 0.8750 0.0000 0.0000 0.1818
    F1 0.0000 0.0000 0.0000 0.3206 0.0000 0.0000 0.2222
Acc_avg 0.2093 Prec_avg 0.0689 Recall_avg 0.1510 F1_avg 0.0775
    Total Loss 4.7811 Global Cls Loss 2.3899 Local Cls Loss 2.3912 AFN Loss 0.0000

    [Train]: 
    Epoch 11
    Data Time 2.3118 (0.0062)
    Batch Time 123.0932 (0.3291)
    Learning Rate 0.0001
    Accuracy 0.7652 0.7652 0.7652 0.7652 0.7652 0.7652 0.7652
    Precision 0.7697 0.7024 0.6108 0.8505 0.6978 0.7298 0.6900
    Recall 0.7593 0.4504 0.4143 0.9001 0.6504 0.6613 0.7623
    F1 0.7645 0.5488 0.4937 0.8746 0.6733 0.6938 0.7244
    Acc_avg 0.7652 Prec_avg 0.7216 Recall_avg 0.6569 F1_avg 0.6819
    Total Loss 1.3102 Global Cls Loss 0.6561 Local Cls Loss 0.6541 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4334 (0.0046)
    Batch Time 18.1640 (0.1932)
    Learning Rate 0.0001
    Accuracy 0.7040 0.7040 0.7040 0.7040 0.7040 0.7040 0.7040
    Precision 0.7865 0.7826 0.4060 0.7942 0.5527 0.6667 0.6636
    Recall 0.6800 0.2647 0.3418 0.8830 0.5861 0.5625 0.6446
    F1 0.7294 0.3956 0.3711 0.8362 0.5689 0.6102 0.6539
Acc_avg 0.7040 Prec_avg 0.6646 Recall_avg 0.5661 F1_avg 0.5951
    Total Loss 1.6832 Global Cls Loss 0.8404 Local Cls Loss 0.8428 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0221 (0.0044)
    Batch Time 0.7869 (0.1574)
    Learning Rate 0.0001
    Accuracy 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938
    Precision 1.0000 0.0000 0.0000 0.2083 0.0000 0.0000 0.1837
    Recall 0.0476 0.0000 0.0000 0.6250 0.0000 0.0000 0.2727
    F1 0.0909 0.0000 0.0000 0.3125 0.0000 0.0000 0.2195
Acc_avg 0.1938 Prec_avg 0.1989 Recall_avg 0.1350 F1_avg 0.0890
    Total Loss 4.0041 Global Cls Loss 1.9908 Local Cls Loss 2.0134 AFN Loss 0.0000

    [Train]: 
    Epoch 12
    Data Time 2.3736 (0.0063)
    Batch Time 124.6193 (0.3332)
    Learning Rate 0.0001
    Accuracy 0.7817 0.7817 0.7817 0.7817 0.7817 0.7817 0.7817
    Precision 0.7753 0.7134 0.6307 0.8662 0.7290 0.7360 0.7091
    Recall 0.7673 0.4466 0.4670 0.9071 0.6849 0.7155 0.7687
    F1 0.7713 0.5493 0.5367 0.8862 0.7062 0.7257 0.7377
    Acc_avg 0.7817 Prec_avg 0.7371 Recall_avg 0.6796 F1_avg 0.7019
    Total Loss 1.2325 Global Cls Loss 0.6174 Local Cls Loss 0.6151 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.6250 (0.0066)
    Batch Time 18.2894 (0.1946)
    Learning Rate 0.0001
    Accuracy 0.7130 0.7130 0.7130 0.7130 0.7130 0.7130 0.7130
    Precision 0.7214 0.5000 0.3472 0.8433 0.6160 0.6047 0.6336
    Recall 0.7169 0.3824 0.1582 0.8548 0.5526 0.6500 0.7500
    F1 0.7191 0.4333 0.2174 0.8490 0.5825 0.6265 0.6869
Acc_avg 0.7130 Prec_avg 0.6094 Recall_avg 0.5807 F1_avg 0.5878
    Total Loss 1.6259 Global Cls Loss 0.8129 Local Cls Loss 0.8130 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5807.

    Test Target: 
    Data Time 0.0198 (0.0040)
    Batch Time 0.8381 (0.1676)
    Learning Rate 0.0001
    Accuracy 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705
    Precision 0.0000 0.0000 0.0000 0.1782 0.0000 0.0000 0.1739
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.1212
    F1 0.0000 0.0000 0.0000 0.2880 0.0000 0.0000 0.1429
Acc_avg 0.1705 Prec_avg 0.0503 Recall_avg 0.1245 F1_avg 0.0616
    Total Loss 4.4646 Global Cls Loss 2.2223 Local Cls Loss 2.2423 AFN Loss 0.0000

    [Train]: 
    Epoch 13
    Data Time 2.4817 (0.0066)
    Batch Time 132.6136 (0.3546)
    Learning Rate 0.0001
    Accuracy 0.7890 0.7890 0.7890 0.7890 0.7890 0.7890 0.7890
    Precision 0.8072 0.6914 0.6227 0.8722 0.7243 0.7596 0.7198
    Recall 0.7847 0.4618 0.4769 0.9069 0.6981 0.7273 0.7779
    F1 0.7958 0.5538 0.5401 0.8892 0.7110 0.7431 0.7477
    Acc_avg 0.7890 Prec_avg 0.7424 Recall_avg 0.6905 F1_avg 0.7115
    Total Loss 1.1780 Global Cls Loss 0.5895 Local Cls Loss 0.5886 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5475 (0.0058)
    Batch Time 18.7901 (0.1999)
    Learning Rate 0.0001
    Accuracy 0.7123 0.7123 0.7123 0.7123 0.7123 0.7123 0.7123
    Precision 0.7713 0.5185 0.4194 0.7977 0.5577 0.6947 0.7143
    Recall 0.6954 0.4118 0.3291 0.8753 0.6376 0.5687 0.6401
    F1 0.7314 0.4590 0.3688 0.8347 0.5950 0.6254 0.6751
Acc_avg 0.7123 Prec_avg 0.6391 Recall_avg 0.5940 F1_avg 0.6128
    Total Loss 1.6200 Global Cls Loss 0.8099 Local Cls Loss 0.8101 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.5940.

    Test Target: 
    Data Time 0.0209 (0.0042)
    Batch Time 0.8123 (0.1625)
    Learning Rate 0.0001
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.4286 0.0000 0.0000 0.2188 0.0000 0.0000 0.2105
    Recall 0.1429 0.0000 0.0000 0.8750 0.0000 0.0000 0.1212
    F1 0.2143 0.0000 0.0000 0.3500 0.0000 0.0000 0.1538
Acc_avg 0.2171 Prec_avg 0.1225 Recall_avg 0.1627 F1_avg 0.1026
    Total Loss 5.0156 Global Cls Loss 2.5139 Local Cls Loss 2.5017 AFN Loss 0.0000

    [Train]: 
    Epoch 14
    Data Time 2.3189 (0.0062)
    Batch Time 129.9991 (0.3476)
    Learning Rate 0.0001
    Accuracy 0.7987 0.7987 0.7987 0.7987 0.7987 0.7987 0.7987
    Precision 0.8091 0.7189 0.6298 0.8813 0.7528 0.7807 0.7184
    Recall 0.7886 0.5076 0.4558 0.9122 0.7220 0.7463 0.7907
    F1 0.7987 0.5951 0.5289 0.8965 0.7371 0.7631 0.7528
    Acc_avg 0.7987 Prec_avg 0.7559 Recall_avg 0.7033 F1_avg 0.7246
    Total Loss 1.1154 Global Cls Loss 0.5587 Local Cls Loss 0.5567 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5080 (0.0054)
    Batch Time 18.3110 (0.1948)
    Learning Rate 0.0001
    Accuracy 0.7310 0.7310 0.7310 0.7310 0.7310 0.7310 0.7310
    Precision 0.7738 0.6944 0.4167 0.8400 0.6373 0.6163 0.6685
    Recall 0.7262 0.3676 0.3481 0.8745 0.5817 0.6625 0.7259
    F1 0.7492 0.4808 0.3793 0.8569 0.6082 0.6386 0.6960
Acc_avg 0.7310 Prec_avg 0.6639 Recall_avg 0.6123 F1_avg 0.6299
    Total Loss 1.5908 Global Cls Loss 0.7946 Local Cls Loss 0.7962 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6123.

    Test Target: 
    Data Time 0.0207 (0.0041)
    Batch Time 0.8199 (0.1640)
    Learning Rate 0.0001
    Accuracy 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403
    Precision 0.0000 0.0769 0.0000 0.2400 0.3333 0.0000 0.3333
    Recall 0.0000 0.1111 0.0000 0.5000 0.1667 0.0000 0.4848
    F1 0.0000 0.0909 0.0000 0.3243 0.2222 0.0000 0.3951
Acc_avg 0.2403 Prec_avg 0.1405 Recall_avg 0.1804 F1_avg 0.1475
    Total Loss 3.7546 Global Cls Loss 1.8880 Local Cls Loss 1.8666 AFN Loss 0.0000

    [Train]: 
    Epoch 15
    Data Time 2.3975 (0.0064)
    Batch Time 132.4533 (0.3542)
    Learning Rate 0.0001
    Accuracy 0.8046 0.8046 0.8046 0.8046 0.8046 0.8046 0.8046
    Precision 0.8242 0.7592 0.6673 0.8867 0.7415 0.7666 0.7303
    Recall 0.8006 0.5534 0.5175 0.9165 0.7171 0.7273 0.7914
    F1 0.8122 0.6402 0.5829 0.9013 0.7291 0.7464 0.7596
    Acc_avg 0.8046 Prec_avg 0.7680 Recall_avg 0.7177 F1_avg 0.7388
    Total Loss 1.0690 Global Cls Loss 0.5351 Local Cls Loss 0.5339 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4556 (0.0048)
    Batch Time 19.1374 (0.2036)
    Learning Rate 0.0001
    Accuracy 0.7244 0.7244 0.7244 0.7244 0.7244 0.7244 0.7244
    Precision 0.7211 0.5957 0.3580 0.8262 0.7536 0.5963 0.6601
    Recall 0.7477 0.4118 0.3671 0.8847 0.4653 0.6000 0.7515
    F1 0.7341 0.4870 0.3625 0.8544 0.5754 0.5981 0.7028
Acc_avg 0.7244 Prec_avg 0.6444 Recall_avg 0.6040 F1_avg 0.6163
    Total Loss 1.6788 Global Cls Loss 0.8386 Local Cls Loss 0.8402 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0227 (0.0045)
    Batch Time 0.8050 (0.1610)
    Learning Rate 0.0001
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 0.0000 0.0000 0.0000 0.2667 0.0909 0.0000 0.2364
    Recall 0.0000 0.0000 0.0000 0.6667 0.0833 0.0000 0.3939
    F1 0.0000 0.0000 0.0000 0.3810 0.0870 0.0000 0.2955
Acc_avg 0.2326 Prec_avg 0.0848 Recall_avg 0.1634 F1_avg 0.1091
    Total Loss 4.0510 Global Cls Loss 2.0320 Local Cls Loss 2.0190 AFN Loss 0.0000

    [Train]: 
    Epoch 16
    Data Time 2.4884 (0.0067)
    Batch Time 134.9432 (0.3608)
    Learning Rate 0.0001
    Accuracy 0.8179 0.8179 0.8179 0.8179 0.8179 0.8179 0.8179
    Precision 0.8267 0.7251 0.6598 0.8961 0.7706 0.7935 0.7510
    Recall 0.8261 0.5840 0.5386 0.9205 0.7342 0.7551 0.8050
    F1 0.8264 0.6469 0.5931 0.9082 0.7520 0.7739 0.7771
    Acc_avg 0.8179 Prec_avg 0.7747 Recall_avg 0.7376 F1_avg 0.7539
    Total Loss 1.0299 Global Cls Loss 0.5151 Local Cls Loss 0.5148 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4979 (0.0053)
    Batch Time 19.3165 (0.2055)
    Learning Rate 0.0001
    Accuracy 0.7070 0.7070 0.7070 0.7070 0.7070 0.7070 0.7070
    Precision 0.7870 0.4697 0.5093 0.7950 0.5760 0.6721 0.6461
    Recall 0.6708 0.4559 0.3481 0.8975 0.5593 0.5125 0.6461
    F1 0.7243 0.4627 0.4135 0.8432 0.5675 0.5816 0.6461
Acc_avg 0.7070 Prec_avg 0.6365 Recall_avg 0.5843 F1_avg 0.6055
    Total Loss 1.7305 Global Cls Loss 0.8653 Local Cls Loss 0.8652 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0211 (0.0042)
    Batch Time 0.8665 (0.1733)
    Learning Rate 0.0001
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0000 0.0000 0.0000 0.1954 0.3333 0.0000 0.1852
    Recall 0.0000 0.0000 0.0000 0.7083 0.1667 0.0000 0.1515
    F1 0.0000 0.0000 0.0000 0.3063 0.2222 0.0000 0.1667
Acc_avg 0.1860 Prec_avg 0.1020 Recall_avg 0.1466 F1_avg 0.0993
    Total Loss 4.2445 Global Cls Loss 2.1334 Local Cls Loss 2.1111 AFN Loss 0.0000

    [Train]: 
    Epoch 17
    Data Time 2.4156 (0.0065)
    Batch Time 136.2250 (0.3642)
    Learning Rate 0.0001
    Accuracy 0.8224 0.8224 0.8224 0.8224 0.8224 0.8224 0.8224
    Precision 0.8212 0.7109 0.6814 0.8956 0.7659 0.8250 0.7665
    Recall 0.8068 0.5725 0.5618 0.9231 0.7496 0.7742 0.8088
    F1 0.8140 0.6342 0.6159 0.9091 0.7576 0.7988 0.7871
    Acc_avg 0.8224 Prec_avg 0.7809 Recall_avg 0.7424 F1_avg 0.7595
    Total Loss 0.9754 Global Cls Loss 0.4873 Local Cls Loss 0.4882 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4511 (0.0048)
    Batch Time 19.2467 (0.2048)
    Learning Rate 0.0001
    Accuracy 0.7317 0.7317 0.7317 0.7317 0.7317 0.7317 0.7317
    Precision 0.7470 0.5893 0.4505 0.8434 0.6362 0.6250 0.6695
    Recall 0.7538 0.4853 0.3165 0.8736 0.6063 0.6250 0.7048
    F1 0.7504 0.5323 0.3717 0.8582 0.6208 0.6250 0.6867
Acc_avg 0.7317 Prec_avg 0.6515 Recall_avg 0.6236 F1_avg 0.6350
    Total Loss 1.5849 Global Cls Loss 0.7937 Local Cls Loss 0.7912 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6236.

    Test Target: 
    Data Time 0.0228 (0.0046)
    Batch Time 0.9239 (0.1848)
    Learning Rate 0.0001
    Accuracy 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403
    Precision 0.3636 0.0000 0.0000 0.2500 0.0000 0.0000 0.2903
    Recall 0.1905 0.0000 0.0000 0.3750 0.0000 0.0000 0.5455
    F1 0.2500 0.0000 0.0000 0.3000 0.0000 0.0000 0.3789
Acc_avg 0.2403 Prec_avg 0.1291 Recall_avg 0.1587 F1_avg 0.1327
    Total Loss 3.9133 Global Cls Loss 1.9613 Local Cls Loss 1.9521 AFN Loss 0.0000

    [Train]: 
    Epoch 18
    Data Time 2.5695 (0.0069)
    Batch Time 134.3652 (0.3593)
    Learning Rate 0.0001
    Accuracy 0.8331 0.8331 0.8331 0.8331 0.8331 0.8331 0.8331
    Precision 0.8459 0.7548 0.7219 0.8984 0.7865 0.8077 0.7764
    Recall 0.8284 0.5992 0.5871 0.9228 0.7723 0.8006 0.8157
    F1 0.8371 0.6681 0.6476 0.9105 0.7793 0.8041 0.7956
    Acc_avg 0.8331 Prec_avg 0.7988 Recall_avg 0.7609 F1_avg 0.7775
    Total Loss 0.9260 Global Cls Loss 0.4635 Local Cls Loss 0.4625 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4660 (0.0050)
    Batch Time 19.1690 (0.2039)
    Learning Rate 0.0001
    Accuracy 0.7247 0.7247 0.7247 0.7247 0.7247 0.7247 0.7247
    Precision 0.7441 0.5217 0.3889 0.8174 0.6657 0.5839 0.6814
    Recall 0.7785 0.3529 0.3101 0.8907 0.5078 0.5875 0.7214
    F1 0.7609 0.4211 0.3451 0.8525 0.5761 0.5857 0.7008
Acc_avg 0.7247 Prec_avg 0.6290 Recall_avg 0.5927 F1_avg 0.6060
    Total Loss 1.7095 Global Cls Loss 0.8545 Local Cls Loss 0.8550 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0206 (0.0041)
    Batch Time 0.7971 (0.1594)
    Learning Rate 0.0001
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2500 0.0000 0.0000 0.2895
    Recall 0.0000 0.0000 0.0000 0.7500 0.0000 0.0000 0.3333
    F1 0.0000 0.0000 0.0000 0.3750 0.0000 0.0000 0.3099
Acc_avg 0.2248 Prec_avg 0.0771 Recall_avg 0.1548 F1_avg 0.0978
    Total Loss 3.9945 Global Cls Loss 1.9950 Local Cls Loss 1.9995 AFN Loss 0.0000

    [Train]: 
    Epoch 19
    Data Time 2.3529 (0.0063)
    Batch Time 134.6010 (0.3599)
    Learning Rate 0.0001
    Accuracy 0.8402 0.8402 0.8402 0.8402 0.8402 0.8402 0.8402
    Precision 0.8422 0.7466 0.7061 0.9097 0.8010 0.8234 0.7838
    Recall 0.8308 0.6298 0.6376 0.9254 0.7814 0.7944 0.8207
    F1 0.8365 0.6832 0.6701 0.9175 0.7911 0.8087 0.8018
    Acc_avg 0.8402 Prec_avg 0.8018 Recall_avg 0.7743 F1_avg 0.7870
    Total Loss 0.8772 Global Cls Loss 0.4387 Local Cls Loss 0.4385 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.6314 (0.0067)
    Batch Time 18.7043 (0.1990)
    Learning Rate 0.0001
    Accuracy 0.7267 0.7267 0.7267 0.7267 0.7267 0.7267 0.7267
    Precision 0.7356 0.7500 0.3503 0.8461 0.6485 0.5663 0.6936
    Recall 0.7877 0.3971 0.3924 0.8685 0.6107 0.5875 0.6717
    F1 0.7608 0.5192 0.3701 0.8571 0.6290 0.5767 0.6825
Acc_avg 0.7267 Prec_avg 0.6558 Recall_avg 0.6165 F1_avg 0.6279
    Total Loss 1.6883 Global Cls Loss 0.8441 Local Cls Loss 0.8442 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0223 (0.0045)
    Batch Time 0.8837 (0.1767)
    Learning Rate 0.0001
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.3750 0.0000 0.0000 0.2182 0.0000 0.0000 0.1837
    Recall 0.1429 0.0000 0.0000 0.5000 0.0000 0.0000 0.2727
    F1 0.2069 0.0000 0.0000 0.3038 0.0000 0.0000 0.2195
Acc_avg 0.1860 Prec_avg 0.1110 Recall_avg 0.1308 F1_avg 0.1043
    Total Loss 4.5674 Global Cls Loss 2.2889 Local Cls Loss 2.2785 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 81.213124s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.693754s

    [Train]: 
    Epoch 20
    Data Time 2.2181 (0.0059)
    Batch Time 123.3729 (0.3299)
    Learning Rate 0.0001
    Accuracy 0.8546 0.8546 0.8546 0.8546 0.8546 0.8546 0.8546
    Precision 0.8669 0.7873 0.7404 0.9178 0.8153 0.8463 0.7952
    Recall 0.8745 0.6641 0.6480 0.9326 0.7867 0.8152 0.8385
    F1 0.8707 0.7205 0.6911 0.9251 0.8008 0.8305 0.8163
    Acc_avg 0.8546 Prec_avg 0.8242 Recall_avg 0.7942 F1_avg 0.8078
    Total Loss 0.8229 Global Cls Loss 0.4122 Local Cls Loss 0.4106 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.4863 (0.0052)
    Batch Time 18.2353 (0.1940)
    Learning Rate 0.0001
    Accuracy 0.7250 0.7250 0.7250 0.7250 0.7250 0.7250 0.7250
    Precision 0.7478 0.6500 0.4286 0.8215 0.6648 0.5381 0.6821
    Recall 0.7754 0.3824 0.3418 0.8762 0.5280 0.6625 0.7078
    F1 0.7613 0.4815 0.3803 0.8479 0.5885 0.5938 0.6948
Acc_avg 0.7250 Prec_avg 0.6475 Recall_avg 0.6106 F1_avg 0.6212
    Total Loss 1.6984 Global Cls Loss 0.8497 Local Cls Loss 0.8487 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0230 (0.0046)
    Batch Time 0.7995 (0.1599)
    Learning Rate 0.0001
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0000 0.0000 0.0000 0.8571 0.1154 0.0000 0.3409
    Recall 0.0000 0.0000 0.0000 0.2500 0.2500 0.0000 0.4545
    F1 0.0000 0.0000 0.0000 0.3871 0.1579 0.0000 0.3896
Acc_avg 0.1860 Prec_avg 0.1876 Recall_avg 0.1364 F1_avg 0.1335
    Total Loss 4.4130 Global Cls Loss 2.2161 Local Cls Loss 2.1969 AFN Loss 0.0000

    [Train]: 
    Epoch 21
    Data Time 2.4505 (0.0066)
    Batch Time 123.2186 (0.3295)
    Learning Rate 1e-05
    Accuracy 0.8951 0.8951 0.8951 0.8951 0.8951 0.8951 0.8951
    Precision 0.8837 0.8326 0.8331 0.9442 0.8680 0.8968 0.8505
    Recall 0.8936 0.7595 0.7209 0.9469 0.8551 0.8928 0.8929
    F1 0.8886 0.7944 0.7729 0.9455 0.8615 0.8948 0.8712
    Acc_avg 0.8951 Prec_avg 0.8727 Recall_avg 0.8517 F1_avg 0.8613
    Total Loss 0.6023 Global Cls Loss 0.3009 Local Cls Loss 0.3015 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4262 (0.0045)
    Batch Time 17.8864 (0.1903)
    Learning Rate 1e-05
    Accuracy 0.7528 0.7528 0.7528 0.7528 0.7528 0.7528 0.7528
    Precision 0.8119 0.6327 0.4198 0.8399 0.6760 0.6522 0.7109
    Recall 0.7569 0.4559 0.3481 0.8958 0.6488 0.6562 0.7184
    F1 0.7834 0.5299 0.3806 0.8669 0.6621 0.6542 0.7146
Acc_avg 0.7528 Prec_avg 0.6776 Recall_avg 0.6400 F1_avg 0.6560
    Total Loss 1.5718 Global Cls Loss 0.7864 Local Cls Loss 0.7855 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6400.

    Test Target: 
    Data Time 0.0201 (0.0040)
    Batch Time 0.8093 (0.1619)
    Learning Rate 1e-05
    Accuracy 0.1550 0.1550 0.1550 0.1550 0.1550 0.1550 0.1550
    Precision 0.0000 0.0000 0.0000 0.3158 0.0000 0.0000 0.3111
    Recall 0.0000 0.0000 0.0000 0.2500 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.2791 0.0000 0.0000 0.3590
Acc_avg 0.1550 Prec_avg 0.0896 Recall_avg 0.0963 F1_avg 0.0911
    Total Loss 4.2606 Global Cls Loss 2.1369 Local Cls Loss 2.1237 AFN Loss 0.0000

    [Train]: 
    Epoch 22
    Data Time 2.3134 (0.0062)
    Batch Time 125.0556 (0.3344)
    Learning Rate 1e-05
    Accuracy 0.9126 0.9126 0.9126 0.9126 0.9126 0.9126 0.9126
    Precision 0.9344 0.9068 0.8482 0.9466 0.8905 0.9038 0.8734
    Recall 0.9047 0.8168 0.7602 0.9645 0.8721 0.8959 0.9075
    F1 0.9193 0.8594 0.8018 0.9555 0.8812 0.8999 0.8901
    Acc_avg 0.9126 Prec_avg 0.9005 Recall_avg 0.8745 F1_avg 0.8867
    Total Loss 0.5165 Global Cls Loss 0.2578 Local Cls Loss 0.2586 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4254 (0.0045)
    Batch Time 17.9833 (0.1913)
    Learning Rate 1e-05
    Accuracy 0.7568 0.7568 0.7568 0.7568 0.7568 0.7568 0.7568
    Precision 0.7812 0.5849 0.4516 0.8396 0.6879 0.6846 0.7190
    Recall 0.7908 0.4559 0.3544 0.8984 0.6510 0.6375 0.7169
    F1 0.7859 0.5124 0.3972 0.8680 0.6690 0.6602 0.7179
Acc_avg 0.7568 Prec_avg 0.6784 Recall_avg 0.6435 F1_avg 0.6587
    Total Loss 1.5531 Global Cls Loss 0.7772 Local Cls Loss 0.7759 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6435.

    Test Target: 
    Data Time 0.0194 (0.0039)
    Batch Time 0.8009 (0.1602)
    Learning Rate 1e-05
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0667 0.0909 0.0000 0.2917 0.0000 0.0000 0.3023
    Recall 0.0476 0.3333 0.0000 0.2917 0.0000 0.0000 0.3939
    F1 0.0556 0.1429 0.0000 0.2917 0.0000 0.0000 0.3421
Acc_avg 0.1860 Prec_avg 0.1074 Recall_avg 0.1524 F1_avg 0.1189
    Total Loss 4.3787 Global Cls Loss 2.1981 Local Cls Loss 2.1806 AFN Loss 0.0000

    [Train]: 
    Epoch 23
    Data Time 2.3081 (0.0062)
    Batch Time 123.7557 (0.3309)
    Learning Rate 1e-05
    Accuracy 0.9195 0.9195 0.9195 0.9195 0.9195 0.9195 0.9195
    Precision 0.9286 0.9021 0.8500 0.9556 0.9014 0.9253 0.8786
    Recall 0.9308 0.8123 0.7630 0.9651 0.8827 0.8900 0.9193
    F1 0.9297 0.8548 0.8041 0.9603 0.8919 0.9073 0.8985
    Acc_avg 0.9195 Prec_avg 0.9059 Recall_avg 0.8805 F1_avg 0.8924
    Total Loss 0.4829 Global Cls Loss 0.2410 Local Cls Loss 0.2419 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4368 (0.0046)
    Batch Time 18.3012 (0.1947)
    Learning Rate 1e-05
    Accuracy 0.7571 0.7571 0.7571 0.7571 0.7571 0.7571 0.7571
    Precision 0.7877 0.6038 0.4615 0.8396 0.6853 0.6846 0.7136
    Recall 0.7877 0.4706 0.3418 0.8984 0.6577 0.6375 0.7169
    F1 0.7877 0.5289 0.3927 0.8680 0.6712 0.6602 0.7153
Acc_avg 0.7571 Prec_avg 0.6823 Recall_avg 0.6444 F1_avg 0.6606
    Total Loss 1.5855 Global Cls Loss 0.7938 Local Cls Loss 0.7917 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6444.

    Test Target: 
    Data Time 0.0195 (0.0039)
    Batch Time 0.8120 (0.1624)
    Learning Rate 1e-05
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0000 0.1200 0.0000 0.2917 0.0000 0.0000 0.2745
    Recall 0.0000 0.3333 0.0000 0.2917 0.0000 0.0000 0.4242
    F1 0.0000 0.1765 0.0000 0.2917 0.0000 0.0000 0.3333
Acc_avg 0.1860 Prec_avg 0.0980 Recall_avg 0.1499 F1_avg 0.1145
    Total Loss 4.4066 Global Cls Loss 2.2091 Local Cls Loss 2.1975 AFN Loss 0.0000

    [Train]: 
    Epoch 24
    Data Time 2.3910 (0.0064)
    Batch Time 123.8079 (0.3310)
    Learning Rate 1e-05
    Accuracy 0.9259 0.9259 0.9259 0.9259 0.9259 0.9259 0.9259
    Precision 0.9399 0.8939 0.8797 0.9559 0.9064 0.9228 0.8927
    Recall 0.9190 0.8359 0.7798 0.9677 0.9045 0.9134 0.9213
    F1 0.9293 0.8639 0.8268 0.9618 0.9054 0.9181 0.9068
    Acc_avg 0.9259 Prec_avg 0.9130 Recall_avg 0.8916 F1_avg 0.9017
    Total Loss 0.4504 Global Cls Loss 0.2249 Local Cls Loss 0.2254 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4549 (0.0048)
    Batch Time 18.4202 (0.1960)
    Learning Rate 1e-05
    Accuracy 0.7551 0.7551 0.7551 0.7551 0.7551 0.7551 0.7551
    Precision 0.7805 0.5660 0.4257 0.8446 0.6846 0.6957 0.7210
    Recall 0.7877 0.4412 0.3987 0.8958 0.6555 0.6000 0.7123
    F1 0.7841 0.4959 0.4118 0.8695 0.6697 0.6443 0.7167
Acc_avg 0.7551 Prec_avg 0.6740 Recall_avg 0.6416 F1_avg 0.6560
    Total Loss 1.5860 Global Cls Loss 0.7943 Local Cls Loss 0.7917 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0214 (0.0043)
    Batch Time 0.7946 (0.1589)
    Learning Rate 1e-05
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.1071 0.0000 0.4000 0.0000 0.0000 0.2917
    Recall 0.0000 0.3333 0.0000 0.5000 0.0000 0.0000 0.4242
    F1 0.0000 0.1622 0.0000 0.4444 0.0000 0.0000 0.3457
Acc_avg 0.2248 Prec_avg 0.1141 Recall_avg 0.1797 F1_avg 0.1360
    Total Loss 4.5413 Global Cls Loss 2.2815 Local Cls Loss 2.2599 AFN Loss 0.0000

    [Train]: 
    Epoch 25
    Data Time 2.3066 (0.0062)
    Batch Time 123.1716 (0.3293)
    Learning Rate 1e-05
    Accuracy 0.9325 0.9325 0.9325 0.9325 0.9325 0.9325 0.9325
    Precision 0.9325 0.9286 0.8877 0.9623 0.9175 0.9378 0.8980
    Recall 0.9332 0.8435 0.8093 0.9722 0.9039 0.9282 0.9245
    F1 0.9329 0.8840 0.8467 0.9672 0.9106 0.9329 0.9111
    Acc_avg 0.9325 Prec_avg 0.9235 Recall_avg 0.9021 F1_avg 0.9122
    Total Loss 0.4278 Global Cls Loss 0.2137 Local Cls Loss 0.2140 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4887 (0.0052)
    Batch Time 18.6927 (0.1989)
    Learning Rate 1e-05
    Accuracy 0.7624 0.7624 0.7624 0.7624 0.7624 0.7624 0.7624
    Precision 0.8249 0.6140 0.4786 0.8410 0.6767 0.7520 0.7084
    Recall 0.7538 0.5147 0.3544 0.9078 0.6510 0.5875 0.7500
    F1 0.7878 0.5600 0.4073 0.8731 0.6636 0.6596 0.7286
Acc_avg 0.7624 Prec_avg 0.6994 Recall_avg 0.6456 F1_avg 0.6686
    Total Loss 1.6269 Global Cls Loss 0.8150 Local Cls Loss 0.8119 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6456.

    Test Target: 
    Data Time 0.0213 (0.0043)
    Batch Time 0.8253 (0.1651)
    Learning Rate 1e-05
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.0000 0.1364 0.0000 0.3548 0.0000 0.0000 0.2642
    Recall 0.0000 0.3333 0.0000 0.4583 0.0000 0.0000 0.4242
    F1 0.0000 0.1935 0.0000 0.4000 0.0000 0.0000 0.3256
Acc_avg 0.2171 Prec_avg 0.1079 Recall_avg 0.1737 F1_avg 0.1313
    Total Loss 4.6655 Global Cls Loss 2.3409 Local Cls Loss 2.3245 AFN Loss 0.0000

    [Train]: 
    Epoch 26
    Data Time 2.3917 (0.0064)
    Batch Time 122.6859 (0.3280)
    Learning Rate 1e-05
    Accuracy 0.9418 0.9418 0.9418 0.9418 0.9418 0.9418 0.9418
    Precision 0.9458 0.9587 0.9042 0.9659 0.9276 0.9473 0.9118
    Recall 0.9293 0.8855 0.8471 0.9753 0.9241 0.9250 0.9355
    F1 0.9375 0.9206 0.8747 0.9706 0.9259 0.9360 0.9235
    Acc_avg 0.9418 Prec_avg 0.9373 Recall_avg 0.9174 F1_avg 0.9270
    Total Loss 0.3723 Global Cls Loss 0.1857 Local Cls Loss 0.1866 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4193 (0.0045)
    Batch Time 17.9151 (0.1906)
    Learning Rate 1e-05
    Accuracy 0.7571 0.7571 0.7571 0.7571 0.7571 0.7571 0.7571
    Precision 0.8140 0.6400 0.4710 0.8530 0.6771 0.7015 0.6944
    Recall 0.7538 0.4706 0.4114 0.8822 0.6801 0.5875 0.7425
    F1 0.7827 0.5424 0.4392 0.8673 0.6786 0.6395 0.7176
Acc_avg 0.7571 Prec_avg 0.6930 Recall_avg 0.6469 F1_avg 0.6668
    Total Loss 1.6257 Global Cls Loss 0.8146 Local Cls Loss 0.8111 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6469.

    Test Target: 
    Data Time 0.0210 (0.0042)
    Batch Time 0.8142 (0.1628)
    Learning Rate 1e-05
    Accuracy 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705
    Precision 0.0000 0.0588 0.0000 0.2857 0.0000 0.0000 0.3061
    Recall 0.0000 0.1111 0.0000 0.2500 0.0000 0.0000 0.4545
    F1 0.0000 0.0769 0.0000 0.2667 0.0000 0.0000 0.3659
Acc_avg 0.1705 Prec_avg 0.0930 Recall_avg 0.1165 F1_avg 0.1013
    Total Loss 4.6605 Global Cls Loss 2.3411 Local Cls Loss 2.3194 AFN Loss 0.0000

    [Train]: 
    Epoch 27
    Data Time 2.2837 (0.0061)
    Batch Time 123.5753 (0.3304)
    Learning Rate 1e-05
    Accuracy 0.9414 0.9414 0.9414 0.9414 0.9414 0.9414 0.9414
    Precision 0.9394 0.9524 0.8968 0.9658 0.9275 0.9463 0.9165
    Recall 0.9372 0.8397 0.8539 0.9739 0.9225 0.9311 0.9351
    F1 0.9383 0.8925 0.8748 0.9698 0.9250 0.9387 0.9257
    Acc_avg 0.9414 Prec_avg 0.9350 Recall_avg 0.9133 F1_avg 0.9235
    Total Loss 0.3610 Global Cls Loss 0.1801 Local Cls Loss 0.1809 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4160 (0.0044)
    Batch Time 17.9080 (0.1905)
    Learning Rate 1e-05
    Accuracy 0.7588 0.7588 0.7588 0.7588 0.7588 0.7588 0.7588
    Precision 0.7868 0.6471 0.4677 0.8431 0.6772 0.6849 0.7201
    Recall 0.7723 0.4853 0.3671 0.8992 0.6711 0.6250 0.7169
    F1 0.7795 0.5546 0.4113 0.8702 0.6742 0.6536 0.7185
Acc_avg 0.7588 Prec_avg 0.6896 Recall_avg 0.6481 F1_avg 0.6660
    Total Loss 1.6521 Global Cls Loss 0.8284 Local Cls Loss 0.8237 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6481.

    Test Target: 
    Data Time 0.0215 (0.0043)
    Batch Time 0.8151 (0.1630)
    Learning Rate 1e-05
    Accuracy 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016
    Precision 0.0000 0.1579 0.0000 0.3125 0.0000 0.0000 0.2826
    Recall 0.0000 0.3333 0.0000 0.4167 0.0000 0.0000 0.3939
    F1 0.0000 0.2143 0.0000 0.3571 0.0000 0.0000 0.3291
Acc_avg 0.2016 Prec_avg 0.1076 Recall_avg 0.1634 F1_avg 0.1286
    Total Loss 4.8315 Global Cls Loss 2.4262 Local Cls Loss 2.4052 AFN Loss 0.0000

    [Train]: 
    Epoch 28
    Data Time 2.2664 (0.0061)
    Batch Time 123.2180 (0.3295)
    Learning Rate 1e-05
    Accuracy 0.9407 0.9407 0.9407 0.9407 0.9407 0.9407 0.9407
    Precision 0.9441 0.9194 0.9024 0.9660 0.9293 0.9544 0.9084
    Recall 0.9396 0.8702 0.8555 0.9770 0.9135 0.9208 0.9302
    F1 0.9419 0.8941 0.8783 0.9715 0.9213 0.9373 0.9192
    Acc_avg 0.9407 Prec_avg 0.9320 Recall_avg 0.9153 F1_avg 0.9234
    Total Loss 0.3465 Global Cls Loss 0.1731 Local Cls Loss 0.1734 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4069 (0.0043)
    Batch Time 18.1736 (0.1933)
    Learning Rate 1e-05
    Accuracy 0.7568 0.7568 0.7568 0.7568 0.7568 0.7568 0.7568
    Precision 0.7923 0.6458 0.4610 0.8667 0.6797 0.6558 0.6915
    Recall 0.7631 0.4559 0.4114 0.8830 0.6600 0.6312 0.7395
    F1 0.7774 0.5345 0.4348 0.8748 0.6697 0.6433 0.7147
Acc_avg 0.7568 Prec_avg 0.6847 Recall_avg 0.6491 F1_avg 0.6642
    Total Loss 1.6697 Global Cls Loss 0.8373 Local Cls Loss 0.8325 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6491.

    Test Target: 
    Data Time 0.0219 (0.0044)
    Batch Time 0.8481 (0.1696)
    Learning Rate 1e-05
    Accuracy 0.1783 0.1783 0.1783 0.1783 0.1783 0.1783 0.1783
    Precision 0.0000 0.1579 0.0000 0.2000 0.0000 0.0000 0.2623
    Recall 0.0000 0.3333 0.0000 0.1667 0.0000 0.0000 0.4848
    F1 0.0000 0.2143 0.0000 0.1818 0.0000 0.0000 0.3404
Acc_avg 0.1783 Prec_avg 0.0886 Recall_avg 0.1407 F1_avg 0.1052
    Total Loss 4.7453 Global Cls Loss 2.3821 Local Cls Loss 2.3632 AFN Loss 0.0000

    [Train]: 
    Epoch 29
    Data Time 2.2596 (0.0060)
    Batch Time 123.4603 (0.3301)
    Learning Rate 1e-05
    Accuracy 0.9444 0.9444 0.9444 0.9444 0.9444 0.9444 0.9444
    Precision 0.9497 0.9393 0.8988 0.9689 0.9225 0.9385 0.9264
    Recall 0.9444 0.8855 0.8345 0.9739 0.9283 0.9413 0.9396
    F1 0.9470 0.9116 0.8655 0.9714 0.9254 0.9399 0.9329
    Acc_avg 0.9444 Prec_avg 0.9349 Recall_avg 0.9211 F1_avg 0.9277
    Total Loss 0.3396 Global Cls Loss 0.1697 Local Cls Loss 0.1700 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5119 (0.0054)
    Batch Time 18.0445 (0.1920)
    Learning Rate 1e-05
    Accuracy 0.7584 0.7584 0.7584 0.7584 0.7584 0.7584 0.7584
    Precision 0.8152 0.5714 0.5045 0.8620 0.6796 0.7037 0.6748
    Recall 0.7600 0.4706 0.3544 0.8907 0.6644 0.5938 0.7530
    F1 0.7866 0.5161 0.4164 0.8761 0.6719 0.6441 0.7117
Acc_avg 0.7584 Prec_avg 0.6873 Recall_avg 0.6410 F1_avg 0.6604
    Total Loss 1.6835 Global Cls Loss 0.8443 Local Cls Loss 0.8393 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0204 (0.0041)
    Batch Time 0.8021 (0.1604)
    Learning Rate 1e-05
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0000 0.0000 0.0000 0.3750 0.0833 0.0000 0.2162
    Recall 0.0000 0.0000 0.0000 0.2500 0.1667 0.0000 0.4848
    F1 0.0000 0.0000 0.0000 0.3000 0.1111 0.0000 0.2991
Acc_avg 0.1860 Prec_avg 0.0964 Recall_avg 0.1288 F1_avg 0.1015
    Total Loss 5.0554 Global Cls Loss 2.5341 Local Cls Loss 2.5212 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 79.995080s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.624371s

    [Train]: 
    Epoch 30
    Data Time 2.3919 (0.0064)
    Batch Time 123.9334 (0.3314)
    Learning Rate 1e-05
    Accuracy 0.9474 0.9474 0.9474 0.9474 0.9474 0.9474 0.9474
    Precision 0.9569 0.9216 0.9038 0.9696 0.9457 0.9390 0.9188
    Recall 0.9523 0.8969 0.8696 0.9758 0.9247 0.9252 0.9419
    F1 0.9546 0.9091 0.8863 0.9727 0.9351 0.9321 0.9302
    Acc_avg 0.9474 Prec_avg 0.9365 Recall_avg 0.9266 F1_avg 0.9314
    Total Loss 0.3169 Global Cls Loss 0.1581 Local Cls Loss 0.1588 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3991 (0.0042)
    Batch Time 17.8090 (0.1895)
    Learning Rate 1e-05
    Accuracy 0.7521 0.7521 0.7521 0.7521 0.7521 0.7521 0.7521
    Precision 0.8204 0.6875 0.4627 0.8419 0.6705 0.6556 0.6944
    Recall 0.7169 0.4853 0.3924 0.9001 0.6600 0.6188 0.7154
    F1 0.7652 0.5690 0.4247 0.8700 0.6652 0.6367 0.7047
Acc_avg 0.7521 Prec_avg 0.6904 Recall_avg 0.6413 F1_avg 0.6622
    Total Loss 1.7234 Global Cls Loss 0.8649 Local Cls Loss 0.8585 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0209 (0.0042)
    Batch Time 0.8050 (0.1610)
    Learning Rate 1e-05
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.3429 0.0000 0.0000 0.2586
    Recall 0.0000 0.0000 0.0000 0.5000 0.0000 0.0000 0.4545
    F1 0.0000 0.0000 0.0000 0.4068 0.0000 0.0000 0.3297
Acc_avg 0.2093 Prec_avg 0.0859 Recall_avg 0.1364 F1_avg 0.1052
    Total Loss 4.9771 Global Cls Loss 2.4960 Local Cls Loss 2.4812 AFN Loss 0.0000

    [Train]: 
    Epoch 31
    Data Time 2.2054 (0.0059)
    Batch Time 124.2947 (0.3323)
    Learning Rate 1e-05
    Accuracy 0.9525 0.9525 0.9525 0.9525 0.9525 0.9525 0.9525
    Precision 0.9539 0.9551 0.9145 0.9748 0.9415 0.9556 0.9276
    Recall 0.9531 0.8931 0.8850 0.9779 0.9390 0.9472 0.9416
    F1 0.9535 0.9231 0.8995 0.9763 0.9402 0.9514 0.9345
    Acc_avg 0.9525 Prec_avg 0.9461 Recall_avg 0.9338 F1_avg 0.9398
    Total Loss 0.2870 Global Cls Loss 0.1430 Local Cls Loss 0.1440 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.6040 (0.0064)
    Batch Time 18.1253 (0.1928)
    Learning Rate 1e-05
    Accuracy 0.7604 0.7604 0.7604 0.7604 0.7604 0.7604 0.7604
    Precision 0.7890 0.6471 0.4786 0.8508 0.7057 0.6853 0.6999
    Recall 0.7477 0.4853 0.4241 0.9009 0.6600 0.6125 0.7304
    F1 0.7678 0.5546 0.4497 0.8752 0.6821 0.6469 0.7148
Acc_avg 0.7604 Prec_avg 0.6938 Recall_avg 0.6516 F1_avg 0.6701
    Total Loss 1.7050 Global Cls Loss 0.8557 Local Cls Loss 0.8493 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6516.

    Test Target: 
    Data Time 0.0210 (0.0042)
    Batch Time 0.8361 (0.1672)
    Learning Rate 1e-05
    Accuracy 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016
    Precision 0.2000 0.0000 0.0000 0.2955 0.0000 0.0000 0.2727
    Recall 0.0476 0.0000 0.0000 0.5417 0.0000 0.0000 0.3636
    F1 0.0769 0.0000 0.0000 0.3824 0.0000 0.0000 0.3117
Acc_avg 0.2016 Prec_avg 0.1097 Recall_avg 0.1361 F1_avg 0.1101
    Total Loss 5.2671 Global Cls Loss 2.6476 Local Cls Loss 2.6195 AFN Loss 0.0000

    [Train]: 
    Epoch 32
    Data Time 2.1927 (0.0059)
    Batch Time 123.5746 (0.3304)
    Learning Rate 1e-05
    Accuracy 0.9490 0.9490 0.9490 0.9490 0.9490 0.9490 0.9490
    Precision 0.9586 0.9528 0.9088 0.9696 0.9318 0.9435 0.9303
    Recall 0.9563 0.9237 0.8668 0.9760 0.9273 0.9311 0.9420
    F1 0.9574 0.9380 0.8873 0.9728 0.9295 0.9373 0.9361
    Acc_avg 0.9490 Prec_avg 0.9422 Recall_avg 0.9319 F1_avg 0.9369
    Total Loss 0.3057 Global Cls Loss 0.1524 Local Cls Loss 0.1533 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4045 (0.0043)
    Batch Time 17.8869 (0.1903)
    Learning Rate 1e-05
    Accuracy 0.7611 0.7611 0.7611 0.7611 0.7611 0.7611 0.7611
    Precision 0.7652 0.6600 0.4844 0.8415 0.7150 0.6538 0.7194
    Recall 0.7723 0.4853 0.3924 0.9112 0.6286 0.6375 0.7259
    F1 0.7688 0.5593 0.4336 0.8749 0.6690 0.6456 0.7226
Acc_avg 0.7611 Prec_avg 0.6913 Recall_avg 0.6505 F1_avg 0.6677
    Total Loss 1.7380 Global Cls Loss 0.8729 Local Cls Loss 0.8651 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0210 (0.0042)
    Batch Time 0.7883 (0.1577)
    Learning Rate 1e-05
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.5000 0.0000 0.0000 0.2600 0.0000 0.0000 0.2708
    Recall 0.1429 0.0000 0.0000 0.5417 0.0000 0.0000 0.3939
    F1 0.2222 0.0000 0.0000 0.3514 0.0000 0.0000 0.3210
Acc_avg 0.2248 Prec_avg 0.1473 Recall_avg 0.1541 F1_avg 0.1278
    Total Loss 5.5618 Global Cls Loss 2.7925 Local Cls Loss 2.7693 AFN Loss 0.0000

    [Train]: 
    Epoch 33
    Data Time 2.2590 (0.0060)
    Batch Time 123.3625 (0.3298)
    Learning Rate 1e-05
    Accuracy 0.9538 0.9538 0.9538 0.9538 0.9538 0.9538 0.9538
    Precision 0.9625 0.9480 0.9296 0.9726 0.9354 0.9527 0.9350
    Recall 0.9579 0.9046 0.8892 0.9807 0.9300 0.9457 0.9448
    F1 0.9602 0.9258 0.9090 0.9766 0.9327 0.9492 0.9399
    Acc_avg 0.9538 Prec_avg 0.9480 Recall_avg 0.9361 F1_avg 0.9419
    Total Loss 0.2795 Global Cls Loss 0.1396 Local Cls Loss 0.1399 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5510 (0.0059)
    Batch Time 17.8416 (0.1898)
    Learning Rate 1e-05
    Accuracy 0.7588 0.7588 0.7588 0.7588 0.7588 0.7588 0.7588
    Precision 0.7993 0.6316 0.4844 0.8278 0.7285 0.6667 0.7101
    Recall 0.7477 0.5294 0.3924 0.9112 0.6063 0.6375 0.7380
    F1 0.7727 0.5760 0.4336 0.8675 0.6618 0.6518 0.7238
Acc_avg 0.7588 Prec_avg 0.6926 Recall_avg 0.6518 F1_avg 0.6696
    Total Loss 1.7840 Global Cls Loss 0.8964 Local Cls Loss 0.8876 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6518.

    Test Target: 
    Data Time 0.0230 (0.0046)
    Batch Time 0.8320 (0.1664)
    Learning Rate 1e-05
    Accuracy 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938
    Precision 0.2000 0.0000 0.0000 0.2115 0.0000 0.0000 0.2453
    Recall 0.0476 0.0000 0.0000 0.4583 0.0000 0.0000 0.3939
    F1 0.0769 0.0000 0.0000 0.2895 0.0000 0.0000 0.3023
Acc_avg 0.1938 Prec_avg 0.0938 Recall_avg 0.1286 F1_avg 0.0955
    Total Loss 5.7066 Global Cls Loss 2.8642 Local Cls Loss 2.8424 AFN Loss 0.0000

    [Train]: 
    Epoch 34
    Data Time 2.2982 (0.0061)
    Batch Time 124.9317 (0.3340)
    Learning Rate 1e-05
    Accuracy 0.9566 0.9566 0.9566 0.9566 0.9566 0.9566 0.9566
    Precision 0.9642 0.9508 0.9233 0.9728 0.9428 0.9644 0.9395
    Recall 0.9619 0.8855 0.8792 0.9817 0.9438 0.9559 0.9456
    F1 0.9630 0.9170 0.9007 0.9773 0.9433 0.9602 0.9426
    Acc_avg 0.9566 Prec_avg 0.9511 Recall_avg 0.9362 F1_avg 0.9434
    Total Loss 0.2628 Global Cls Loss 0.1311 Local Cls Loss 0.1317 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3983 (0.0042)
    Batch Time 17.7987 (0.1893)
    Learning Rate 1e-05
    Accuracy 0.7541 0.7541 0.7541 0.7541 0.7541 0.7541 0.7541
    Precision 0.7873 0.6071 0.4357 0.8395 0.7042 0.6689 0.7073
    Recall 0.7631 0.5000 0.3861 0.8975 0.6443 0.6188 0.7169
    F1 0.7750 0.5484 0.4094 0.8675 0.6729 0.6429 0.7120
Acc_avg 0.7541 Prec_avg 0.6786 Recall_avg 0.6467 F1_avg 0.6612
    Total Loss 1.7630 Global Cls Loss 0.8862 Local Cls Loss 0.8768 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0232 (0.0046)
    Batch Time 0.8022 (0.1604)
    Learning Rate 1e-05
    Accuracy 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558 0.2558
    Precision 0.3000 0.0000 0.0000 0.4242 0.0882 0.0000 0.2955
    Recall 0.1429 0.0000 0.0000 0.5833 0.2500 0.0000 0.3939
    F1 0.1935 0.0000 0.0000 0.4912 0.1304 0.0000 0.3377
Acc_avg 0.2558 Prec_avg 0.1583 Recall_avg 0.1957 F1_avg 0.1647
    Total Loss 5.4650 Global Cls Loss 2.7431 Local Cls Loss 2.7219 AFN Loss 0.0000

    [Train]: 
    Epoch 35
    Data Time 2.4051 (0.0064)
    Batch Time 122.5358 (0.3276)
    Learning Rate 1e-05
    Accuracy 0.9593 0.9593 0.9593 0.9593 0.9593 0.9593 0.9593
    Precision 0.9627 0.9643 0.9383 0.9761 0.9515 0.9601 0.9367
    Recall 0.9627 0.9310 0.8738 0.9815 0.9475 0.9516 0.9541
    F1 0.9627 0.9474 0.9049 0.9788 0.9495 0.9558 0.9453
    Acc_avg 0.9593 Prec_avg 0.9556 Recall_avg 0.9432 F1_avg 0.9492
    Total Loss 0.2468 Global Cls Loss 0.1230 Local Cls Loss 0.1238 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.6040 (0.0064)
    Batch Time 17.9767 (0.1912)
    Learning Rate 1e-05
    Accuracy 0.7531 0.7531 0.7531 0.7531 0.7531 0.7531 0.7531
    Precision 0.7743 0.5789 0.4571 0.8444 0.6955 0.7000 0.6968
    Recall 0.7600 0.4853 0.4051 0.8992 0.6286 0.6125 0.7199
    F1 0.7671 0.5280 0.4295 0.8710 0.6604 0.6533 0.7081
Acc_avg 0.7531 Prec_avg 0.6782 Recall_avg 0.6444 F1_avg 0.6596
    Total Loss 1.7853 Global Cls Loss 0.8971 Local Cls Loss 0.8882 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0225 (0.0045)
    Batch Time 0.8275 (0.1655)
    Learning Rate 1e-05
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.2000 0.0000 0.0000 0.3000 0.0909 0.0000 0.2545
    Recall 0.0476 0.0000 0.0000 0.2500 0.2500 0.0000 0.4242
    F1 0.0769 0.0000 0.0000 0.2727 0.1333 0.0000 0.3182
Acc_avg 0.1860 Prec_avg 0.1208 Recall_avg 0.1388 F1_avg 0.1145
    Total Loss 5.5014 Global Cls Loss 2.7701 Local Cls Loss 2.7312 AFN Loss 0.0000

    [Train]: 
    Epoch 36
    Data Time 2.2077 (0.0059)
    Batch Time 123.5310 (0.3303)
    Learning Rate 1e-05
    Accuracy 0.9586 0.9586 0.9586 0.9586 0.9586 0.9586 0.9586
    Precision 0.9657 0.9478 0.9234 0.9755 0.9468 0.9616 0.9420
    Recall 0.9618 0.9008 0.8794 0.9815 0.9437 0.9559 0.9546
    F1 0.9638 0.9237 0.9009 0.9785 0.9452 0.9588 0.9482
    Acc_avg 0.9586 Prec_avg 0.9518 Recall_avg 0.9397 F1_avg 0.9456
    Total Loss 0.2405 Global Cls Loss 0.1196 Local Cls Loss 0.1208 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4300 (0.0046)
    Batch Time 17.8247 (0.1896)
    Learning Rate 1e-05
    Accuracy 0.7554 0.7554 0.7554 0.7554 0.7554 0.7554 0.7554
    Precision 0.7806 0.6522 0.4511 0.8600 0.6608 0.7055 0.6990
    Recall 0.7662 0.4412 0.3797 0.8864 0.6667 0.6438 0.7274
    F1 0.7733 0.5263 0.4124 0.8730 0.6637 0.6732 0.7129
Acc_avg 0.7554 Prec_avg 0.6870 Recall_avg 0.6445 F1_avg 0.6621
    Total Loss 1.8089 Global Cls Loss 0.9097 Local Cls Loss 0.8992 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0197 (0.0039)
    Batch Time 0.7997 (0.1599)
    Learning Rate 1e-05
    Accuracy 0.1783 0.1783 0.1783 0.1783 0.1783 0.1783 0.1783
    Precision 0.0000 0.0000 0.0000 0.3125 0.1154 0.0000 0.2143
    Recall 0.0000 0.0000 0.0000 0.2083 0.2500 0.0000 0.4545
    F1 0.0000 0.0000 0.0000 0.2500 0.1579 0.0000 0.2913
Acc_avg 0.1783 Prec_avg 0.0917 Recall_avg 0.1304 F1_avg 0.0999
    Total Loss 5.7238 Global Cls Loss 2.8792 Local Cls Loss 2.8445 AFN Loss 0.0000

    [Train]: 
    Epoch 37
    Data Time 2.3360 (0.0062)
    Batch Time 125.4496 (0.3354)
    Learning Rate 1e-05
    Accuracy 0.9596 0.9596 0.9596 0.9596 0.9596 0.9596 0.9596
    Precision 0.9611 0.9225 0.9340 0.9773 0.9514 0.9518 0.9444
    Recall 0.9611 0.9084 0.9130 0.9796 0.9453 0.9545 0.9517
    F1 0.9611 0.9154 0.9234 0.9785 0.9483 0.9531 0.9480
    Acc_avg 0.9596 Prec_avg 0.9489 Recall_avg 0.9448 F1_avg 0.9468
    Total Loss 0.2470 Global Cls Loss 0.1230 Local Cls Loss 0.1239 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4856 (0.0052)
    Batch Time 18.0175 (0.1917)
    Learning Rate 1e-05
    Accuracy 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591
    Precision 0.7726 0.5862 0.4917 0.8583 0.6918 0.6522 0.7061
    Recall 0.7631 0.5000 0.3734 0.8898 0.6577 0.6562 0.7380
    F1 0.7678 0.5397 0.4245 0.8738 0.6743 0.6542 0.7216
Acc_avg 0.7591 Prec_avg 0.6798 Recall_avg 0.6540 F1_avg 0.6651
    Total Loss 1.8061 Global Cls Loss 0.9069 Local Cls Loss 0.8992 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6540.

    Test Target: 
    Data Time 0.0225 (0.0045)
    Batch Time 0.8184 (0.1637)
    Learning Rate 1e-05
    Accuracy 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860 0.1860
    Precision 0.0000 0.0000 0.0000 0.3226 0.0000 0.0000 0.2692
    Recall 0.0000 0.0000 0.0000 0.4167 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3636 0.0000 0.0000 0.3294
Acc_avg 0.1860 Prec_avg 0.0845 Recall_avg 0.1201 F1_avg 0.0990
    Total Loss 6.3247 Global Cls Loss 3.1874 Local Cls Loss 3.1373 AFN Loss 0.0000

    [Train]: 
    Epoch 38
    Data Time 2.3025 (0.0062)
    Batch Time 123.9442 (0.3314)
    Learning Rate 1e-05
    Accuracy 0.9627 0.9627 0.9627 0.9627 0.9627 0.9627 0.9627
    Precision 0.9712 0.9760 0.9331 0.9768 0.9477 0.9686 0.9484
    Recall 0.9634 0.9313 0.9030 0.9843 0.9517 0.9501 0.9538
    F1 0.9673 0.9531 0.9178 0.9805 0.9497 0.9593 0.9511
    Acc_avg 0.9627 Prec_avg 0.9603 Recall_avg 0.9482 F1_avg 0.9541
    Total Loss 0.2238 Global Cls Loss 0.1115 Local Cls Loss 0.1123 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3927 (0.0042)
    Batch Time 18.1672 (0.1933)
    Learning Rate 1e-05
    Accuracy 0.7598 0.7598 0.7598 0.7598 0.7598 0.7598 0.7598
    Precision 0.7898 0.7111 0.4468 0.8519 0.6771 0.6667 0.7206
    Recall 0.7631 0.4706 0.3987 0.8992 0.6756 0.6500 0.7108
    F1 0.7762 0.5664 0.4214 0.8749 0.6764 0.6582 0.7157
Acc_avg 0.7598 Prec_avg 0.6949 Recall_avg 0.6526 F1_avg 0.6699
    Total Loss 1.8131 Global Cls Loss 0.9102 Local Cls Loss 0.9029 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0227 (0.0045)
    Batch Time 0.8029 (0.1606)
    Learning Rate 1e-05
    Accuracy 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016
    Precision 0.0000 0.0000 0.0000 0.2667 0.0000 0.0000 0.2333
    Recall 0.0000 0.0000 0.0000 0.5000 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3478 0.0000 0.0000 0.3011
Acc_avg 0.2016 Prec_avg 0.0714 Recall_avg 0.1320 F1_avg 0.0927
    Total Loss 5.9363 Global Cls Loss 2.9806 Local Cls Loss 2.9556 AFN Loss 0.0000

    [Train]: 
    Epoch 39
    Data Time 2.2317 (0.0060)
    Batch Time 124.0594 (0.3317)
    Learning Rate 1e-05
    Accuracy 0.9625 0.9625 0.9625 0.9625 0.9625 0.9625 0.9625
    Precision 0.9665 0.9533 0.9338 0.9801 0.9596 0.9618 0.9387
    Recall 0.9635 0.9351 0.9102 0.9824 0.9448 0.9604 0.9562
    F1 0.9650 0.9441 0.9219 0.9812 0.9521 0.9611 0.9473
    Acc_avg 0.9625 Prec_avg 0.9563 Recall_avg 0.9504 F1_avg 0.9533
    Total Loss 0.2186 Global Cls Loss 0.1089 Local Cls Loss 0.1097 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3993 (0.0042)
    Batch Time 17.8168 (0.1895)
    Learning Rate 1e-05
    Accuracy 0.7581 0.7581 0.7581 0.7581 0.7581 0.7581 0.7581
    Precision 0.7638 0.6957 0.4892 0.8521 0.6757 0.6603 0.7176
    Recall 0.7662 0.4706 0.4304 0.9001 0.6667 0.6438 0.7003
    F1 0.7650 0.5614 0.4579 0.8754 0.6712 0.6519 0.7088
Acc_avg 0.7581 Prec_avg 0.6935 Recall_avg 0.6540 F1_avg 0.6702
    Total Loss 1.8301 Global Cls Loss 0.9192 Local Cls Loss 0.9109 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0220 (0.0044)
    Batch Time 0.7899 (0.1580)
    Learning Rate 1e-05
    Accuracy 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016
    Precision 0.0000 0.0000 0.0000 0.2683 0.0000 0.0000 0.2586
    Recall 0.0000 0.0000 0.0000 0.4583 0.0000 0.0000 0.4545
    F1 0.0000 0.0000 0.0000 0.3385 0.0000 0.0000 0.3297
Acc_avg 0.2016 Prec_avg 0.0753 Recall_avg 0.1304 F1_avg 0.0954
    Total Loss 5.4397 Global Cls Loss 2.7310 Local Cls Loss 2.7088 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 79.343299s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.545824s

    [Train]: 
    Epoch 40
    Data Time 2.3419 (0.0063)
    Batch Time 124.1718 (0.3320)
    Learning Rate 1e-05
    Accuracy 0.9676 0.9676 0.9676 0.9676 0.9676 0.9676 0.9676
    Precision 0.9646 0.9356 0.9534 0.9822 0.9604 0.9777 0.9513
    Recall 0.9730 0.9427 0.9187 0.9858 0.9512 0.9663 0.9598
    F1 0.9688 0.9392 0.9357 0.9840 0.9558 0.9720 0.9556
    Acc_avg 0.9676 Prec_avg 0.9607 Recall_avg 0.9568 F1_avg 0.9587
    Total Loss 0.2034 Global Cls Loss 0.1013 Local Cls Loss 0.1022 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.5196 (0.0055)
    Batch Time 18.1310 (0.1929)
    Learning Rate 1e-05
    Accuracy 0.7561 0.7561 0.7561 0.7561 0.7561 0.7561 0.7561
    Precision 0.8027 0.6531 0.4589 0.8491 0.6812 0.6842 0.7021
    Recall 0.7385 0.4706 0.4241 0.8941 0.6644 0.6500 0.7169
    F1 0.7692 0.5470 0.4408 0.8710 0.6727 0.6667 0.7094
Acc_avg 0.7561 Prec_avg 0.6902 Recall_avg 0.6512 F1_avg 0.6681
    Total Loss 1.8738 Global Cls Loss 0.9416 Local Cls Loss 0.9323 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0207 (0.0041)
    Batch Time 0.7896 (0.1579)
    Learning Rate 1e-05
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2273 0.0000 0.0000 0.2500
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3333 0.0000 0.0000 0.3146
Acc_avg 0.2248 Prec_avg 0.0682 Recall_avg 0.1499 F1_avg 0.0926
    Total Loss 6.2075 Global Cls Loss 3.1294 Local Cls Loss 3.0781 AFN Loss 0.0000

    [Train]: 
    Epoch 41
    Data Time 2.4112 (0.0064)
    Batch Time 123.5715 (0.3304)
    Learning Rate 1e-06
    Accuracy 0.9664 0.9664 0.9664 0.9664 0.9664 0.9664 0.9664
    Precision 0.9713 0.9721 0.9413 0.9784 0.9631 0.9620 0.9513
    Recall 0.9666 0.9313 0.9229 0.9836 0.9544 0.9677 0.9586
    F1 0.9689 0.9513 0.9320 0.9810 0.9587 0.9649 0.9549
    Acc_avg 0.9664 Prec_avg 0.9628 Recall_avg 0.9550 F1_avg 0.9588
    Total Loss 0.2052 Global Cls Loss 0.1023 Local Cls Loss 0.1029 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4475 (0.0048)
    Batch Time 18.1468 (0.1931)
    Learning Rate 1e-06
    Accuracy 0.7534 0.7534 0.7534 0.7534 0.7534 0.7534 0.7534
    Precision 0.8079 0.6471 0.4662 0.8529 0.6652 0.6710 0.6913
    Recall 0.7508 0.4853 0.3924 0.8915 0.6711 0.6500 0.7048
    F1 0.7783 0.5546 0.4261 0.8718 0.6682 0.6603 0.6980
Acc_avg 0.7534 Prec_avg 0.6859 Recall_avg 0.6494 F1_avg 0.6653
    Total Loss 1.8674 Global Cls Loss 0.9383 Local Cls Loss 0.9292 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0200 (0.0040)
    Batch Time 0.7836 (0.1567)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2419 0.0000 0.0000 0.2545
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3488 0.0000 0.0000 0.3182
Acc_avg 0.2248 Prec_avg 0.0709 Recall_avg 0.1499 F1_avg 0.0953
    Total Loss 6.3337 Global Cls Loss 3.1966 Local Cls Loss 3.1371 AFN Loss 0.0000

    [Train]: 
    Epoch 42
    Data Time 2.3563 (0.0063)
    Batch Time 124.0839 (0.3318)
    Learning Rate 1e-06
    Accuracy 0.9681 0.9681 0.9681 0.9681 0.9681 0.9681 0.9681
    Precision 0.9698 0.9676 0.9562 0.9785 0.9640 0.9650 0.9546
    Recall 0.9690 0.9122 0.9187 0.9868 0.9528 0.9692 0.9635
    F1 0.9694 0.9391 0.9371 0.9826 0.9584 0.9671 0.9590
    Acc_avg 0.9681 Prec_avg 0.9651 Recall_avg 0.9532 F1_avg 0.9589
    Total Loss 0.1897 Global Cls Loss 0.0946 Local Cls Loss 0.0950 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4254 (0.0045)
    Batch Time 17.8513 (0.1899)
    Learning Rate 1e-06
    Accuracy 0.7548 0.7548 0.7548 0.7548 0.7548 0.7548 0.7548
    Precision 0.8100 0.5965 0.4247 0.8619 0.6603 0.6604 0.7095
    Recall 0.7477 0.5000 0.3924 0.8898 0.6913 0.6562 0.6988
    F1 0.7776 0.5440 0.4079 0.8756 0.6754 0.6583 0.7041
Acc_avg 0.7548 Prec_avg 0.6747 Recall_avg 0.6538 F1_avg 0.6633
    Total Loss 1.8705 Global Cls Loss 0.9399 Local Cls Loss 0.9306 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0195 (0.0039)
    Batch Time 0.7810 (0.1562)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2632 0.0000 0.0000 0.2593
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3704 0.0000 0.0000 0.3218
Acc_avg 0.2248 Prec_avg 0.0746 Recall_avg 0.1499 F1_avg 0.0989
    Total Loss 6.2015 Global Cls Loss 3.1297 Local Cls Loss 3.0719 AFN Loss 0.0000

    [Train]: 
    Epoch 43
    Data Time 2.2744 (0.0061)
    Batch Time 123.2214 (0.3295)
    Learning Rate 1e-06
    Accuracy 0.9702 0.9702 0.9702 0.9702 0.9702 0.9702 0.9702
    Precision 0.9768 0.9651 0.9441 0.9841 0.9609 0.9708 0.9551
    Recall 0.9714 0.9504 0.9256 0.9855 0.9538 0.9736 0.9667
    F1 0.9741 0.9577 0.9348 0.9848 0.9574 0.9722 0.9609
    Acc_avg 0.9702 Prec_avg 0.9653 Recall_avg 0.9610 F1_avg 0.9631
    Total Loss 0.1846 Global Cls Loss 0.0919 Local Cls Loss 0.0927 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4097 (0.0044)
    Batch Time 17.9643 (0.1911)
    Learning Rate 1e-06
    Accuracy 0.7574 0.7574 0.7574 0.7574 0.7574 0.7574 0.7574
    Precision 0.7910 0.6458 0.4646 0.8498 0.6841 0.6667 0.7041
    Recall 0.7569 0.4559 0.3734 0.8984 0.6734 0.6375 0.7169
    F1 0.7736 0.5345 0.4140 0.8734 0.6787 0.6518 0.7104
Acc_avg 0.7574 Prec_avg 0.6866 Recall_avg 0.6446 F1_avg 0.6623
    Total Loss 1.8554 Global Cls Loss 0.9321 Local Cls Loss 0.9233 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0177 (0.0035)
    Batch Time 0.8287 (0.1657)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2586 0.0000 0.0000 0.2545
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3659 0.0000 0.0000 0.3182
Acc_avg 0.2248 Prec_avg 0.0733 Recall_avg 0.1499 F1_avg 0.0977
    Total Loss 6.1049 Global Cls Loss 3.0793 Local Cls Loss 3.0257 AFN Loss 0.0000

    [Train]: 
    Epoch 44
    Data Time 2.3173 (0.0062)
    Batch Time 125.0526 (0.3344)
    Learning Rate 1e-06
    Accuracy 0.9686 0.9686 0.9686 0.9686 0.9686 0.9686 0.9686
    Precision 0.9707 0.9721 0.9408 0.9785 0.9677 0.9602 0.9588
    Recall 0.9746 0.9313 0.9144 0.9872 0.9533 0.9574 0.9643
    F1 0.9726 0.9513 0.9275 0.9829 0.9604 0.9588 0.9616
    Acc_avg 0.9686 Prec_avg 0.9641 Recall_avg 0.9547 F1_avg 0.9593
    Total Loss 0.1895 Global Cls Loss 0.0944 Local Cls Loss 0.0951 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.6196 (0.0066)
    Batch Time 17.9406 (0.1909)
    Learning Rate 1e-06
    Accuracy 0.7561 0.7561 0.7561 0.7561 0.7561 0.7561 0.7561
    Precision 0.8020 0.6400 0.4672 0.8475 0.6797 0.6913 0.6990
    Recall 0.7477 0.4706 0.4051 0.8967 0.6600 0.6438 0.7169
    F1 0.7739 0.5424 0.4339 0.8714 0.6697 0.6667 0.7078
Acc_avg 0.7561 Prec_avg 0.6895 Recall_avg 0.6487 F1_avg 0.6665
    Total Loss 1.8671 Global Cls Loss 0.9381 Local Cls Loss 0.9289 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0226 (0.0045)
    Batch Time 0.7970 (0.1594)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2679 0.0000 0.0000 0.2545
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3750 0.0000 0.0000 0.3182
Acc_avg 0.2248 Prec_avg 0.0746 Recall_avg 0.1499 F1_avg 0.0990
    Total Loss 6.0671 Global Cls Loss 3.0583 Local Cls Loss 3.0088 AFN Loss 0.0000

    [Train]: 
    Epoch 45
    Data Time 2.2571 (0.0060)
    Batch Time 123.0749 (0.3291)
    Learning Rate 1e-06
    Accuracy 0.9706 0.9706 0.9706 0.9706 0.9706 0.9706 0.9706
    Precision 0.9670 0.9529 0.9562 0.9829 0.9699 0.9678 0.9562
    Recall 0.9762 0.9275 0.9187 0.9872 0.9591 0.9692 0.9647
    F1 0.9715 0.9400 0.9371 0.9850 0.9645 0.9685 0.9604
    Acc_avg 0.9706 Prec_avg 0.9647 Recall_avg 0.9575 F1_avg 0.9610
    Total Loss 0.1838 Global Cls Loss 0.0914 Local Cls Loss 0.0924 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5277 (0.0056)
    Batch Time 17.9030 (0.1905)
    Learning Rate 1e-06
    Accuracy 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591
    Precision 0.7941 0.6667 0.4884 0.8288 0.7002 0.6732 0.7216
    Recall 0.7477 0.4706 0.3987 0.9180 0.6532 0.6438 0.6988
    F1 0.7702 0.5517 0.4390 0.8712 0.6759 0.6581 0.7100
Acc_avg 0.7591 Prec_avg 0.6962 Recall_avg 0.6473 F1_avg 0.6680
    Total Loss 1.8988 Global Cls Loss 0.9544 Local Cls Loss 0.9444 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0186 (0.0037)
    Batch Time 0.7817 (0.1563)
    Learning Rate 1e-06
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.0000 0.0000 0.0000 0.2206 0.0000 0.0000 0.2407
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.3939
    F1 0.0000 0.0000 0.0000 0.3261 0.0000 0.0000 0.2989
Acc_avg 0.2171 Prec_avg 0.0659 Recall_avg 0.1456 F1_avg 0.0893
    Total Loss 6.5513 Global Cls Loss 3.3053 Local Cls Loss 3.2460 AFN Loss 0.0000

    [Train]: 
    Epoch 46
    Data Time 2.0970 (0.0056)
    Batch Time 123.4506 (0.3301)
    Learning Rate 1e-06
    Accuracy 0.9696 0.9696 0.9696 0.9696 0.9696 0.9696 0.9696
    Precision 0.9665 0.9647 0.9592 0.9856 0.9592 0.9661 0.9532
    Recall 0.9642 0.9389 0.9229 0.9864 0.9597 0.9618 0.9667
    F1 0.9654 0.9516 0.9407 0.9860 0.9594 0.9639 0.9599
    Acc_avg 0.9696 Prec_avg 0.9649 Recall_avg 0.9572 F1_avg 0.9610
    Total Loss 0.1854 Global Cls Loss 0.0926 Local Cls Loss 0.0928 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4186 (0.0045)
    Batch Time 18.0570 (0.1921)
    Learning Rate 1e-06
    Accuracy 0.7611 0.7611 0.7611 0.7611 0.7611 0.7611 0.7611
    Precision 0.8000 0.6471 0.4914 0.8328 0.6995 0.6908 0.7141
    Recall 0.7508 0.4853 0.3608 0.9189 0.6510 0.6562 0.7108
    F1 0.7746 0.5546 0.4161 0.8737 0.6744 0.6731 0.7125
Acc_avg 0.7611 Prec_avg 0.6965 Recall_avg 0.6477 F1_avg 0.6684
    Total Loss 1.9175 Global Cls Loss 0.9637 Local Cls Loss 0.9538 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0220 (0.0044)
    Batch Time 0.8055 (0.1611)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2353 0.0000 0.0000 0.2407
    Recall 0.0000 0.0000 0.0000 0.6667 0.0000 0.0000 0.3939
    F1 0.0000 0.0000 0.0000 0.3478 0.0000 0.0000 0.2989
Acc_avg 0.2248 Prec_avg 0.0680 Recall_avg 0.1515 F1_avg 0.0924
    Total Loss 6.4431 Global Cls Loss 3.2500 Local Cls Loss 3.1930 AFN Loss 0.0000

    [Train]: 
    Epoch 47
    Data Time 2.2209 (0.0059)
    Batch Time 122.7942 (0.3283)
    Learning Rate 1e-06
    Accuracy 0.9714 0.9714 0.9714 0.9714 0.9714 0.9714 0.9714
    Precision 0.9770 0.9838 0.9444 0.9843 0.9622 0.9750 0.9567
    Recall 0.9770 0.9275 0.9299 0.9843 0.9597 0.9736 0.9691
    F1 0.9770 0.9548 0.9371 0.9843 0.9610 0.9743 0.9629
    Acc_avg 0.9714 Prec_avg 0.9691 Recall_avg 0.9601 F1_avg 0.9645
    Total Loss 0.1791 Global Cls Loss 0.0892 Local Cls Loss 0.0899 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5240 (0.0056)
    Batch Time 18.0391 (0.1919)
    Learning Rate 1e-06
    Accuracy 0.7568 0.7568 0.7568 0.7568 0.7568 0.7568 0.7568
    Precision 0.7802 0.6226 0.4359 0.8703 0.6812 0.6446 0.7068
    Recall 0.7754 0.4853 0.4304 0.8822 0.6644 0.6687 0.7154
    F1 0.7778 0.5455 0.4331 0.8762 0.6727 0.6564 0.7111
Acc_avg 0.7568 Prec_avg 0.6774 Recall_avg 0.6603 F1_avg 0.6675
    Total Loss 1.8702 Global Cls Loss 0.9398 Local Cls Loss 0.9304 AFN Loss 0.0000
Recall Better than Best Recall
[Save] Best Recall: 0.6603.

    Test Target: 
    Data Time 0.0200 (0.0040)
    Batch Time 0.8084 (0.1617)
    Learning Rate 1e-06
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2955 0.0000 0.0000 0.2456
    Recall 0.0000 0.0000 0.0000 0.5417 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3824 0.0000 0.0000 0.3111
Acc_avg 0.2093 Prec_avg 0.0773 Recall_avg 0.1380 F1_avg 0.0991
    Total Loss 6.2028 Global Cls Loss 3.1285 Local Cls Loss 3.0743 AFN Loss 0.0000

    [Train]: 
    Epoch 48
    Data Time 2.1849 (0.0058)
    Batch Time 123.3190 (0.3297)
    Learning Rate 1e-06
    Accuracy 0.9706 0.9706 0.9706 0.9706 0.9706 0.9706 0.9706
    Precision 0.9705 0.9606 0.9621 0.9827 0.9586 0.9680 0.9608
    Recall 0.9674 0.9313 0.9257 0.9872 0.9586 0.9751 0.9655
    F1 0.9689 0.9457 0.9435 0.9849 0.9586 0.9715 0.9632
    Acc_avg 0.9706 Prec_avg 0.9662 Recall_avg 0.9587 F1_avg 0.9623
    Total Loss 0.1836 Global Cls Loss 0.0916 Local Cls Loss 0.0920 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4671 (0.0050)
    Batch Time 18.1669 (0.1933)
    Learning Rate 1e-06
    Accuracy 0.7588 0.7588 0.7588 0.7588 0.7588 0.7588 0.7588
    Precision 0.7785 0.6296 0.4597 0.8723 0.6836 0.6733 0.6884
    Recall 0.7785 0.5000 0.3608 0.8804 0.6913 0.6312 0.7319
    F1 0.7785 0.5574 0.4043 0.8763 0.6874 0.6516 0.7095
Acc_avg 0.7588 Prec_avg 0.6836 Recall_avg 0.6534 F1_avg 0.6664
    Total Loss 1.8675 Global Cls Loss 0.9382 Local Cls Loss 0.9293 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0212 (0.0042)
    Batch Time 0.7960 (0.1592)
    Learning Rate 1e-06
    Accuracy 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016
    Precision 0.0000 0.0000 0.0000 0.2927 0.0000 0.0000 0.2333
    Recall 0.0000 0.0000 0.0000 0.5000 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3692 0.0000 0.0000 0.3011
Acc_avg 0.2016 Prec_avg 0.0751 Recall_avg 0.1320 F1_avg 0.0958
    Total Loss 6.0658 Global Cls Loss 3.0576 Local Cls Loss 3.0082 AFN Loss 0.0000

    [Train]: 
    Epoch 49
    Data Time 2.2560 (0.0060)
    Batch Time 124.0171 (0.3316)
    Learning Rate 1e-06
    Accuracy 0.9698 0.9698 0.9698 0.9698 0.9698 0.9698 0.9698
    Precision 0.9808 0.9760 0.9525 0.9830 0.9567 0.9592 0.9564
    Recall 0.9754 0.9313 0.9298 0.9851 0.9607 0.9663 0.9614
    F1 0.9781 0.9531 0.9410 0.9841 0.9587 0.9627 0.9589
    Acc_avg 0.9698 Prec_avg 0.9664 Recall_avg 0.9586 F1_avg 0.9624
    Total Loss 0.1831 Global Cls Loss 0.0913 Local Cls Loss 0.0918 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5122 (0.0054)
    Batch Time 17.8306 (0.1897)
    Learning Rate 1e-06
    Accuracy 0.7588 0.7588 0.7588 0.7588 0.7588 0.7588 0.7588
    Precision 0.7910 0.6400 0.4565 0.8583 0.7066 0.6584 0.6944
    Recall 0.7569 0.4706 0.3987 0.8898 0.6465 0.6625 0.7425
    F1 0.7736 0.5424 0.4257 0.8738 0.6752 0.6604 0.7176
Acc_avg 0.7588 Prec_avg 0.6865 Recall_avg 0.6525 F1_avg 0.6670
    Total Loss 1.8752 Global Cls Loss 0.9421 Local Cls Loss 0.9331 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0178 (0.0036)
    Batch Time 0.7804 (0.1561)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2632 0.0000 0.0000 0.2500
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3704 0.0000 0.0000 0.3146
Acc_avg 0.2248 Prec_avg 0.0733 Recall_avg 0.1499 F1_avg 0.0979
    Total Loss 6.1449 Global Cls Loss 3.0984 Local Cls Loss 3.0465 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 81.356774s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.525936s

    [Train]: 
    Epoch 50
    Data Time 2.5779 (0.0069)
    Batch Time 123.0550 (0.3290)
    Learning Rate 1e-06
    Accuracy 0.9703 0.9703 0.9703 0.9703 0.9703 0.9703 0.9703
    Precision 0.9704 0.9600 0.9454 0.9808 0.9673 0.9706 0.9606
    Recall 0.9635 0.9160 0.9229 0.9870 0.9581 0.9706 0.9708
    F1 0.9669 0.9375 0.9340 0.9839 0.9627 0.9706 0.9657
    Acc_avg 0.9703 Prec_avg 0.9650 Recall_avg 0.9556 F1_avg 0.9602
    Total Loss 0.1824 Global Cls Loss 0.0908 Local Cls Loss 0.0915 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.3949 (0.0042)
    Batch Time 17.9109 (0.1905)
    Learning Rate 1e-06
    Accuracy 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591
    Precision 0.7674 0.6275 0.4715 0.8648 0.6871 0.6774 0.6952
    Recall 0.7815 0.4706 0.3671 0.8907 0.6532 0.6562 0.7349
    F1 0.7744 0.5378 0.4128 0.8776 0.6697 0.6667 0.7145
Acc_avg 0.7591 Prec_avg 0.6844 Recall_avg 0.6506 F1_avg 0.6648
    Total Loss 1.8633 Global Cls Loss 0.9364 Local Cls Loss 0.9269 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0221 (0.0044)
    Batch Time 0.8054 (0.1611)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.3333 0.0000 0.0000 0.2692 0.0000 0.0000 0.2642
    Recall 0.0476 0.0000 0.0000 0.5833 0.0000 0.0000 0.4242
    F1 0.0833 0.0000 0.0000 0.3684 0.0000 0.0000 0.3256
Acc_avg 0.2248 Prec_avg 0.1238 Recall_avg 0.1507 F1_avg 0.1110
    Total Loss 6.0945 Global Cls Loss 3.0699 Local Cls Loss 3.0246 AFN Loss 0.0000

    [Train]: 
    Epoch 51
    Data Time 2.4804 (0.0066)
    Batch Time 123.5409 (0.3303)
    Learning Rate 1e-06
    Accuracy 0.9708 0.9708 0.9708 0.9708 0.9708 0.9708 0.9708
    Precision 0.9736 0.9614 0.9336 0.9828 0.9649 0.9705 0.9625
    Recall 0.9682 0.9540 0.9271 0.9836 0.9623 0.9648 0.9700
    F1 0.9709 0.9577 0.9303 0.9832 0.9636 0.9676 0.9662
    Acc_avg 0.9708 Prec_avg 0.9642 Recall_avg 0.9614 F1_avg 0.9628
    Total Loss 0.1805 Global Cls Loss 0.0899 Local Cls Loss 0.0906 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4620 (0.0049)
    Batch Time 18.1956 (0.1936)
    Learning Rate 1e-06
    Accuracy 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591 0.7591
    Precision 0.7726 0.6111 0.4839 0.8527 0.6789 0.6522 0.7191
    Recall 0.7631 0.4853 0.3797 0.9044 0.6622 0.6562 0.7093
    F1 0.7678 0.5410 0.4255 0.8777 0.6704 0.6542 0.7142
Acc_avg 0.7591 Prec_avg 0.6815 Recall_avg 0.6515 F1_avg 0.6644
    Total Loss 1.8807 Global Cls Loss 0.9453 Local Cls Loss 0.9354 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0202 (0.0040)
    Batch Time 0.7850 (0.1570)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.0000 0.0000 0.0000 0.2500 0.0000 0.0000 0.2593
    Recall 0.0000 0.0000 0.0000 0.6250 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3571 0.0000 0.0000 0.3218
Acc_avg 0.2248 Prec_avg 0.0728 Recall_avg 0.1499 F1_avg 0.0970
    Total Loss 6.2523 Global Cls Loss 3.1509 Local Cls Loss 3.1015 AFN Loss 0.0000

    [Train]: 
    Epoch 52
    Data Time 2.2895 (0.0061)
    Batch Time 122.7841 (0.3283)
    Learning Rate 1e-06
    Accuracy 0.9718 0.9718 0.9718 0.9718 0.9718 0.9718 0.9718
    Precision 0.9777 0.9689 0.9560 0.9847 0.9653 0.9628 0.9567
    Recall 0.9770 0.9504 0.9453 0.9858 0.9592 0.9487 0.9688
    F1 0.9774 0.9595 0.9506 0.9852 0.9622 0.9557 0.9627
    Acc_avg 0.9718 Prec_avg 0.9675 Recall_avg 0.9621 F1_avg 0.9648
    Total Loss 0.1731 Global Cls Loss 0.0862 Local Cls Loss 0.0869 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4733 (0.0050)
    Batch Time 18.0028 (0.1915)
    Learning Rate 1e-06
    Accuracy 0.7564 0.7564 0.7564 0.7564 0.7564 0.7564 0.7564
    Precision 0.7866 0.6531 0.4306 0.8740 0.6943 0.6710 0.6798
    Recall 0.7600 0.4706 0.3924 0.8770 0.6555 0.6500 0.7515
    F1 0.7731 0.5470 0.4106 0.8755 0.6743 0.6603 0.7139
Acc_avg 0.7564 Prec_avg 0.6842 Recall_avg 0.6510 F1_avg 0.6650
    Total Loss 1.8764 Global Cls Loss 0.9430 Local Cls Loss 0.9334 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0207 (0.0041)
    Batch Time 0.8246 (0.1649)
    Learning Rate 1e-06
    Accuracy 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938 0.1938
    Precision 0.0000 0.0000 0.0000 0.2292 0.0000 0.0000 0.2222
    Recall 0.0000 0.0000 0.0000 0.4583 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3056 0.0000 0.0000 0.2917
Acc_avg 0.1938 Prec_avg 0.0645 Recall_avg 0.1261 F1_avg 0.0853
    Total Loss 5.9191 Global Cls Loss 2.9791 Local Cls Loss 2.9400 AFN Loss 0.0000

    [Train]: 
    Epoch 53
    Data Time 2.2924 (0.0061)
    Batch Time 123.9216 (0.3313)
    Learning Rate 1e-06
    Accuracy 0.9700 0.9700 0.9700 0.9700 0.9700 0.9700 0.9700
    Precision 0.9712 0.9803 0.9480 0.9808 0.9654 0.9793 0.9549
    Recall 0.9658 0.9504 0.9201 0.9872 0.9618 0.9692 0.9623
    F1 0.9685 0.9651 0.9338 0.9840 0.9636 0.9742 0.9586
    Acc_avg 0.9700 Prec_avg 0.9686 Recall_avg 0.9595 F1_avg 0.9640
    Total Loss 0.1796 Global Cls Loss 0.0893 Local Cls Loss 0.0903 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.3940 (0.0042)
    Batch Time 17.8442 (0.1898)
    Learning Rate 1e-06
    Accuracy 0.7624 0.7624 0.7624 0.7624 0.7624 0.7624 0.7624
    Precision 0.7761 0.6182 0.5126 0.8508 0.6822 0.6774 0.7192
    Recall 0.7785 0.5000 0.3861 0.9061 0.6868 0.6562 0.6943
    F1 0.7773 0.5528 0.4404 0.8776 0.6845 0.6667 0.7065
Acc_avg 0.7624 Prec_avg 0.6909 Recall_avg 0.6583 F1_avg 0.6723
    Total Loss 1.8829 Global Cls Loss 0.9464 Local Cls Loss 0.9365 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0220 (0.0044)
    Batch Time 0.7956 (0.1591)
    Learning Rate 1e-06
    Accuracy 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403 0.2403
    Precision 0.5000 0.0000 0.0000 0.2830 0.0000 0.0000 0.2800
    Recall 0.0952 0.0000 0.0000 0.6250 0.0000 0.0000 0.4242
    F1 0.1600 0.0000 0.0000 0.3896 0.0000 0.0000 0.3373
Acc_avg 0.2403 Prec_avg 0.1519 Recall_avg 0.1635 F1_avg 0.1267
    Total Loss 6.2974 Global Cls Loss 3.1723 Local Cls Loss 3.1251 AFN Loss 0.0000

    [Train]: 
    Epoch 54
    Data Time 2.3928 (0.0064)
    Batch Time 123.9430 (0.3314)
    Learning Rate 1e-06
    Accuracy 0.9728 0.9728 0.9728 0.9728 0.9728 0.9728 0.9728
    Precision 0.9791 0.9767 0.9378 0.9858 0.9659 0.9808 0.9578
    Recall 0.9658 0.9618 0.9312 0.9887 0.9629 0.9736 0.9667
    F1 0.9724 0.9692 0.9345 0.9873 0.9644 0.9772 0.9622
    Acc_avg 0.9728 Prec_avg 0.9691 Recall_avg 0.9644 F1_avg 0.9667
    Total Loss 0.1741 Global Cls Loss 0.0868 Local Cls Loss 0.0873 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4657 (0.0050)
    Batch Time 18.2816 (0.1945)
    Learning Rate 1e-06
    Accuracy 0.7581 0.7581 0.7581 0.7581 0.7581 0.7581 0.7581
    Precision 0.8020 0.6471 0.4453 0.8649 0.6912 0.6731 0.6872
    Recall 0.7477 0.4853 0.3861 0.8856 0.6711 0.6562 0.7380
    F1 0.7739 0.5546 0.4136 0.8751 0.6810 0.6646 0.7117
Acc_avg 0.7581 Prec_avg 0.6872 Recall_avg 0.6529 F1_avg 0.6678
    Total Loss 1.8814 Global Cls Loss 0.9456 Local Cls Loss 0.9357 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0201 (0.0040)
    Batch Time 0.8040 (0.1608)
    Learning Rate 1e-06
    Accuracy 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016 0.2016
    Precision 0.2000 0.0000 0.0000 0.2500 0.0000 0.0000 0.2258
    Recall 0.0476 0.0000 0.0000 0.4583 0.0000 0.0000 0.4242
    F1 0.0769 0.0000 0.0000 0.3235 0.0000 0.0000 0.2947
Acc_avg 0.2016 Prec_avg 0.0965 Recall_avg 0.1329 F1_avg 0.0993
    Total Loss 5.9569 Global Cls Loss 2.9992 Local Cls Loss 2.9577 AFN Loss 0.0000

    [Train]: 
    Epoch 55
    Data Time 2.5281 (0.0068)
    Batch Time 125.0170 (0.3343)
    Learning Rate 1e-06
    Accuracy 0.9728 0.9728 0.9728 0.9728 0.9728 0.9728 0.9728
    Precision 0.9746 0.9618 0.9403 0.9854 0.9648 0.9793 0.9628
    Recall 0.9762 0.9618 0.9271 0.9885 0.9592 0.9692 0.9671
    F1 0.9754 0.9618 0.9336 0.9869 0.9620 0.9742 0.9650
    Acc_avg 0.9728 Prec_avg 0.9670 Recall_avg 0.9642 F1_avg 0.9656
    Total Loss 0.1744 Global Cls Loss 0.0869 Local Cls Loss 0.0875 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4555 (0.0048)
    Batch Time 18.1356 (0.1929)
    Learning Rate 1e-06
    Accuracy 0.7594 0.7594 0.7594 0.7594 0.7594 0.7594 0.7594
    Precision 0.8059 0.6735 0.4444 0.8646 0.6652 0.6646 0.7111
    Recall 0.7538 0.4853 0.4051 0.8890 0.6935 0.6562 0.7154
    F1 0.7790 0.5641 0.4238 0.8766 0.6791 0.6604 0.7132
Acc_avg 0.7594 Prec_avg 0.6899 Recall_avg 0.6569 F1_avg 0.6709
    Total Loss 1.8832 Global Cls Loss 0.9467 Local Cls Loss 0.9365 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0210 (0.0042)
    Batch Time 0.7899 (0.1580)
    Learning Rate 1e-06
    Accuracy 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171 0.2171
    Precision 0.0000 0.0000 0.0000 0.2692 0.0000 0.0000 0.2500
    Recall 0.0000 0.0000 0.0000 0.5833 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3684 0.0000 0.0000 0.3146
Acc_avg 0.2171 Prec_avg 0.0742 Recall_avg 0.1439 F1_avg 0.0976
    Total Loss 6.0474 Global Cls Loss 3.0445 Local Cls Loss 3.0029 AFN Loss 0.0000

    [Train]: 
    Epoch 56
    Data Time 2.3667 (0.0063)
    Batch Time 124.3695 (0.3325)
    Learning Rate 1e-06
    Accuracy 0.9721 0.9721 0.9721 0.9721 0.9721 0.9721 0.9721
    Precision 0.9739 0.9533 0.9472 0.9837 0.9624 0.9775 0.9640
    Recall 0.9770 0.9351 0.9313 0.9868 0.9644 0.9575 0.9671
    F1 0.9754 0.9441 0.9392 0.9852 0.9634 0.9674 0.9656
    Acc_avg 0.9721 Prec_avg 0.9660 Recall_avg 0.9599 F1_avg 0.9629
    Total Loss 0.1722 Global Cls Loss 0.0858 Local Cls Loss 0.0864 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4260 (0.0045)
    Batch Time 18.3612 (0.1953)
    Learning Rate 1e-06
    Accuracy 0.7564 0.7564 0.7564 0.7564 0.7564 0.7564 0.7564
    Precision 0.8081 0.6071 0.4667 0.8434 0.6660 0.6582 0.7256
    Recall 0.7385 0.5000 0.3987 0.9061 0.7047 0.6500 0.6732
    F1 0.7717 0.5484 0.4300 0.8736 0.6848 0.6541 0.6984
Acc_avg 0.7564 Prec_avg 0.6822 Recall_avg 0.6530 F1_avg 0.6659
    Total Loss 1.8997 Global Cls Loss 0.9549 Local Cls Loss 0.9448 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0218 (0.0044)
    Batch Time 0.7818 (0.1564)
    Learning Rate 1e-06
    Accuracy 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326 0.2326
    Precision 0.0000 0.0000 0.0000 0.2807 0.0000 0.0000 0.2642
    Recall 0.0000 0.0000 0.0000 0.6667 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3951 0.0000 0.0000 0.3256
Acc_avg 0.2326 Prec_avg 0.0778 Recall_avg 0.1558 F1_avg 0.1029
    Total Loss 6.2976 Global Cls Loss 3.1732 Local Cls Loss 3.1244 AFN Loss 0.0000

    [Train]: 
    Epoch 57
    Data Time 2.4342 (0.0065)
    Batch Time 124.0487 (0.3317)
    Learning Rate 1e-06
    Accuracy 0.9746 0.9746 0.9746 0.9746 0.9746 0.9746 0.9746
    Precision 0.9716 0.9756 0.9594 0.9858 0.9707 0.9693 0.9634
    Recall 0.9793 0.9160 0.9285 0.9883 0.9676 0.9721 0.9716
    F1 0.9754 0.9449 0.9437 0.9871 0.9692 0.9707 0.9675
    Acc_avg 0.9746 Prec_avg 0.9708 Recall_avg 0.9605 F1_avg 0.9655
    Total Loss 0.1675 Global Cls Loss 0.0833 Local Cls Loss 0.0842 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4440 (0.0047)
    Batch Time 17.9411 (0.1909)
    Learning Rate 1e-06
    Accuracy 0.7551 0.7551 0.7551 0.7551 0.7551 0.7551 0.7551
    Precision 0.7660 0.6296 0.4094 0.8768 0.6858 0.6407 0.6996
    Recall 0.7754 0.5000 0.3861 0.8753 0.6689 0.6687 0.7259
    F1 0.7706 0.5574 0.3974 0.8761 0.6772 0.6544 0.7125
Acc_avg 0.7551 Prec_avg 0.6726 Recall_avg 0.6572 F1_avg 0.6637
    Total Loss 1.8752 Global Cls Loss 0.9427 Local Cls Loss 0.9325 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0218 (0.0044)
    Batch Time 0.8027 (0.1605)
    Learning Rate 1e-06
    Accuracy 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705
    Precision 0.0000 0.0000 0.0000 0.2581 0.0000 0.0000 0.2500
    Recall 0.0000 0.0000 0.0000 0.3333 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.2909 0.0000 0.0000 0.3146
Acc_avg 0.1705 Prec_avg 0.0726 Recall_avg 0.1082 F1_avg 0.0865
    Total Loss 6.0584 Global Cls Loss 3.0528 Local Cls Loss 3.0057 AFN Loss 0.0000

    [Train]: 
    Epoch 58
    Data Time 2.4751 (0.0066)
    Batch Time 124.4667 (0.3328)
    Learning Rate 1e-06
    Accuracy 0.9739 0.9739 0.9739 0.9739 0.9739 0.9739 0.9739
    Precision 0.9699 0.9653 0.9641 0.9862 0.9696 0.9705 0.9606
    Recall 0.9730 0.9542 0.9411 0.9877 0.9649 0.9633 0.9696
    F1 0.9715 0.9597 0.9524 0.9869 0.9673 0.9669 0.9651
    Acc_avg 0.9739 Prec_avg 0.9694 Recall_avg 0.9648 F1_avg 0.9671
    Total Loss 0.1658 Global Cls Loss 0.0825 Local Cls Loss 0.0833 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.5371 (0.0057)
    Batch Time 18.4909 (0.1967)
    Learning Rate 1e-06
    Accuracy 0.7511 0.7511 0.7511 0.7511 0.7511 0.7511 0.7511
    Precision 0.7903 0.6200 0.4214 0.8869 0.6522 0.6541 0.6789
    Recall 0.7538 0.4559 0.3734 0.8642 0.7047 0.6500 0.7259
    F1 0.7717 0.5254 0.3960 0.8754 0.6774 0.6520 0.7016
Acc_avg 0.7511 Prec_avg 0.6720 Recall_avg 0.6469 F1_avg 0.6571
    Total Loss 1.9011 Global Cls Loss 0.9558 Local Cls Loss 0.9453 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0217 (0.0043)
    Batch Time 0.7855 (0.1571)
    Learning Rate 1e-06
    Accuracy 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705 0.1705
    Precision 0.0000 0.0000 0.0000 0.2609 0.0645 0.0000 0.2258
    Recall 0.0000 0.0000 0.0000 0.2500 0.1667 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.2553 0.0930 0.0000 0.2947
Acc_avg 0.1705 Prec_avg 0.0787 Recall_avg 0.1201 F1_avg 0.0919
    Total Loss 6.0179 Global Cls Loss 3.0351 Local Cls Loss 2.9828 AFN Loss 0.0000

    [Train]: 
    Epoch 59
    Data Time 2.2920 (0.0061)
    Batch Time 123.7014 (0.3308)
    Learning Rate 1e-06
    Accuracy 0.9743 0.9743 0.9743 0.9743 0.9743 0.9743 0.9743
    Precision 0.9729 0.9612 0.9612 0.9848 0.9697 0.9793 0.9624
    Recall 0.9706 0.9466 0.9383 0.9898 0.9676 0.9692 0.9667
    F1 0.9718 0.9538 0.9496 0.9873 0.9687 0.9742 0.9646
    Acc_avg 0.9743 Prec_avg 0.9702 Recall_avg 0.9641 F1_avg 0.9671
    Total Loss 0.1652 Global Cls Loss 0.0823 Local Cls Loss 0.0830 AFN Loss 0.0000
Starting Source Data Testing

    Test Source: 
    Data Time 0.4214 (0.0045)
    Batch Time 17.8944 (0.1904)
    Learning Rate 1e-06
    Accuracy 0.7531 0.7531 0.7531 0.7531 0.7531 0.7531 0.7531
    Precision 0.8027 0.6667 0.4296 0.8607 0.6741 0.7000 0.6811
    Recall 0.7262 0.4706 0.3861 0.8864 0.6756 0.6125 0.7334
    F1 0.7625 0.5517 0.4067 0.8734 0.6749 0.6533 0.7063
Acc_avg 0.7531 Prec_avg 0.6878 Recall_avg 0.6415 F1_avg 0.6613
    Total Loss 1.8909 Global Cls Loss 0.9507 Local Cls Loss 0.9402 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0208 (0.0042)
    Batch Time 0.7841 (0.1568)
    Learning Rate 1e-06
    Accuracy 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093 0.2093
    Precision 0.0000 0.0000 0.0000 0.2766 0.0000 0.0000 0.2333
    Recall 0.0000 0.0000 0.0000 0.5417 0.0000 0.0000 0.4242
    F1 0.0000 0.0000 0.0000 0.3662 0.0000 0.0000 0.3011
Acc_avg 0.2093 Prec_avg 0.0728 Recall_avg 0.1380 F1_avg 0.0953
    Total Loss 6.0983 Global Cls Loss 3.0690 Local Cls Loss 3.0293 AFN Loss 0.0000
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 80.511644s
 train target dataset qty: 1128
 train target dataset dist: 228, 66, 162, 183, 72, 123, 294
[Target Domain] Cost time : 13.534108s

    [Train]: 
    Epoch 60
    Data Time 2.4689 (0.0066)
    Batch Time 123.8203 (0.3311)
    Learning Rate 1e-06
    Accuracy 0.9743 0.9743 0.9743 0.9743 0.9743 0.9743 0.9743
    Precision 0.9730 0.9575 0.9463 0.9853 0.9682 0.9733 0.9685
    Recall 0.9738 0.9466 0.9383 0.9853 0.9708 0.9633 0.9724
    F1 0.9734 0.9520 0.9423 0.9853 0.9695 0.9683 0.9704
    Acc_avg 0.9743 Prec_avg 0.9675 Recall_avg 0.9644 F1_avg 0.9659
    Total Loss 0.1660 Global Cls Loss 0.0827 Local Cls Loss 0.0833 AFN Loss 0.0000
TrainOnSourceDomain.py:126: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
Starting Source Data Testing

    Test Source: 
    Data Time 0.4316 (0.0046)
    Batch Time 18.2140 (0.1938)
    Learning Rate 1e-06
    Accuracy 0.7594 0.7594 0.7594 0.7594 0.7594 0.7594 0.7594
    Precision 0.7930 0.6538 0.4692 0.8609 0.6725 0.6867 0.7001
    Recall 0.7662 0.5000 0.3861 0.8933 0.6846 0.6438 0.7139
    F1 0.7793 0.5667 0.4236 0.8768 0.6785 0.6645 0.7069
Acc_avg 0.7594 Prec_avg 0.6909 Recall_avg 0.6554 F1_avg 0.6709
    Total Loss 1.8845 Global Cls Loss 0.9477 Local Cls Loss 0.9368 AFN Loss 0.0000

    Test Target: 
    Data Time 0.0250 (0.0050)
    Batch Time 0.8146 (0.1629)
    Learning Rate 1e-06
    Accuracy 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248 0.2248
    Precision 0.3333 0.0000 0.0000 0.2917 0.0000 0.0000 0.2642
    Recall 0.0476 0.0000 0.0000 0.5833 0.0000 0.0000 0.4242
    F1 0.0833 0.0000 0.0000 0.3889 0.0000 0.0000 0.3256
Acc_avg 0.2248 Prec_avg 0.1270 Recall_avg 0.1507 F1_avg 0.1140
    Total Loss 6.0178 Global Cls Loss 3.0253 Local Cls Loss 2.9925 AFN Loss 0.0000
