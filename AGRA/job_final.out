Log Name: ResNet50_CropNet_GCNwithIntraMatrixAndInterMatrix_useCluster_withoutAFN_transferToTargetDomain_RAFtoAFED
Output Path: .
Backbone: ResNet50
Resume Model: ResNet50_CropNet_GCNwithIntraMatrixAndInterMatrix_useCluster_withoutAFN_trainOnSourceDomain_RAFtoAFED.pkl
CUDA_VISIBLE_DEVICES: 1
================================================
Use 112 * 112 Image
SourceDataset: RAF
TargetDataset: AFED
Train Batch Size: 32
Test Batch Size: 32
================================================
Train Epoch: 60
Learning Rate: 0.000100
Momentum: 0.900000
Weight Decay: 0.000100
Use DAN Loss: CDAN-E
Learning Rate(Adversarial Network): 0.001000
================================================
Number of classes : 7
Use global feature and local feature.
Use Intra GCN.
Use Inter GCN.
Use Mean in Cluster.
================================================
Building Train and Test Dataloader...
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
 train target dataset qty: 32757
 train target dataset dist: 2303, 1053, 2158, 15871, 1898, 2262, 7212
 test source dataset qty: 2993
 test source dataset dist: 325, 68, 158, 1171, 447, 160, 664
 test target dataset qty: 16380
 test target dataset dist: 1152, 526, 1080, 7936, 949, 1131, 3606
Done!
================================================
Building Model...
Resume Model: ResNet50_CropNet_GCNwithIntraMatrixAndInterMatrix_useCluster_withoutAFN_trainOnSourceDomain_RAFtoAFED.pkl
Done!
================================================
Building Adversarial Network...
Done!
================================================
Building Optimizer...
Done!
================================================
Initialize Mean in Cluster....
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 77.901977s
 train target dataset qty: 32757
 train target dataset dist: 2303, 1053, 2158, 15871, 1898, 2262, 7212
2021-04-23 20:36:15.638321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
[Target Domain] Cost time : 223.805262s
Done!
================================================
Run Experiment...
TransferToTargetDomain.py:172: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():

    [Tain]: 
    Epoch 1
    Data Time 5.8915 (0.0058)
    Batch Time 638.3913 (0.6240)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.8681 0.8681 0.8681 0.8681 0.8681 0.8681 0.8681
    Precision 0.8781 0.8090 0.7582 0.9258 0.8241 0.8572 0.8235
    Recall 0.8648 0.7147 0.6857 0.9396 0.8242 0.8277 0.8474
    F1 0.8714 0.7589 0.7202 0.9326 0.8241 0.8422 0.8353
    AdversarialNet Acc 0.7329 Acc_avg 0.8681 Prec_avg 0.8394 Recall_avg 0.8149 F1_avg 0.8264
    Total Loss 1.2685 Global Cls Loss 0.3680 Local Cls Loss 0.3668 AFN Loss 0.0000 DAN Loss 0.5337

    [Test (Source Domain)]: 
    Data Time 0.2563 (0.0027)
    Batch Time 19.7705 (0.2103)
    Accuracy 0.6776 0.6776 0.6776 0.6776 0.6776 0.6776 0.6776
    Precision 0.9276 0.6410 0.3358 0.7343 0.8311 0.6620 0.5752
    Recall 0.4338 0.3676 0.2911 0.9180 0.2752 0.5875 0.7892
    F1 0.5912 0.4673 0.3119 0.8159 0.4134 0.6225 0.6654
    Acc_avg 0.6776 Prec_avg 0.6724 Recall_avg 0.5232 F1_avg 0.5554
    Loss 1.3385

    [Test (Target Domain)]: 
    Data Time 1.3846 (0.0027)
    Batch Time 94.4780 (0.1845)
    Accuracy 0.6885 0.6885 0.6885 0.6885 0.6885 0.6885 0.6885
    Precision 0.9659 0.2308 0.5781 0.7311 0.7333 0.9040 0.5942
    Recall 0.0738 0.0057 0.1611 0.9783 0.0348 0.1583 0.8430
    F1 0.1371 0.0111 0.2520 0.8369 0.0664 0.2694 0.6971
    Acc_avg 0.6885 Prec_avg 0.6768 Recall_avg 0.3221 F1_avg 0.3243
    Loss 1.1180
[Save] Best Recall: 0.3221.
[Save] Best Accuracy: 0.6885.

    [Tain]: 
    Epoch 2
    Data Time 5.6796 (0.0056)
    Batch Time 648.6412 (0.6341)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.8819 0.8819 0.8819 0.8819 0.8819 0.8819 0.8819
    Precision 0.8900 0.8172 0.7886 0.9292 0.8527 0.8821 0.8396
    Recall 0.8773 0.7451 0.7022 0.9465 0.8376 0.8392 0.8728
    F1 0.8836 0.7795 0.7429 0.9378 0.8451 0.8601 0.8559
    AdversarialNet Acc 0.7115 Acc_avg 0.8819 Prec_avg 0.8570 Recall_avg 0.8315 F1_avg 0.8435
    Total Loss 1.2358 Global Cls Loss 0.3349 Local Cls Loss 0.3327 AFN Loss 0.0000 DAN Loss 0.5682

    [Test (Source Domain)]: 
    Data Time 0.3041 (0.0032)
    Batch Time 17.6322 (0.1876)
    Accuracy 0.6873 0.6873 0.6873 0.6873 0.6873 0.6873 0.6873
    Precision 0.8735 0.5333 0.3881 0.7585 0.8827 0.8553 0.5581
    Recall 0.4462 0.3529 0.3291 0.9146 0.3199 0.4062 0.8389
    F1 0.5906 0.4248 0.3562 0.8293 0.4696 0.5508 0.6703
    Acc_avg 0.6873 Prec_avg 0.6928 Recall_avg 0.5154 F1_avg 0.5559
    Loss 1.5153

    [Test (Target Domain)]: 
    Data Time 1.4404 (0.0028)
    Batch Time 94.8154 (0.1852)
    Accuracy 0.7368 0.7368 0.7368 0.7368 0.7368 0.7368 0.7368
    Precision 0.7944 0.2468 0.5873 0.8202 0.4843 0.9083 0.6227
    Recall 0.2717 0.0361 0.3083 0.9602 0.2919 0.2626 0.8899
    F1 0.4049 0.0630 0.4044 0.8847 0.3642 0.4074 0.7327
    Acc_avg 0.7368 Prec_avg 0.6377 Recall_avg 0.4315 F1_avg 0.4659
    Loss 1.1536
[Save] Best Recall: 0.4315.
[Save] Best Accuracy: 0.7368.

    [Tain]: 
    Epoch 3
    Data Time 5.7951 (0.0057)
    Batch Time 626.8621 (0.6128)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.8938 0.8938 0.8938 0.8938 0.8938 0.8938 0.8938
    Precision 0.9016 0.8433 0.8324 0.9392 0.8558 0.8847 0.8557
    Recall 0.8889 0.7610 0.7714 0.9507 0.8583 0.8531 0.8755
    F1 0.8952 0.8000 0.8007 0.9449 0.8570 0.8686 0.8655
    AdversarialNet Acc 0.6833 Acc_avg 0.8938 Prec_avg 0.8732 Recall_avg 0.8513 F1_avg 0.8617
    Total Loss 1.1965 Global Cls Loss 0.3001 Local Cls Loss 0.2977 AFN Loss 0.0000 DAN Loss 0.5987

    [Test (Source Domain)]: 
    Data Time 0.2646 (0.0028)
    Batch Time 18.1358 (0.1929)
    Accuracy 0.6722 0.6722 0.6722 0.6722 0.6722 0.6722 0.6722
    Precision 0.8897 0.7308 0.3740 0.7476 0.9747 0.7016 0.5486
    Recall 0.3969 0.2794 0.3101 0.9180 0.1723 0.5437 0.8675
    F1 0.5489 0.4043 0.3391 0.8241 0.2928 0.6127 0.6721
    Acc_avg 0.6722 Prec_avg 0.7096 Recall_avg 0.4983 F1_avg 0.5277
    Loss 1.8491

    [Test (Target Domain)]: 
    Data Time 1.3939 (0.0027)
    Batch Time 96.5014 (0.1885)
    Accuracy 0.7480 0.7480 0.7480 0.7480 0.7480 0.7480 0.7480
    Precision 0.8596 0.6000 0.4853 0.8278 0.6278 0.8003 0.6430
    Recall 0.3030 0.0513 0.4574 0.9539 0.1760 0.4925 0.8566
    F1 0.4480 0.0946 0.4709 0.8864 0.2749 0.6097 0.7346
    Acc_avg 0.7480 Prec_avg 0.6920 Recall_avg 0.4701 F1_avg 0.5027
    Loss 1.1552
[Save] Best Recall: 0.4701.
[Save] Best Accuracy: 0.7480.

    [Tain]: 
    Epoch 4
    Data Time 6.4522 (0.0063)
    Batch Time 632.0888 (0.6179)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9101 0.9101 0.9101 0.9101 0.9101 0.9101 0.9101
    Precision 0.9187 0.8924 0.8463 0.9472 0.8746 0.9133 0.8800
    Recall 0.9033 0.7921 0.7961 0.9571 0.8857 0.8971 0.8914
    F1 0.9109 0.8393 0.8204 0.9521 0.8801 0.9051 0.8857
    AdversarialNet Acc 0.7448 Acc_avg 0.9101 Prec_avg 0.8961 Recall_avg 0.8747 F1_avg 0.8848
    Total Loss 1.0522 Global Cls Loss 0.2564 Local Cls Loss 0.2556 AFN Loss 0.0000 DAN Loss 0.5402

    [Test (Source Domain)]: 
    Data Time 0.2692 (0.0029)
    Batch Time 17.9619 (0.1911)
    Accuracy 0.6689 0.6689 0.6689 0.6689 0.6689 0.6689 0.6689
    Precision 0.8966 0.8438 0.4000 0.7807 0.8932 0.8090 0.5041
    Recall 0.4000 0.3971 0.2152 0.8847 0.2058 0.4500 0.9202
    F1 0.5532 0.5400 0.2798 0.8295 0.3345 0.5783 0.6514
    Acc_avg 0.6689 Prec_avg 0.7325 Recall_avg 0.4961 F1_avg 0.5381
    Loss 1.9221

    [Test (Target Domain)]: 
    Data Time 1.3700 (0.0027)
    Batch Time 112.1806 (0.2191)
    Accuracy 0.7112 0.7112 0.7112 0.7112 0.7112 0.7112 0.7112
    Precision 0.7881 0.5526 0.4227 0.8232 0.4628 0.8719 0.5764
    Recall 0.2422 0.0399 0.2935 0.9108 0.2097 0.3431 0.8924
    F1 0.3705 0.0745 0.3464 0.8648 0.2886 0.4924 0.7004
    Acc_avg 0.7112 Prec_avg 0.6425 Recall_avg 0.4188 F1_avg 0.4482
    Loss 1.5067

    [Tain]: 
    Epoch 5
    Data Time 6.2354 (0.0061)
    Batch Time 633.4399 (0.6192)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9115 0.9115 0.9115 0.9115 0.9115 0.9115 0.9115
    Precision 0.9177 0.8782 0.8405 0.9496 0.8796 0.9002 0.8861
    Recall 0.9026 0.8077 0.7953 0.9581 0.8893 0.8852 0.8962
    F1 0.9101 0.8415 0.8172 0.9538 0.8844 0.8926 0.8911
    AdversarialNet Acc 0.6671 Acc_avg 0.9115 Prec_avg 0.8931 Recall_avg 0.8764 F1_avg 0.8844
    Total Loss 1.1217 Global Cls Loss 0.2573 Local Cls Loss 0.2513 AFN Loss 0.0000 DAN Loss 0.6131

    [Test (Source Domain)]: 
    Data Time 0.2647 (0.0028)
    Batch Time 20.5966 (0.2191)
    Accuracy 0.6789 0.6789 0.6789 0.6789 0.6789 0.6789 0.6789
    Precision 0.8723 0.8182 0.3688 0.7720 0.8609 0.7460 0.5393
    Recall 0.5046 0.3971 0.3291 0.8702 0.2215 0.5875 0.8690
    F1 0.6394 0.5347 0.3478 0.8181 0.3523 0.6573 0.6655
    Acc_avg 0.6789 Prec_avg 0.7111 Recall_avg 0.5398 F1_avg 0.5736
    Loss 1.7326

    [Test (Target Domain)]: 
    Data Time 1.3919 (0.0027)
    Batch Time 112.2141 (0.2192)
    Accuracy 0.7426 0.7426 0.7426 0.7426 0.7426 0.7426 0.7426
    Precision 0.7988 0.5510 0.5161 0.8293 0.5426 0.8259 0.6331
    Recall 0.3411 0.0513 0.5185 0.9418 0.2150 0.4111 0.8433
    F1 0.4781 0.0939 0.5173 0.8820 0.3079 0.5490 0.7233
    Acc_avg 0.7426 Prec_avg 0.6710 Recall_avg 0.4746 F1_avg 0.5074
    Loss 1.1897
[Save] Best Recall: 0.4746.

    [Tain]: 
    Epoch 6
    Data Time 5.7643 (0.0056)
    Batch Time 633.6306 (0.6194)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9228 0.9228 0.9228 0.9228 0.9228 0.9228 0.9228
    Precision 0.9258 0.8971 0.8580 0.9560 0.8949 0.9229 0.9003
    Recall 0.9078 0.8520 0.8272 0.9634 0.9051 0.9020 0.9079
    F1 0.9167 0.8739 0.8423 0.9597 0.9000 0.9124 0.9041
    AdversarialNet Acc 0.6863 Acc_avg 0.9228 Prec_avg 0.9079 Recall_avg 0.8951 F1_avg 0.9013
    Total Loss 1.0355 Global Cls Loss 0.2226 Local Cls Loss 0.2194 AFN Loss 0.0000 DAN Loss 0.5935

    [Test (Source Domain)]: 
    Data Time 0.2526 (0.0027)
    Batch Time 17.4255 (0.1854)
    Accuracy 0.6769 0.6769 0.6769 0.6769 0.6769 0.6769 0.6769
    Precision 0.9245 0.7500 0.3942 0.8178 0.9072 0.8485 0.5000
    Recall 0.4523 0.4412 0.3418 0.8625 0.1969 0.5250 0.9232
    F1 0.6074 0.5556 0.3661 0.8396 0.3235 0.6486 0.6487
    Acc_avg 0.6769 Prec_avg 0.7346 Recall_avg 0.5347 F1_avg 0.5699
    Loss 1.9365

    [Test (Target Domain)]: 
    Data Time 1.3662 (0.0027)
    Batch Time 93.6855 (0.1830)
    Accuracy 0.7386 0.7386 0.7386 0.7386 0.7386 0.7386 0.7386
    Precision 0.8044 0.4556 0.4659 0.8736 0.5355 0.8435 0.5867
    Recall 0.3177 0.0779 0.3861 0.9041 0.2223 0.5004 0.9212
    F1 0.4555 0.1331 0.4223 0.8886 0.3142 0.6282 0.7169
    Acc_avg 0.7386 Prec_avg 0.6522 Recall_avg 0.4757 F1_avg 0.5084
    Loss 1.2436
[Save] Best Recall: 0.4757.

    [Tain]: 
    Epoch 7
    Data Time 6.1005 (0.0060)
    Batch Time 654.0606 (0.6394)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9351 0.9351 0.9351 0.9351 0.9351 0.9351 0.9351
    Precision 0.9416 0.9106 0.8820 0.9661 0.9053 0.9278 0.9147
    Recall 0.9329 0.8618 0.8406 0.9701 0.9188 0.9224 0.9204
    F1 0.9372 0.8855 0.8608 0.9681 0.9120 0.9251 0.9176
    AdversarialNet Acc 0.6731 Acc_avg 0.9351 Prec_avg 0.9212 Recall_avg 0.9096 F1_avg 0.9152
    Total Loss 0.9711 Global Cls Loss 0.1844 Local Cls Loss 0.1822 AFN Loss 0.0000 DAN Loss 0.6045

    [Test (Source Domain)]: 
    Data Time 0.2648 (0.0028)
    Batch Time 19.8949 (0.2116)
    Accuracy 0.6806 0.6806 0.6806 0.6806 0.6806 0.6806 0.6806
    Precision 0.8958 0.8929 0.3926 0.7273 0.9605 0.6613 0.5806
    Recall 0.5292 0.3676 0.4051 0.9385 0.1633 0.5125 0.7861
    F1 0.6654 0.5208 0.3988 0.8195 0.2792 0.5775 0.6679
    Acc_avg 0.6806 Prec_avg 0.7302 Recall_avg 0.5289 F1_avg 0.5613
    Loss 2.1613

    [Test (Target Domain)]: 
    Data Time 1.3641 (0.0027)
    Batch Time 93.4262 (0.1825)
    Accuracy 0.7451 0.7451 0.7451 0.7451 0.7451 0.7451 0.7451
    Precision 0.8028 0.5185 0.5063 0.8232 0.5684 0.8099 0.6412
    Recall 0.3924 0.0532 0.4111 0.9384 0.1707 0.4633 0.8727
    F1 0.5271 0.0966 0.4538 0.8770 0.2626 0.5894 0.7393
    Acc_avg 0.7451 Prec_avg 0.6672 Recall_avg 0.4717 F1_avg 0.5065
    Loss 1.3147

    [Tain]: 
    Epoch 8
    Data Time 5.7437 (0.0056)
    Batch Time 646.5176 (0.6320)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9360 0.9360 0.9360 0.9360 0.9360 0.9360 0.9360
    Precision 0.9405 0.8975 0.8810 0.9658 0.9103 0.9256 0.9191
    Recall 0.9227 0.8663 0.8506 0.9691 0.9242 0.9156 0.9266
    F1 0.9315 0.8816 0.8655 0.9674 0.9172 0.9206 0.9228
    AdversarialNet Acc 0.7125 Acc_avg 0.9360 Prec_avg 0.9200 Recall_avg 0.9107 F1_avg 0.9152
    Total Loss 0.9429 Global Cls Loss 0.1888 Local Cls Loss 0.1858 AFN Loss 0.0000 DAN Loss 0.5684

    [Test (Source Domain)]: 
    Data Time 0.2809 (0.0030)
    Batch Time 17.2480 (0.1835)
    Accuracy 0.6786 0.6786 0.6786 0.6786 0.6786 0.6786 0.6786
    Precision 0.8659 0.8148 0.3425 0.7603 0.9429 0.5823 0.5605
    Recall 0.4769 0.3235 0.3165 0.9103 0.2215 0.5750 0.8238
    F1 0.6151 0.4632 0.3289 0.8286 0.3587 0.5786 0.6671
    Acc_avg 0.6786 Prec_avg 0.6956 Recall_avg 0.5211 F1_avg 0.5486
    Loss 2.0450

    [Test (Target Domain)]: 
    Data Time 1.4295 (0.0028)
    Batch Time 93.8220 (0.1832)
    Accuracy 0.7521 0.7521 0.7521 0.7521 0.7521 0.7521 0.7521
    Precision 0.8725 0.5876 0.5414 0.8347 0.6588 0.7877 0.6322
    Recall 0.3385 0.1084 0.4417 0.9422 0.2360 0.5314 0.8580
    F1 0.4878 0.1830 0.4865 0.8852 0.3476 0.6346 0.7280
    Acc_avg 0.7521 Prec_avg 0.7021 Recall_avg 0.4937 F1_avg 0.5361
    Loss 1.1877
[Save] Best Recall: 0.4937.
[Save] Best Accuracy: 0.7521.

    [Tain]: 
    Epoch 9
    Data Time 6.5955 (0.0064)
    Batch Time 670.5841 (0.6555)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9398 0.9398 0.9398 0.9398 0.9398 0.9398 0.9398
    Precision 0.9409 0.9090 0.8983 0.9642 0.9203 0.9463 0.9208
    Recall 0.9352 0.8773 0.8726 0.9680 0.9299 0.9280 0.9253
    F1 0.9380 0.8928 0.8853 0.9661 0.9251 0.9371 0.9230
    AdversarialNet Acc 0.6923 Acc_avg 0.9398 Prec_avg 0.9285 Recall_avg 0.9195 F1_avg 0.9239
    Total Loss 0.9325 Global Cls Loss 0.1733 Local Cls Loss 0.1706 AFN Loss 0.0000 DAN Loss 0.5886

    [Test (Source Domain)]: 
    Data Time 0.2597 (0.0028)
    Batch Time 18.5410 (0.1972)
    Accuracy 0.6863 0.6863 0.6863 0.6863 0.6863 0.6863 0.6863
    Precision 0.9231 0.6486 0.3355 0.7789 0.9437 0.6531 0.5582
    Recall 0.4062 0.3529 0.3291 0.8847 0.2998 0.6000 0.8735
    F1 0.5641 0.4571 0.3323 0.8285 0.4550 0.6254 0.6812
    Acc_avg 0.6863 Prec_avg 0.6916 Recall_avg 0.5352 F1_avg 0.5634
    Loss 1.8484

    [Test (Target Domain)]: 
    Data Time 1.3633 (0.0027)
    Batch Time 93.7601 (0.1831)
    Accuracy 0.7269 0.7269 0.7269 0.7269 0.7269 0.7269 0.7269
    Precision 0.9375 0.6750 0.6118 0.8266 0.7692 0.8680 0.5680
    Recall 0.2214 0.0513 0.3269 0.9275 0.1264 0.3546 0.9401
    F1 0.3581 0.0954 0.4261 0.8742 0.2172 0.5035 0.7082
    Acc_avg 0.7269 Prec_avg 0.7509 Recall_avg 0.4212 F1_avg 0.4547
    Loss 1.3691
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 79.272224s
 train target dataset qty: 32757
 train target dataset dist: 2303, 1053, 2158, 15871, 1898, 2262, 7212
[Target Domain] Cost time : 210.858897s
TransferToTargetDomain.py:172: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():

    [Tain]: 
    Epoch 10
    Data Time 6.0998 (0.0060)
    Batch Time 646.7373 (0.6322)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9263 0.9263 0.9263 0.9263 0.9263 0.9263 0.9263
    Precision 0.9256 0.8987 0.8636 0.9577 0.9083 0.9013 0.9073
    Recall 0.9210 0.8571 0.8367 0.9651 0.8981 0.8959 0.9181
    F1 0.9233 0.8774 0.8500 0.9614 0.9032 0.8986 0.9126
    AdversarialNet Acc 0.7119 Acc_avg 0.9263 Prec_avg 0.9089 Recall_avg 0.8989 F1_avg 0.9038
    Total Loss 0.9998 Global Cls Loss 0.2189 Local Cls Loss 0.2088 AFN Loss 0.0000 DAN Loss 0.5721

    [Test (Source Domain)]: 
    Data Time 0.2527 (0.0027)
    Batch Time 17.5173 (0.1864)
    Accuracy 0.6605 0.6605 0.6605 0.6605 0.6605 0.6605 0.6605
    Precision 0.9286 0.4149 0.4512 0.7044 0.9672 0.5474 0.5959
    Recall 0.3200 0.5735 0.2342 0.9522 0.1320 0.6500 0.7816
    F1 0.4760 0.4815 0.3083 0.8097 0.2323 0.5943 0.6762
    Acc_avg 0.6605 Prec_avg 0.6585 Recall_avg 0.5205 F1_avg 0.5112
    Loss 3.0767

    [Test (Target Domain)]: 
    Data Time 1.3883 (0.0027)
    Batch Time 93.8420 (0.1833)
    Accuracy 0.7579 0.7579 0.7579 0.7579 0.7579 0.7579 0.7579
    Precision 0.9286 0.4437 0.6594 0.8214 0.9655 0.7007 0.6568
    Recall 0.2370 0.1350 0.2528 0.9761 0.0295 0.6852 0.9010
    F1 0.3776 0.2070 0.3655 0.8921 0.0573 0.6929 0.7597
    Acc_avg 0.7579 Prec_avg 0.7395 Recall_avg 0.4595 F1_avg 0.4789
    Loss 1.9692
[Save] Best Accuracy: 0.7579.

    [Tain]: 
    Epoch 11
    Data Time 5.9247 (0.0058)
    Batch Time 646.0664 (0.6315)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9406 0.9406 0.9406 0.9406 0.9406 0.9406 0.9406
    Precision 0.9391 0.9179 0.8920 0.9664 0.9251 0.9307 0.9232
    Recall 0.9308 0.8755 0.8728 0.9712 0.9229 0.9222 0.9327
    F1 0.9349 0.8962 0.8823 0.9688 0.9240 0.9264 0.9279
    AdversarialNet Acc 0.7348 Acc_avg 0.9406 Prec_avg 0.9278 Recall_avg 0.9183 F1_avg 0.9229
    Total Loss 0.8928 Global Cls Loss 0.1731 Local Cls Loss 0.1751 AFN Loss 0.0000 DAN Loss 0.5447

    [Test (Source Domain)]: 
    Data Time 0.2741 (0.0029)
    Batch Time 19.9663 (0.2124)
    Accuracy 0.6619 0.6619 0.6619 0.6619 0.6619 0.6619 0.6619
    Precision 0.9018 0.7143 0.5490 0.7247 0.9714 0.6667 0.5252
    Recall 0.4523 0.3676 0.1772 0.9035 0.1521 0.5125 0.8630
    F1 0.6025 0.4854 0.2679 0.8043 0.2631 0.5795 0.6530
    Acc_avg 0.6619 Prec_avg 0.7219 Recall_avg 0.4897 F1_avg 0.5222
    Loss 2.7812

    [Test (Target Domain)]: 
    Data Time 1.3707 (0.0027)
    Batch Time 93.6654 (0.1829)
    Accuracy 0.7598 0.7598 0.7598 0.7598 0.7598 0.7598 0.7598
    Precision 0.8932 0.5405 0.6958 0.8342 0.8271 0.7678 0.6314
    Recall 0.3194 0.0760 0.3537 0.9451 0.1159 0.5818 0.9393
    F1 0.4706 0.1333 0.4690 0.8862 0.2033 0.6620 0.7552
    Acc_avg 0.7598 Prec_avg 0.7414 Recall_avg 0.4759 F1_avg 0.5114
    Loss 1.8397
[Save] Best Accuracy: 0.7598.

    [Tain]: 
    Epoch 12
    Data Time 5.7741 (0.0056)
    Batch Time 601.1404 (0.5876)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9304 0.9304 0.9304 0.9304 0.9304 0.9304 0.9304
    Precision 0.9316 0.8940 0.8829 0.9546 0.9152 0.9256 0.9134
    Recall 0.9207 0.8438 0.8607 0.9659 0.9125 0.9073 0.9175
    F1 0.9261 0.8682 0.8716 0.9603 0.9139 0.9164 0.9155
    AdversarialNet Acc 0.6524 Acc_avg 0.9304 Prec_avg 0.9168 Recall_avg 0.9041 F1_avg 0.9103
    Total Loss 1.0314 Global Cls Loss 0.2098 Local Cls Loss 0.2013 AFN Loss 0.0000 DAN Loss 0.6203

    [Test (Source Domain)]: 
    Data Time 0.2784 (0.0030)
    Batch Time 21.6585 (0.2304)
    Accuracy 0.6552 0.6552 0.6552 0.6552 0.6552 0.6552 0.6552
    Precision 0.9160 0.7941 0.5800 0.7019 0.9167 0.6500 0.5366
    Recall 0.3692 0.3971 0.1835 0.9351 0.1230 0.4875 0.8389
    F1 0.5263 0.5294 0.2788 0.8019 0.2170 0.5571 0.6545
    Acc_avg 0.6552 Prec_avg 0.7279 Recall_avg 0.4763 F1_avg 0.5093
    Loss 3.1504

    [Test (Target Domain)]: 
    Data Time 1.4312 (0.0028)
    Batch Time 112.2017 (0.2191)
    Accuracy 0.7516 0.7516 0.7516 0.7516 0.7516 0.7516 0.7516
    Precision 0.8945 0.6316 0.6261 0.8153 0.8172 0.7386 0.6331
    Recall 0.3090 0.0456 0.2528 0.9704 0.0801 0.6322 0.8780
    F1 0.4594 0.0851 0.3602 0.8861 0.1459 0.6813 0.7357
    Acc_avg 0.7516 Prec_avg 0.7366 Recall_avg 0.4526 F1_avg 0.4791
    Loss 2.2263

    [Tain]: 
    Epoch 13
    Data Time 5.7710 (0.0056)
    Batch Time 669.4606 (0.6544)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9450 0.9450 0.9450 0.9450 0.9450 0.9450 0.9450
    Precision 0.9506 0.9150 0.9030 0.9645 0.9310 0.9403 0.9316
    Recall 0.9367 0.8997 0.8789 0.9739 0.9290 0.9271 0.9352
    F1 0.9436 0.9073 0.8908 0.9692 0.9300 0.9337 0.9334
    AdversarialNet Acc 0.6892 Acc_avg 0.9450 Prec_avg 0.9337 Recall_avg 0.9258 F1_avg 0.9297
    Total Loss 0.8985 Global Cls Loss 0.1577 Local Cls Loss 0.1581 AFN Loss 0.0000 DAN Loss 0.5826

    [Test (Source Domain)]: 
    Data Time 0.2633 (0.0028)
    Batch Time 17.6826 (0.1881)
    Accuracy 0.6786 0.6786 0.6786 0.6786 0.6786 0.6786 0.6786
    Precision 0.8944 0.5000 0.5082 0.7128 0.9318 0.5346 0.6052
    Recall 0.4954 0.4412 0.1962 0.9411 0.1834 0.7250 0.7666
    F1 0.6376 0.4688 0.2831 0.8112 0.3065 0.6154 0.6764
    Acc_avg 0.6786 Prec_avg 0.6696 Recall_avg 0.5356 F1_avg 0.5427
    Loss 2.6752

    [Test (Target Domain)]: 
    Data Time 1.3800 (0.0027)
    Batch Time 93.8870 (0.1834)
    Accuracy 0.6766 0.6766 0.6766 0.6766 0.6766 0.6766 0.6766
    Precision 0.9091 0.4722 0.6807 0.6571 0.7429 0.6970 0.7349
    Recall 0.2517 0.0646 0.2704 0.9919 0.0822 0.6163 0.5044
    F1 0.3943 0.1137 0.3870 0.7905 0.1480 0.6542 0.5983
    Acc_avg 0.6766 Prec_avg 0.6991 Recall_avg 0.3974 F1_avg 0.4409
    Loss 2.8038

    [Tain]: 
    Epoch 14
    Data Time 5.9519 (0.0058)
    Batch Time 627.1438 (0.6130)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9444 0.9444 0.9444 0.9444 0.9444 0.9444 0.9444
    Precision 0.9483 0.9266 0.9174 0.9626 0.9338 0.9339 0.9276
    Recall 0.9383 0.8912 0.8879 0.9729 0.9261 0.9275 0.9336
    F1 0.9433 0.9086 0.9024 0.9677 0.9299 0.9307 0.9306
    AdversarialNet Acc 0.5730 Acc_avg 0.9444 Prec_avg 0.9357 Recall_avg 0.9254 F1_avg 0.9305
    Total Loss 1.0325 Global Cls Loss 0.1705 Local Cls Loss 0.1623 AFN Loss 0.0000 DAN Loss 0.6997

    [Test (Source Domain)]: 
    Data Time 0.2673 (0.0028)
    Batch Time 18.7186 (0.1991)
    Accuracy 0.7167 0.7167 0.7167 0.7167 0.7167 0.7167 0.7167
    Precision 0.8927 0.4933 0.4458 0.7822 0.9272 0.5744 0.6137
    Recall 0.5631 0.5441 0.2342 0.9291 0.3132 0.7000 0.8253
    F1 0.6906 0.5175 0.3071 0.8493 0.4682 0.6310 0.7039
    Acc_avg 0.7167 Prec_avg 0.6756 Recall_avg 0.5870 F1_avg 0.5954
    Loss 2.1937

    [Test (Target Domain)]: 
    Data Time 1.3526 (0.0026)
    Batch Time 93.7372 (0.1831)
    Accuracy 0.7630 0.7630 0.7630 0.7630 0.7630 0.7630 0.7630
    Precision 0.8757 0.4809 0.6498 0.7932 0.7946 0.6919 0.7206
    Recall 0.3915 0.1673 0.3213 0.9845 0.1549 0.6870 0.7973
    F1 0.5411 0.2482 0.4300 0.8786 0.2593 0.6894 0.7570
    Acc_avg 0.7630 Prec_avg 0.7152 Recall_avg 0.5005 F1_avg 0.5434
    Loss 1.9276
[Save] Best Recall: 0.5005.
[Save] Best Accuracy: 0.7630.

    [Tain]: 
    Epoch 15
    Data Time 5.7545 (0.0056)
    Batch Time 613.9183 (0.6001)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9600 0.9600 0.9600 0.9600 0.9600 0.9600 0.9600
    Precision 0.9628 0.9432 0.9310 0.9723 0.9513 0.9663 0.9501
    Recall 0.9564 0.9257 0.9210 0.9811 0.9444 0.9531 0.9504
    F1 0.9596 0.9344 0.9260 0.9767 0.9478 0.9597 0.9502
    AdversarialNet Acc 0.7488 Acc_avg 0.9600 Prec_avg 0.9538 Recall_avg 0.9474 F1_avg 0.9506
    Total Loss 0.7919 Global Cls Loss 0.1176 Local Cls Loss 0.1210 AFN Loss 0.0000 DAN Loss 0.5533

    [Test (Source Domain)]: 
    Data Time 0.2496 (0.0027)
    Batch Time 17.5716 (0.1869)
    Accuracy 0.6926 0.6926 0.6926 0.6926 0.6926 0.6926 0.6926
    Precision 0.8763 0.6364 0.5763 0.7356 0.9048 0.6846 0.5675
    Recall 0.5231 0.3088 0.2152 0.9146 0.2975 0.6375 0.8163
    F1 0.6551 0.4158 0.3134 0.8154 0.4478 0.6602 0.6695
    Acc_avg 0.6926 Prec_avg 0.7116 Recall_avg 0.5304 F1_avg 0.5682
    Loss 2.2172

    [Test (Target Domain)]: 
    Data Time 1.3621 (0.0027)
    Batch Time 93.9174 (0.1834)
    Accuracy 0.7428 0.7428 0.7428 0.7428 0.7428 0.7428 0.7428
    Precision 0.9146 0.4776 0.6508 0.7577 0.7574 0.7739 0.7002
    Recall 0.3255 0.0608 0.4056 0.9792 0.1349 0.5447 0.7784
    F1 0.4802 0.1079 0.4997 0.8543 0.2290 0.6393 0.7372
    Acc_avg 0.7428 Prec_avg 0.7189 Recall_avg 0.4613 F1_avg 0.5068
    Loss 1.9268

    [Tain]: 
    Epoch 16
    Data Time 5.8797 (0.0057)
    Batch Time 595.6859 (0.5823)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9468 0.9468 0.9468 0.9468 0.9468 0.9468 0.9468
    Precision 0.9546 0.9356 0.9110 0.9621 0.9397 0.9455 0.9301
    Recall 0.9441 0.9038 0.8835 0.9755 0.9308 0.9328 0.9322
    F1 0.9493 0.9194 0.8970 0.9687 0.9352 0.9391 0.9311
    AdversarialNet Acc 0.6620 Acc_avg 0.9468 Prec_avg 0.9398 Recall_avg 0.9289 F1_avg 0.9343
    Total Loss 0.9319 Global Cls Loss 0.1547 Local Cls Loss 0.1518 AFN Loss 0.0000 DAN Loss 0.6254

    [Test (Source Domain)]: 
    Data Time 0.2759 (0.0029)
    Batch Time 21.0899 (0.2244)
    Accuracy 0.7006 0.7006 0.7006 0.7006 0.7006 0.7006 0.7006
    Precision 0.9059 0.5686 0.5000 0.8429 0.9187 0.5598 0.5258
    Recall 0.5631 0.4265 0.1392 0.8523 0.3289 0.7312 0.9051
    F1 0.6945 0.4874 0.2178 0.8476 0.4843 0.6341 0.6652
    Acc_avg 0.7006 Prec_avg 0.6888 Recall_avg 0.5638 F1_avg 0.5759
    Loss 2.0943

    [Test (Target Domain)]: 
    Data Time 1.3691 (0.0027)
    Batch Time 107.6082 (0.2102)
    Accuracy 0.7850 0.7850 0.7850 0.7850 0.7850 0.7850 0.7850
    Precision 0.8374 0.5645 0.6806 0.8544 0.8217 0.7257 0.6775
    Recall 0.4470 0.1331 0.3926 0.9669 0.1992 0.6994 0.8863
    F1 0.5829 0.2154 0.4979 0.9071 0.3206 0.7123 0.7680
    Acc_avg 0.7850 Prec_avg 0.7374 Recall_avg 0.5321 F1_avg 0.5720
    Loss 1.5006
[Save] Best Recall: 0.5321.
[Save] Best Accuracy: 0.7850.

    [Tain]: 
    Epoch 17
    Data Time 6.2897 (0.0061)
    Batch Time 644.5974 (0.6301)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9531 0.9531 0.9531 0.9531 0.9531 0.9531 0.9531
    Precision 0.9524 0.9367 0.9269 0.9656 0.9445 0.9534 0.9448
    Recall 0.9518 0.8967 0.8990 0.9770 0.9394 0.9483 0.9418
    F1 0.9521 0.9163 0.9127 0.9713 0.9419 0.9508 0.9433
    AdversarialNet Acc 0.6695 Acc_avg 0.9531 Prec_avg 0.9463 Recall_avg 0.9363 F1_avg 0.9412
    Total Loss 0.8920 Global Cls Loss 0.1382 Local Cls Loss 0.1358 AFN Loss 0.0000 DAN Loss 0.6180

    [Test (Source Domain)]: 
    Data Time 0.2618 (0.0028)
    Batch Time 20.9117 (0.2225)
    Accuracy 0.6996 0.6996 0.6996 0.6996 0.6996 0.6996 0.6996
    Precision 0.9064 0.6667 0.5143 0.7398 0.9343 0.6034 0.5972
    Recall 0.4769 0.4118 0.2278 0.9274 0.2864 0.6750 0.8328
    F1 0.6250 0.5091 0.3158 0.8230 0.4384 0.6372 0.6956
    Acc_avg 0.6996 Prec_avg 0.7089 Recall_avg 0.5483 F1_avg 0.5777
    Loss 2.3059

    [Test (Target Domain)]: 
    Data Time 1.4027 (0.0027)
    Batch Time 108.0514 (0.2110)
    Accuracy 0.7493 0.7493 0.7493 0.7493 0.7493 0.7493 0.7493
    Precision 0.9198 0.4138 0.6243 0.7533 0.7624 0.8090 0.7429
    Recall 0.2986 0.0456 0.5278 0.9922 0.1454 0.5880 0.7374
    F1 0.4509 0.0822 0.5720 0.8564 0.2442 0.6810 0.7402
    Acc_avg 0.7493 Prec_avg 0.7179 Recall_avg 0.4764 F1_avg 0.5181
    Loss 2.0539

    [Tain]: 
    Epoch 18
    Data Time 5.7533 (0.0056)
    Batch Time 625.3068 (0.6112)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9567 0.9567 0.9567 0.9567 0.9567 0.9567 0.9567
    Precision 0.9611 0.9405 0.9299 0.9693 0.9486 0.9564 0.9455
    Recall 0.9524 0.9146 0.9170 0.9784 0.9416 0.9538 0.9455
    F1 0.9568 0.9274 0.9234 0.9738 0.9451 0.9551 0.9455
    AdversarialNet Acc 0.6313 Acc_avg 0.9567 Prec_avg 0.9502 Recall_avg 0.9433 F1_avg 0.9467
    Total Loss 0.9042 Global Cls Loss 0.1269 Local Cls Loss 0.1263 AFN Loss 0.0000 DAN Loss 0.6510

    [Test (Source Domain)]: 
    Data Time 0.3207 (0.0034)
    Batch Time 18.7781 (0.1998)
    Accuracy 0.6853 0.6853 0.6853 0.6853 0.6853 0.6853 0.6853
    Precision 0.8670 0.7778 0.3830 0.6880 0.9381 0.6282 0.6351
    Recall 0.5815 0.4118 0.2278 0.9436 0.2371 0.6125 0.7364
    F1 0.6961 0.5385 0.2857 0.7958 0.3786 0.6203 0.6820
    Acc_avg 0.6853 Prec_avg 0.7024 Recall_avg 0.5358 F1_avg 0.5710
    Loss 2.7412

    [Test (Target Domain)]: 
    Data Time 1.3484 (0.0026)
    Batch Time 93.7318 (0.1831)
    Accuracy 0.7353 0.7353 0.7353 0.7353 0.7353 0.7353 0.7353
    Precision 0.8757 0.5846 0.5875 0.7251 0.6883 0.7722 0.7851
    Recall 0.4158 0.0722 0.4537 0.9957 0.1675 0.5995 0.6373
    F1 0.5639 0.1286 0.5120 0.8391 0.2695 0.6750 0.7035
    Acc_avg 0.7353 Prec_avg 0.7169 Recall_avg 0.4774 F1_avg 0.5274
    Loss 2.2045

    [Tain]: 
    Epoch 19
    Data Time 6.2512 (0.0061)
    Batch Time 659.1426 (0.6443)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9609 0.9609 0.9609 0.9609 0.9609 0.9609 0.9609
    Precision 0.9636 0.9486 0.9310 0.9733 0.9546 0.9618 0.9499
    Recall 0.9534 0.9326 0.9147 0.9812 0.9476 0.9552 0.9540
    F1 0.9585 0.9405 0.9228 0.9772 0.9511 0.9585 0.9520
    AdversarialNet Acc 0.6405 Acc_avg 0.9609 Prec_avg 0.9547 Recall_avg 0.9484 F1_avg 0.9515
    Total Loss 0.8686 Global Cls Loss 0.1145 Local Cls Loss 0.1136 AFN Loss 0.0000 DAN Loss 0.6405

    [Test (Source Domain)]: 
    Data Time 0.3461 (0.0037)
    Batch Time 19.1529 (0.2038)
    Accuracy 0.6696 0.6696 0.6696 0.6696 0.6696 0.6696 0.6696
    Precision 0.9032 0.6098 0.4286 0.6551 0.8705 0.4977 0.7022
    Recall 0.5169 0.3676 0.2848 0.9633 0.2707 0.6813 0.6145
    F1 0.6575 0.4587 0.3422 0.7798 0.4130 0.5752 0.6554
    Acc_avg 0.6696 Prec_avg 0.6667 Recall_avg 0.5284 F1_avg 0.5546
    Loss 2.7228

    [Test (Target Domain)]: 
    Data Time 1.3608 (0.0027)
    Batch Time 112.2518 (0.2192)
    Accuracy 0.7271 0.7271 0.7271 0.7271 0.7271 0.7271 0.7271
    Precision 0.8304 0.5424 0.5791 0.7203 0.6620 0.6992 0.8208
    Recall 0.4462 0.0608 0.5324 0.9947 0.1981 0.6967 0.5322
    F1 0.5805 0.1094 0.5548 0.8355 0.3049 0.6980 0.6457
    Acc_avg 0.7271 Prec_avg 0.6934 Recall_avg 0.4944 F1_avg 0.5327
    Loss 2.3913
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 81.777915s
 train target dataset qty: 32757
 train target dataset dist: 2303, 1053, 2158, 15871, 1898, 2262, 7212
[Target Domain] Cost time : 202.907148s
TransferToTargetDomain.py:172: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():

    [Tain]: 
    Epoch 20
    Data Time 6.4138 (0.0063)
    Batch Time 657.6442 (0.6429)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.001
    Accuracy 0.9702 0.9702 0.9702 0.9702 0.9702 0.9702 0.9702
    Precision 0.9703 0.9619 0.9578 0.9797 0.9675 0.9682 0.9592
    Recall 0.9638 0.9458 0.9440 0.9870 0.9598 0.9610 0.9623
    F1 0.9670 0.9538 0.9508 0.9833 0.9636 0.9646 0.9608
    AdversarialNet Acc 0.6685 Acc_avg 0.9702 Prec_avg 0.9664 Recall_avg 0.9605 F1_avg 0.9634
    Total Loss 0.7872 Global Cls Loss 0.0865 Local Cls Loss 0.0901 AFN Loss 0.0000 DAN Loss 0.6105

    [Test (Source Domain)]: 
    Data Time 0.2577 (0.0027)
    Batch Time 17.6763 (0.1880)
    Accuracy 0.7264 0.7264 0.7264 0.7264 0.7264 0.7264 0.7264
    Precision 0.7418 0.8710 0.5893 0.7487 0.9470 0.6993 0.6504
    Recall 0.7692 0.3971 0.2089 0.9564 0.2796 0.6250 0.7816
    F1 0.7553 0.5455 0.3084 0.8399 0.4318 0.6601 0.7100
    Acc_avg 0.7264 Prec_avg 0.7496 Recall_avg 0.5740 F1_avg 0.6073
    Loss 2.0849

    [Test (Target Domain)]: 
    Data Time 1.3726 (0.0027)
    Batch Time 93.8730 (0.1833)
    Accuracy 0.7349 0.7349 0.7349 0.7349 0.7349 0.7349 0.7349
    Precision 0.6461 0.3967 0.6639 0.7410 0.5891 0.7344 0.8369
    Recall 0.6910 0.0913 0.4463 0.9883 0.3203 0.7286 0.4825
    F1 0.6678 0.1484 0.5338 0.8470 0.4150 0.7315 0.6121
    Acc_avg 0.7349 Prec_avg 0.6583 Recall_avg 0.5355 F1_avg 0.5651
    Loss 2.3479
[Save] Best Recall: 0.5355.

    [Tain]: 
    Epoch 21
    Data Time 6.3935 (0.0062)
    Batch Time 633.9646 (0.6197)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9636 0.9636 0.9636 0.9636 0.9636 0.9636 0.9636
    Precision 0.9605 0.9492 0.9515 0.9774 0.9545 0.9613 0.9511
    Recall 0.9616 0.9308 0.9249 0.9838 0.9482 0.9602 0.9534
    F1 0.9611 0.9399 0.9381 0.9806 0.9513 0.9608 0.9522
    AdversarialNet Acc 0.4869 Acc_avg 0.9636 Prec_avg 0.9579 Recall_avg 0.9519 F1_avg 0.9549
    Total Loss 1.0677 Global Cls Loss 0.1083 Local Cls Loss 0.1057 AFN Loss 0.0000 DAN Loss 0.8537

    [Test (Source Domain)]: 
    Data Time 0.2608 (0.0028)
    Batch Time 20.7199 (0.2204)
    Accuracy 0.5356 0.5356 0.5356 0.5356 0.5356 0.5356 0.5356
    Precision 0.5831 0.8400 0.7368 0.5035 0.9796 0.5570 0.8772
    Recall 0.6800 0.3088 0.0886 0.9915 0.1074 0.5500 0.0753
    F1 0.6278 0.4516 0.1582 0.6678 0.1935 0.5535 0.1387
    Acc_avg 0.5356 Prec_avg 0.7253 Recall_avg 0.4002 F1_avg 0.3987
    Loss 5.5550

    [Test (Target Domain)]: 
    Data Time 1.3811 (0.0027)
    Batch Time 112.2275 (0.2192)
    Accuracy 0.6568 0.6568 0.6568 0.6568 0.6568 0.6568 0.6568
    Precision 0.6321 0.4299 0.6575 0.6642 0.5517 0.6012 0.8545
    Recall 0.6623 0.1806 0.3093 0.9914 0.3319 0.7303 0.1547
    F1 0.6469 0.2544 0.4207 0.7955 0.4145 0.6595 0.2620
    Acc_avg 0.6568 Prec_avg 0.6273 Recall_avg 0.4801 F1_avg 0.4933
    Loss 5.0031

    [Tain]: 
    Epoch 22
    Data Time 6.0484 (0.0059)
    Batch Time 601.8025 (0.5883)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9605 0.9605 0.9605 0.9605 0.9605 0.9605 0.9605
    Precision 0.9551 0.8921 0.9310 0.9764 0.9537 0.9599 0.9540
    Recall 0.9515 0.9133 0.9138 0.9823 0.9490 0.9599 0.9510
    F1 0.9533 0.9026 0.9223 0.9794 0.9514 0.9599 0.9525
    AdversarialNet Acc 0.5217 Acc_avg 0.9605 Prec_avg 0.9460 Recall_avg 0.9458 F1_avg 0.9459
    Total Loss 1.0384 Global Cls Loss 0.1220 Local Cls Loss 0.1188 AFN Loss 0.0000 DAN Loss 0.7975

    [Test (Source Domain)]: 
    Data Time 0.2773 (0.0030)
    Batch Time 18.2244 (0.1939)
    Accuracy 0.4992 0.4992 0.4992 0.4992 0.4992 0.4992 0.4992
    Precision 0.7234 0.4792 0.7143 0.4620 0.7500 0.6869 0.8400
    Recall 0.5231 0.3382 0.0633 0.9957 0.0805 0.4250 0.0316
    F1 0.6071 0.3966 0.1163 0.6311 0.1455 0.5251 0.0610
    Acc_avg 0.4992 Prec_avg 0.6651 Recall_avg 0.3511 F1_avg 0.3547
    Loss 8.1032

    [Test (Target Domain)]: 
    Data Time 1.3822 (0.0027)
    Batch Time 93.9035 (0.1834)
    Accuracy 0.6163 0.6163 0.6163 0.6163 0.6163 0.6163 0.6163
    Precision 0.7731 0.1769 0.6406 0.6217 0.4260 0.7041 0.8656
    Recall 0.4497 0.1749 0.2657 0.9938 0.3214 0.5933 0.0929
    F1 0.5686 0.1759 0.3757 0.7649 0.3664 0.6440 0.1678
    Acc_avg 0.6163 Prec_avg 0.6012 Recall_avg 0.4131 F1_avg 0.4376
    Loss 7.3042

    [Tain]: 
    Epoch 23
    Data Time 6.5068 (0.0064)
    Batch Time 663.9368 (0.6490)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9467 0.9467 0.9467 0.9467 0.9467 0.9467 0.9467
    Precision 0.9475 0.9180 0.9097 0.9655 0.9368 0.9398 0.9332
    Recall 0.9390 0.8923 0.8943 0.9734 0.9296 0.9393 0.9357
    F1 0.9432 0.9050 0.9019 0.9694 0.9332 0.9396 0.9344
    AdversarialNet Acc 0.5470 Acc_avg 0.9467 Prec_avg 0.9358 Recall_avg 0.9291 F1_avg 0.9324
    Total Loss 1.0464 Global Cls Loss 0.1588 Local Cls Loss 0.1511 AFN Loss 0.0000 DAN Loss 0.7365

    [Test (Source Domain)]: 
    Data Time 0.4152 (0.0044)
    Batch Time 17.7487 (0.1888)
    Accuracy 0.4881 0.4881 0.4881 0.4881 0.4881 0.4881 0.4881
    Precision 0.8942 0.1059 0.5000 0.5119 0.7288 0.9412 0.9474
    Recall 0.2862 0.6324 0.0063 0.9915 0.2886 0.1000 0.0271
    F1 0.4336 0.1814 0.0125 0.6752 0.4135 0.1808 0.0527
    Acc_avg 0.4881 Prec_avg 0.6613 Recall_avg 0.3331 F1_avg 0.2785
    Loss 6.8880

    [Test (Target Domain)]: 
    Data Time 1.6189 (0.0032)
    Batch Time 95.1170 (0.1858)
    Accuracy 0.5972 0.5972 0.5972 0.5972 0.5972 0.5972 0.5972
    Precision 0.9141 0.1996 0.6902 0.5913 0.4658 0.8117 0.8138
    Recall 0.3142 0.1901 0.2537 0.9947 0.3656 0.5031 0.0654
    F1 0.4677 0.1947 0.3710 0.7417 0.4097 0.6212 0.1211
    Acc_avg 0.5972 Prec_avg 0.6409 Recall_avg 0.3839 F1_avg 0.4182
    Loss 7.0914

    [Tain]: 
    Epoch 24
    Data Time 6.2286 (0.0061)
    Batch Time 601.5248 (0.5880)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9625 0.9625 0.9625 0.9625 0.9625 0.9625 0.9625
    Precision 0.9614 0.9387 0.9391 0.9788 0.9569 0.9528 0.9479
    Recall 0.9562 0.9258 0.9329 0.9803 0.9560 0.9528 0.9517
    F1 0.9588 0.9322 0.9360 0.9796 0.9565 0.9528 0.9498
    AdversarialNet Acc 0.5782 Acc_avg 0.9625 Prec_avg 0.9537 Recall_avg 0.9508 F1_avg 0.9522
    Total Loss 0.9237 Global Cls Loss 0.1177 Local Cls Loss 0.1134 AFN Loss 0.0000 DAN Loss 0.6926

    [Test (Source Domain)]: 
    Data Time 0.2883 (0.0031)
    Batch Time 18.1477 (0.1931)
    Accuracy 0.6261 0.6261 0.6261 0.6261 0.6261 0.6261 0.6261
    Precision 0.8134 0.5000 0.7000 0.5945 0.9048 1.0000 0.6176
    Recall 0.5231 0.3529 0.0886 0.9855 0.1275 0.2500 0.6250
    F1 0.6367 0.4138 0.1573 0.7416 0.2235 0.4000 0.6213
    Acc_avg 0.6261 Prec_avg 0.7329 Recall_avg 0.4218 F1_avg 0.4563
    Loss 4.6071

    [Test (Target Domain)]: 
    Data Time 1.3984 (0.0027)
    Batch Time 94.3804 (0.1843)
    Accuracy 0.6396 0.6396 0.6396 0.6396 0.6396 0.6396 0.6396
    Precision 0.8044 0.3500 0.7053 0.6211 0.5971 0.8443 0.6870
    Recall 0.4427 0.1331 0.3324 0.9945 0.2202 0.3643 0.2842
    F1 0.5711 0.1928 0.4519 0.7646 0.3218 0.5090 0.4021
    Acc_avg 0.6396 Prec_avg 0.6585 Recall_avg 0.3959 F1_avg 0.4590
    Loss 5.5402

    [Tain]: 
    Epoch 25
    Data Time 6.6024 (0.0065)
    Batch Time 669.3857 (0.6543)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9616 0.9616 0.9616 0.9616 0.9616 0.9616 0.9616
    Precision 0.9595 0.9529 0.9389 0.9763 0.9483 0.9668 0.9505
    Recall 0.9586 0.9382 0.9250 0.9821 0.9447 0.9554 0.9518
    F1 0.9590 0.9455 0.9319 0.9792 0.9465 0.9611 0.9512
    AdversarialNet Acc 0.5855 Acc_avg 0.9616 Prec_avg 0.9562 Recall_avg 0.9508 F1_avg 0.9535
    Total Loss 0.9199 Global Cls Loss 0.1180 Local Cls Loss 0.1121 AFN Loss 0.0000 DAN Loss 0.6897

    [Test (Source Domain)]: 
    Data Time 0.2673 (0.0028)
    Batch Time 19.8625 (0.2113)
    Accuracy 0.6064 0.6064 0.6064 0.6064 0.6064 0.6064 0.6064
    Precision 0.8453 1.0000 0.6667 0.5979 1.0000 0.9474 0.5659
    Recall 0.4708 0.0294 0.0127 0.9727 0.0067 0.1125 0.7500
    F1 0.6047 0.0571 0.0248 0.7406 0.0133 0.2011 0.6451
    Acc_avg 0.6064 Prec_avg 0.8033 Recall_avg 0.3364 F1_avg 0.3267
    Loss 7.5917

    [Test (Target Domain)]: 
    Data Time 1.3942 (0.0027)
    Batch Time 98.4833 (0.1924)
    Accuracy 0.6237 0.6237 0.6237 0.6237 0.6237 0.6237 0.6237
    Precision 0.8295 1.0000 0.7333 0.6003 0.8333 0.9675 0.6809
    Recall 0.3168 0.0019 0.1222 0.9963 0.0263 0.1317 0.4540
    F1 0.4585 0.0038 0.2095 0.7492 0.0511 0.2319 0.5448
    Acc_avg 0.6237 Prec_avg 0.8064 Recall_avg 0.2928 F1_avg 0.3213
    Loss 7.3812

    [Tain]: 
    Epoch 26
    Data Time 6.3854 (0.0062)
    Batch Time 646.0720 (0.6315)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9723 0.9723 0.9723 0.9723 0.9723 0.9723 0.9723
    Precision 0.9747 0.9562 0.9560 0.9812 0.9668 0.9705 0.9649
    Recall 0.9696 0.9377 0.9437 0.9863 0.9655 0.9618 0.9669
    F1 0.9721 0.9469 0.9498 0.9838 0.9661 0.9661 0.9659
    AdversarialNet Acc 0.5248 Acc_avg 0.9723 Prec_avg 0.9672 Recall_avg 0.9616 F1_avg 0.9644
    Total Loss 0.8788 Global Cls Loss 0.0830 Local Cls Loss 0.0821 AFN Loss 0.0000 DAN Loss 0.7137

    [Test (Source Domain)]: 
    Data Time 0.2622 (0.0028)
    Batch Time 17.4975 (0.1861)
    Accuracy 0.6037 0.6037 0.6037 0.6037 0.6037 0.6037 0.6037
    Precision 0.7800 1.0000 0.4444 0.5676 1.0000 0.8868 0.6290
    Recall 0.6000 0.0294 0.0506 0.9889 0.0045 0.2938 0.5949
    F1 0.6783 0.0571 0.0909 0.7213 0.0089 0.4413 0.6115
    Acc_avg 0.6037 Prec_avg 0.7583 Recall_avg 0.3660 F1_avg 0.3728
    Loss 8.2537

    [Test (Target Domain)]: 
    Data Time 1.3603 (0.0027)
    Batch Time 93.6319 (0.1829)
    Accuracy 0.6852 0.6852 0.6852 0.6852 0.6852 0.6852 0.6852
    Precision 0.7169 0.6071 0.7514 0.6657 0.6533 0.8696 0.7189
    Recall 0.6354 0.0323 0.2463 0.9960 0.1033 0.4244 0.4786
    F1 0.6737 0.0614 0.3710 0.7980 0.1783 0.5704 0.5747
    Acc_avg 0.6852 Prec_avg 0.7118 Recall_avg 0.4166 F1_avg 0.4611
    Loss 5.9050

    [Tain]: 
    Epoch 27
    Data Time 5.9420 (0.0058)
    Batch Time 630.4359 (0.6163)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9699 0.9699 0.9699 0.9699 0.9699 0.9699 0.9699
    Precision 0.9710 0.9617 0.9462 0.9818 0.9582 0.9620 0.9652
    Recall 0.9685 0.9496 0.9428 0.9844 0.9597 0.9635 0.9623
    F1 0.9697 0.9556 0.9445 0.9831 0.9590 0.9627 0.9638
    AdversarialNet Acc 0.5070 Acc_avg 0.9699 Prec_avg 0.9637 Recall_avg 0.9615 F1_avg 0.9626
    Total Loss 0.8885 Global Cls Loss 0.0911 Local Cls Loss 0.0888 AFN Loss 0.0000 DAN Loss 0.7086

    [Test (Source Domain)]: 
    Data Time 0.2595 (0.0028)
    Batch Time 19.8567 (0.2112)
    Accuracy 0.6091 0.6091 0.6091 0.6091 0.6091 0.6091 0.6091
    Precision 0.8087 1.0000 1.0000 0.5651 1.0000 0.9024 0.6393
    Recall 0.5723 0.1029 0.0506 0.9821 0.0336 0.2313 0.6325
    F1 0.6703 0.1867 0.0964 0.7174 0.0649 0.3682 0.6359
    Acc_avg 0.6091 Prec_avg 0.8451 Recall_avg 0.3722 F1_avg 0.3914
    Loss 6.3544

    [Test (Target Domain)]: 
    Data Time 1.3722 (0.0027)
    Batch Time 107.4333 (0.2098)
    Accuracy 0.6758 0.6758 0.6758 0.6758 0.6758 0.6758 0.6758
    Precision 0.7420 0.5244 0.7849 0.6526 0.5392 0.8571 0.7464
    Recall 0.5616 0.0817 0.1824 0.9955 0.1812 0.3873 0.4637
    F1 0.6393 0.1414 0.2960 0.7884 0.2713 0.5335 0.5720
    Acc_avg 0.6758 Prec_avg 0.6924 Recall_avg 0.4076 F1_avg 0.4631
    Loss 5.3655

    [Tain]: 
    Epoch 28
    Data Time 6.3166 (0.0062)
    Batch Time 656.3582 (0.6416)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9757 0.9757 0.9757 0.9757 0.9757 0.9757 0.9757
    Precision 0.9735 0.9705 0.9653 0.9837 0.9676 0.9785 0.9706
    Recall 0.9695 0.9584 0.9573 0.9873 0.9681 0.9748 0.9701
    F1 0.9715 0.9644 0.9613 0.9855 0.9678 0.9767 0.9703
    AdversarialNet Acc 0.5772 Acc_avg 0.9757 Prec_avg 0.9728 Recall_avg 0.9694 F1_avg 0.9711
    Total Loss 0.8115 Global Cls Loss 0.0720 Local Cls Loss 0.0710 AFN Loss 0.0000 DAN Loss 0.6686

    [Test (Source Domain)]: 
    Data Time 0.2792 (0.0030)
    Batch Time 20.9837 (0.2232)
    Accuracy 0.6452 0.6452 0.6452 0.6452 0.6452 0.6452 0.6452
    Precision 0.7303 0.8333 0.6786 0.6186 0.9167 0.6040 0.6639
    Recall 0.6831 0.0735 0.1203 0.9778 0.1230 0.5625 0.5949
    F1 0.7059 0.1351 0.2043 0.7578 0.2170 0.5825 0.6275
    Acc_avg 0.6452 Prec_avg 0.7208 Recall_avg 0.4479 F1_avg 0.4614
    Loss 3.8632

    [Test (Target Domain)]: 
    Data Time 1.3646 (0.0027)
    Batch Time 99.9579 (0.1952)
    Accuracy 0.6916 0.6916 0.6916 0.6916 0.6916 0.6916 0.6916
    Precision 0.7509 0.4000 0.7113 0.6781 0.5045 0.7140 0.7977
    Recall 0.5339 0.0342 0.3194 0.9932 0.2982 0.6490 0.4024
    F1 0.6240 0.0630 0.4409 0.8060 0.3748 0.6799 0.5349
    Acc_avg 0.6916 Prec_avg 0.6509 Recall_avg 0.4615 F1_avg 0.5034
    Loss 3.8390

    [Tain]: 
    Epoch 29
    Data Time 6.3765 (0.0062)
    Batch Time 624.5361 (0.6105)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9719 0.9719 0.9719 0.9719 0.9719 0.9719 0.9719
    Precision 0.9691 0.9630 0.9521 0.9829 0.9660 0.9655 0.9651
    Recall 0.9713 0.9455 0.9463 0.9867 0.9644 0.9592 0.9634
    F1 0.9702 0.9542 0.9492 0.9848 0.9652 0.9623 0.9642
    AdversarialNet Acc 0.5035 Acc_avg 0.9719 Prec_avg 0.9662 Recall_avg 0.9624 F1_avg 0.9643
    Total Loss 0.8732 Global Cls Loss 0.0846 Local Cls Loss 0.0805 AFN Loss 0.0000 DAN Loss 0.7080

    [Test (Source Domain)]: 
    Data Time 0.2854 (0.0030)
    Batch Time 19.8557 (0.2112)
    Accuracy 0.6983 0.6983 0.6983 0.6983 0.6983 0.6983 0.6983
    Precision 0.7493 0.8000 0.6905 0.6747 0.8671 0.6694 0.6960
    Recall 0.7723 0.1765 0.1835 0.9778 0.3065 0.5062 0.6551
    F1 0.7606 0.2892 0.2900 0.7985 0.4529 0.5765 0.6749
    Acc_avg 0.6983 Prec_avg 0.7353 Recall_avg 0.5111 F1_avg 0.5489
    Loss 2.8121

    [Test (Target Domain)]: 
    Data Time 1.3540 (0.0026)
    Batch Time 112.4163 (0.2196)
    Accuracy 0.7317 0.7317 0.7317 0.7317 0.7317 0.7317 0.7317
    Precision 0.6689 0.3673 0.7171 0.7587 0.4024 0.7405 0.8115
    Recall 0.6858 0.1027 0.3333 0.9854 0.4299 0.6207 0.5133
    F1 0.6772 0.1605 0.4551 0.8573 0.4157 0.6753 0.6288
    Acc_avg 0.7317 Prec_avg 0.6381 Recall_avg 0.5244 F1_avg 0.5529
    Loss 3.2722
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 82.213939s
 train target dataset qty: 32757
 train target dataset dist: 2303, 1053, 2158, 15871, 1898, 2262, 7212
[Target Domain] Cost time : 208.014905s
TransferToTargetDomain.py:172: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():

    [Tain]: 
    Epoch 30
    Data Time 5.9298 (0.0058)
    Batch Time 627.1398 (0.6130)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9546 0.9546 0.9546 0.9546 0.9546 0.9546 0.9546
    Precision 0.9536 0.9173 0.9190 0.9722 0.9407 0.9462 0.9482
    Recall 0.9484 0.8955 0.9109 0.9785 0.9424 0.9406 0.9442
    F1 0.9510 0.9063 0.9149 0.9753 0.9415 0.9434 0.9462
    AdversarialNet Acc 0.5065 Acc_avg 0.9546 Prec_avg 0.9425 Recall_avg 0.9372 F1_avg 0.9398
    Total Loss 0.9999 Global Cls Loss 0.1518 Local Cls Loss 0.1375 AFN Loss 0.0000 DAN Loss 0.7106

    [Test (Source Domain)]: 
    Data Time 0.2570 (0.0027)
    Batch Time 17.5383 (0.1866)
    Accuracy 0.7374 0.7374 0.7374 0.7374 0.7374 0.7374 0.7374
    Precision 0.8016 0.3663 0.4437 0.7872 0.6946 0.8265 0.7403
    Recall 0.6338 0.5441 0.3987 0.9385 0.6309 0.5062 0.6611
    F1 0.7079 0.4379 0.4200 0.8563 0.6612 0.6279 0.6985
    Acc_avg 0.7374 Prec_avg 0.6657 Recall_avg 0.6162 F1_avg 0.6299
    Loss 2.0719

    [Test (Target Domain)]: 
    Data Time 1.3643 (0.0027)
    Batch Time 93.7950 (0.1832)
    Accuracy 0.7873 0.7873 0.7873 0.7873 0.7873 0.7873 0.7873
    Precision 0.7633 0.3947 0.5706 0.8993 0.4375 0.7927 0.7468
    Recall 0.6102 0.1711 0.5241 0.9380 0.5943 0.6118 0.7867
    F1 0.6782 0.2387 0.5463 0.9182 0.5040 0.6906 0.7662
    Acc_avg 0.7873 Prec_avg 0.6578 Recall_avg 0.6052 F1_avg 0.6203
    Loss 1.7833
[Save] Best Recall: 0.6052.
[Save] Best Accuracy: 0.7873.

    [Tain]: 
    Epoch 31
    Data Time 6.4113 (0.0063)
    Batch Time 652.8186 (0.6381)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9698 0.9698 0.9698 0.9698 0.9698 0.9698 0.9698
    Precision 0.9692 0.9573 0.9411 0.9805 0.9653 0.9692 0.9625
    Recall 0.9661 0.9373 0.9387 0.9861 0.9602 0.9614 0.9624
    F1 0.9676 0.9472 0.9399 0.9833 0.9628 0.9653 0.9625
    AdversarialNet Acc 0.5358 Acc_avg 0.9698 Prec_avg 0.9636 Recall_avg 0.9589 F1_avg 0.9612
    Total Loss 0.8592 Global Cls Loss 0.0896 Local Cls Loss 0.0872 AFN Loss 0.0000 DAN Loss 0.6824

    [Test (Source Domain)]: 
    Data Time 0.2539 (0.0027)
    Batch Time 17.4874 (0.1860)
    Accuracy 0.7361 0.7361 0.7361 0.7361 0.7361 0.7361 0.7361
    Precision 0.9265 0.4505 0.5047 0.8206 0.5674 0.7748 0.7245
    Recall 0.5815 0.6029 0.3418 0.9180 0.7248 0.5375 0.6536
    F1 0.7146 0.5157 0.4075 0.8666 0.6365 0.6347 0.6873
    Acc_avg 0.7361 Prec_avg 0.6813 Recall_avg 0.6229 F1_avg 0.6376
    Loss 2.0722

    [Test (Target Domain)]: 
    Data Time 1.3565 (0.0026)
    Batch Time 93.9226 (0.1834)
    Accuracy 0.7765 0.7765 0.7765 0.7765 0.7765 0.7765 0.7765
    Precision 0.8205 0.3826 0.5794 0.9141 0.3421 0.8484 0.7512
    Recall 0.5556 0.1673 0.5306 0.9345 0.6870 0.5641 0.7521
    F1 0.6625 0.2328 0.5539 0.9242 0.4567 0.6776 0.7517
    Acc_avg 0.7765 Prec_avg 0.6626 Recall_avg 0.5987 F1_avg 0.6085
    Loss 1.9944

    [Tain]: 
    Epoch 32
    Data Time 6.7706 (0.0066)
    Batch Time 625.4729 (0.6114)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9731 0.9731 0.9731 0.9731 0.9731 0.9731 0.9731
    Precision 0.9746 0.9576 0.9566 0.9839 0.9682 0.9610 0.9651
    Recall 0.9740 0.9429 0.9444 0.9870 0.9672 0.9563 0.9668
    F1 0.9743 0.9502 0.9505 0.9855 0.9677 0.9587 0.9659
    AdversarialNet Acc 0.4814 Acc_avg 0.9731 Prec_avg 0.9667 Recall_avg 0.9627 F1_avg 0.9647
    Total Loss 0.8787 Global Cls Loss 0.0834 Local Cls Loss 0.0796 AFN Loss 0.0000 DAN Loss 0.7157

    [Test (Source Domain)]: 
    Data Time 0.3344 (0.0036)
    Batch Time 19.0292 (0.2024)
    Accuracy 0.7193 0.7193 0.7193 0.7193 0.7193 0.7193 0.7193
    Precision 0.8233 0.3077 0.3497 0.9214 0.5954 0.6624 0.6714
    Recall 0.6308 0.6471 0.4051 0.8113 0.6980 0.6500 0.7139
    F1 0.7143 0.4171 0.3754 0.8629 0.6426 0.6562 0.6920
    Acc_avg 0.7193 Prec_avg 0.6188 Recall_avg 0.6509 F1_avg 0.6229
    Loss 2.2093

    [Test (Target Domain)]: 
    Data Time 1.3562 (0.0026)
    Batch Time 100.4472 (0.1962)
    Accuracy 0.7842 0.7842 0.7842 0.7842 0.7842 0.7842 0.7842
    Precision 0.7463 0.3922 0.5559 0.9492 0.3488 0.8048 0.7561
    Recall 0.6484 0.1521 0.5935 0.9097 0.6670 0.6782 0.7651
    F1 0.6939 0.2192 0.5741 0.9290 0.4580 0.7361 0.7606
    Acc_avg 0.7842 Prec_avg 0.6505 Recall_avg 0.6306 F1_avg 0.6244
    Loss 1.8438
[Save] Best Recall: 0.6306.

    [Tain]: 
    Epoch 33
    Data Time 6.8343 (0.0067)
    Batch Time 601.0264 (0.5875)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9738 0.9738 0.9738 0.9738 0.9738 0.9738 0.9738
    Precision 0.9750 0.9531 0.9542 0.9851 0.9671 0.9653 0.9669
    Recall 0.9699 0.9424 0.9463 0.9885 0.9671 0.9648 0.9667
    F1 0.9725 0.9477 0.9502 0.9868 0.9671 0.9651 0.9668
    AdversarialNet Acc 0.5666 Acc_avg 0.9738 Prec_avg 0.9667 Recall_avg 0.9637 F1_avg 0.9652
    Total Loss 0.8441 Global Cls Loss 0.0842 Local Cls Loss 0.0821 AFN Loss 0.0000 DAN Loss 0.6778

    [Test (Source Domain)]: 
    Data Time 0.3121 (0.0033)
    Batch Time 17.4405 (0.1855)
    Accuracy 0.7304 0.7304 0.7304 0.7304 0.7304 0.7304 0.7304
    Precision 0.8739 0.3908 0.3854 0.8478 0.5855 0.7639 0.7225
    Recall 0.5969 0.5000 0.5000 0.8992 0.7047 0.6875 0.6039
    F1 0.7093 0.4387 0.4353 0.8728 0.6396 0.7237 0.6579
    Acc_avg 0.7304 Prec_avg 0.6528 Recall_avg 0.6418 F1_avg 0.6396
    Loss 2.0686

    [Test (Target Domain)]: 
    Data Time 1.4180 (0.0028)
    Batch Time 95.6641 (0.1868)
    Accuracy 0.7965 0.7965 0.7965 0.7965 0.7965 0.7965 0.7965
    Precision 0.7324 0.3459 0.5975 0.9159 0.3796 0.8046 0.7864
    Recall 0.6155 0.1217 0.6102 0.9524 0.5701 0.7356 0.7443
    F1 0.6689 0.1800 0.6038 0.9338 0.4558 0.7686 0.7648
    Acc_avg 0.7965 Prec_avg 0.6518 Recall_avg 0.6214 F1_avg 0.6251
    Loss 1.6061
[Save] Best Accuracy: 0.7965.

    [Tain]: 
    Epoch 34
    Data Time 6.2240 (0.0061)
    Batch Time 594.0930 (0.5807)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9790 0.9790 0.9790 0.9790 0.9790 0.9790 0.9790
    Precision 0.9789 0.9762 0.9711 0.9876 0.9706 0.9747 0.9731
    Recall 0.9775 0.9668 0.9554 0.9896 0.9717 0.9726 0.9754
    F1 0.9782 0.9715 0.9632 0.9886 0.9711 0.9737 0.9742
    AdversarialNet Acc 0.5351 Acc_avg 0.9790 Prec_avg 0.9760 Recall_avg 0.9727 F1_avg 0.9744
    Total Loss 0.8246 Global Cls Loss 0.0641 Local Cls Loss 0.0642 AFN Loss 0.0000 DAN Loss 0.6962

    [Test (Source Domain)]: 
    Data Time 0.2865 (0.0030)
    Batch Time 17.3907 (0.1850)
    Accuracy 0.7364 0.7364 0.7364 0.7364 0.7364 0.7364 0.7364
    Precision 0.8630 0.4141 0.4225 0.8444 0.5759 0.7724 0.7424
    Recall 0.5815 0.6029 0.3797 0.8941 0.7472 0.5938 0.6596
    F1 0.6949 0.4910 0.4000 0.8685 0.6504 0.6714 0.6986
    Acc_avg 0.7364 Prec_avg 0.6621 Recall_avg 0.6370 F1_avg 0.6393
    Loss 2.0043

    [Test (Target Domain)]: 
    Data Time 1.3930 (0.0027)
    Batch Time 94.4701 (0.1845)
    Accuracy 0.8012 0.8012 0.8012 0.8012 0.8012 0.8012 0.8012
    Precision 0.7783 0.4897 0.6175 0.9182 0.3815 0.8484 0.7818
    Recall 0.6276 0.1350 0.6157 0.9530 0.6428 0.6481 0.7651
    F1 0.6949 0.2116 0.6166 0.9353 0.4788 0.7348 0.7734
    Acc_avg 0.8012 Prec_avg 0.6879 Recall_avg 0.6268 F1_avg 0.6351
    Loss 1.7865
[Save] Best Accuracy: 0.8012.

    [Tain]: 
    Epoch 35
    Data Time 6.4965 (0.0064)
    Batch Time 596.3617 (0.5830)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9809 0.9809 0.9809 0.9809 0.9809 0.9809 0.9809
    Precision 0.9804 0.9622 0.9690 0.9882 0.9760 0.9829 0.9758
    Recall 0.9789 0.9568 0.9626 0.9903 0.9762 0.9766 0.9767
    F1 0.9796 0.9595 0.9658 0.9892 0.9761 0.9797 0.9762
    AdversarialNet Acc 0.5334 Acc_avg 0.9809 Prec_avg 0.9764 Recall_avg 0.9740 F1_avg 0.9752
    Total Loss 0.8126 Global Cls Loss 0.0596 Local Cls Loss 0.0584 AFN Loss 0.0000 DAN Loss 0.6947

    [Test (Source Domain)]: 
    Data Time 0.2934 (0.0031)
    Batch Time 17.4996 (0.1862)
    Accuracy 0.7508 0.7508 0.7508 0.7508 0.7508 0.7508 0.7508
    Precision 0.8498 0.4000 0.4667 0.8406 0.6519 0.7014 0.7300
    Recall 0.6092 0.6176 0.3544 0.9189 0.6913 0.6312 0.7003
    F1 0.7097 0.4855 0.4029 0.8780 0.6710 0.6645 0.7148
    Acc_avg 0.7508 Prec_avg 0.6629 Recall_avg 0.6461 F1_avg 0.6466
    Loss 1.9375

    [Test (Target Domain)]: 
    Data Time 1.4093 (0.0028)
    Batch Time 94.4740 (0.1845)
    Accuracy 0.7924 0.7924 0.7924 0.7924 0.7924 0.7924 0.7924
    Precision 0.8250 0.4815 0.6581 0.9410 0.3657 0.8000 0.7098
    Recall 0.5564 0.0989 0.4741 0.9180 0.6228 0.7462 0.8472
    F1 0.6646 0.1640 0.5511 0.9293 0.4608 0.7722 0.7724
    Acc_avg 0.7924 Prec_avg 0.6830 Recall_avg 0.6091 F1_avg 0.6164
    Loss 2.0807

    [Tain]: 
    Epoch 36
    Data Time 7.0353 (0.0069)
    Batch Time 660.6474 (0.6458)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9817 0.9817 0.9817 0.9817 0.9817 0.9817 0.9817
    Precision 0.9820 0.9744 0.9736 0.9878 0.9770 0.9822 0.9763
    Recall 0.9788 0.9621 0.9656 0.9916 0.9740 0.9801 0.9773
    F1 0.9804 0.9682 0.9696 0.9897 0.9755 0.9811 0.9768
    AdversarialNet Acc 0.5397 Acc_avg 0.9817 Prec_avg 0.9790 Recall_avg 0.9756 F1_avg 0.9773
    Total Loss 0.7980 Global Cls Loss 0.0543 Local Cls Loss 0.0538 AFN Loss 0.0000 DAN Loss 0.6900

    [Test (Source Domain)]: 
    Data Time 0.2530 (0.0027)
    Batch Time 17.5353 (0.1865)
    Accuracy 0.7464 0.7464 0.7464 0.7464 0.7464 0.7464 0.7464
    Precision 0.8266 0.6585 0.4322 0.8287 0.6019 0.6897 0.7458
    Recall 0.6892 0.3971 0.3228 0.9086 0.7271 0.6250 0.6672
    F1 0.7517 0.4954 0.3696 0.8668 0.6586 0.6557 0.7043
    Acc_avg 0.7464 Prec_avg 0.6833 Recall_avg 0.6196 F1_avg 0.6431
    Loss 1.9388

    [Test (Target Domain)]: 
    Data Time 1.4101 (0.0028)
    Batch Time 107.4353 (0.2098)
    Accuracy 0.7827 0.7827 0.7827 0.7827 0.7827 0.7827 0.7827
    Precision 0.7223 0.4795 0.6254 0.9552 0.3448 0.8004 0.7203
    Recall 0.6840 0.0665 0.5194 0.8948 0.6839 0.7374 0.7912
    F1 0.7026 0.1169 0.5675 0.9240 0.4585 0.7676 0.7541
    Acc_avg 0.7827 Prec_avg 0.6640 Recall_avg 0.6253 F1_avg 0.6130
    Loss 2.3386

    [Tain]: 
    Epoch 37
    Data Time 6.2499 (0.0061)
    Batch Time 612.0233 (0.5983)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9866 0.9866 0.9866 0.9866 0.9866 0.9866 0.9866
    Precision 0.9874 0.9793 0.9792 0.9913 0.9827 0.9875 0.9829
    Recall 0.9837 0.9753 0.9767 0.9932 0.9825 0.9817 0.9840
    F1 0.9856 0.9773 0.9779 0.9923 0.9826 0.9846 0.9835
    AdversarialNet Acc 0.5415 Acc_avg 0.9866 Prec_avg 0.9843 Recall_avg 0.9824 F1_avg 0.9834
    Total Loss 0.7708 Global Cls Loss 0.0401 Local Cls Loss 0.0416 AFN Loss 0.0000 DAN Loss 0.6891

    [Test (Source Domain)]: 
    Data Time 0.2999 (0.0032)
    Batch Time 17.4887 (0.1860)
    Accuracy 0.7518 0.7518 0.7518 0.7518 0.7518 0.7518 0.7518
    Precision 0.9039 0.5781 0.4027 0.8198 0.6373 0.7405 0.7414
    Recall 0.6369 0.5441 0.3797 0.9325 0.6801 0.6062 0.6822
    F1 0.7473 0.5606 0.3909 0.8726 0.6580 0.6667 0.7106
    Acc_avg 0.7518 Prec_avg 0.6891 Recall_avg 0.6374 F1_avg 0.6581
    Loss 1.8077

    [Test (Target Domain)]: 
    Data Time 1.4121 (0.0028)
    Batch Time 94.6413 (0.1848)
    Accuracy 0.7885 0.7885 0.7885 0.7885 0.7885 0.7885 0.7885
    Precision 0.7881 0.4130 0.5691 0.9489 0.3250 0.8463 0.7906
    Recall 0.6233 0.0722 0.6713 0.9178 0.7229 0.7109 0.7379
    F1 0.6961 0.1230 0.6160 0.9331 0.4484 0.7727 0.7633
    Acc_avg 0.7885 Prec_avg 0.6687 Recall_avg 0.6366 F1_avg 0.6218
    Loss 2.7519
[Save] Best Recall: 0.6366.

    [Tain]: 
    Epoch 38
    Data Time 6.9977 (0.0068)
    Batch Time 595.2442 (0.5819)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9840 0.9840 0.9840 0.9840 0.9840 0.9840 0.9840
    Precision 0.9856 0.9723 0.9756 0.9904 0.9779 0.9893 0.9778
    Recall 0.9824 0.9696 0.9731 0.9923 0.9779 0.9835 0.9785
    F1 0.9840 0.9709 0.9744 0.9914 0.9779 0.9864 0.9781
    AdversarialNet Acc 0.5569 Acc_avg 0.9840 Prec_avg 0.9813 Recall_avg 0.9796 F1_avg 0.9804
    Total Loss 0.7746 Global Cls Loss 0.0451 Local Cls Loss 0.0455 AFN Loss 0.0000 DAN Loss 0.6840

    [Test (Source Domain)]: 
    Data Time 0.2833 (0.0030)
    Batch Time 17.5579 (0.1868)
    Accuracy 0.7551 0.7551 0.7551 0.7551 0.7551 0.7551 0.7551
    Precision 0.8667 0.5538 0.4403 0.8174 0.6721 0.6797 0.7425
    Recall 0.6800 0.5294 0.3734 0.9214 0.6510 0.6500 0.7078
    F1 0.7621 0.5414 0.4041 0.8663 0.6614 0.6645 0.7247
    Acc_avg 0.7551 Prec_avg 0.6818 Recall_avg 0.6447 F1_avg 0.6606
    Loss 1.8827

    [Test (Target Domain)]: 
    Data Time 1.3685 (0.0027)
    Batch Time 94.7067 (0.1850)
    Accuracy 0.7947 0.7947 0.7947 0.7947 0.7947 0.7947 0.7947
    Precision 0.7641 0.4319 0.5980 0.9509 0.3763 0.8188 0.7397
    Recall 0.6128 0.1749 0.5620 0.9079 0.6428 0.6994 0.8336
    F1 0.6802 0.2490 0.5795 0.9289 0.4747 0.7544 0.7838
    Acc_avg 0.7947 Prec_avg 0.6685 Recall_avg 0.6334 F1_avg 0.6358
    Loss 2.2060

    [Tain]: 
    Epoch 39
    Data Time 6.3638 (0.0062)
    Batch Time 596.1764 (0.5828)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9847 0.9847 0.9847 0.9847 0.9847 0.9847 0.9847
    Precision 0.9843 0.9830 0.9745 0.9902 0.9829 0.9851 0.9788
    Recall 0.9837 0.9692 0.9690 0.9923 0.9808 0.9840 0.9801
    F1 0.9840 0.9760 0.9718 0.9913 0.9818 0.9846 0.9795
    AdversarialNet Acc 0.5582 Acc_avg 0.9847 Prec_avg 0.9827 Recall_avg 0.9799 F1_avg 0.9813
    Total Loss 0.7779 Global Cls Loss 0.0469 Local Cls Loss 0.0467 AFN Loss 0.0000 DAN Loss 0.6842

    [Test (Source Domain)]: 
    Data Time 0.2903 (0.0031)
    Batch Time 17.5877 (0.1871)
    Accuracy 0.7427 0.7427 0.7427 0.7427 0.7427 0.7427 0.7427
    Precision 0.8484 0.5556 0.4331 0.8053 0.6138 0.6933 0.7687
    Recall 0.6369 0.4412 0.3481 0.9257 0.7181 0.6500 0.6355
    F1 0.7276 0.4918 0.3860 0.8613 0.6619 0.6710 0.6958
    Acc_avg 0.7427 Prec_avg 0.6740 Recall_avg 0.6222 F1_avg 0.6422
    Loss 1.8963

    [Test (Target Domain)]: 
    Data Time 1.3701 (0.0027)
    Batch Time 94.4160 (0.1844)
    Accuracy 0.7916 0.7916 0.7916 0.7916 0.7916 0.7916 0.7916
    Precision 0.6937 0.4628 0.6053 0.9327 0.3464 0.8328 0.7934
    Recall 0.6979 0.1654 0.6120 0.9278 0.6407 0.7047 0.7338
    F1 0.6958 0.2437 0.6087 0.9303 0.4497 0.7634 0.7624
    Acc_avg 0.7916 Prec_avg 0.6667 Recall_avg 0.6403 F1_avg 0.6363
    Loss 2.0847
[Save] Best Recall: 0.6403.
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 87.218805s
 train target dataset qty: 32757
 train target dataset dist: 2303, 1053, 2158, 15871, 1898, 2262, 7212
[Target Domain] Cost time : 203.465579s
TransferToTargetDomain.py:172: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():

    [Tain]: 
    Epoch 40
    Data Time 6.2881 (0.0061)
    Batch Time 636.3320 (0.6220)
    Learning Rate 0.0001 Learning Rate(AdversarialNet) 0.0001
    Accuracy 0.9823 0.9823 0.9823 0.9823 0.9823 0.9823 0.9823
    Precision 0.9822 0.9782 0.9715 0.9886 0.9784 0.9802 0.9774
    Recall 0.9805 0.9683 0.9636 0.9912 0.9778 0.9739 0.9788
    F1 0.9814 0.9732 0.9675 0.9899 0.9781 0.9770 0.9781
    AdversarialNet Acc 0.5435 Acc_avg 0.9823 Prec_avg 0.9795 Recall_avg 0.9763 F1_avg 0.9779
    Total Loss 0.7947 Global Cls Loss 0.0539 Local Cls Loss 0.0535 AFN Loss 0.0000 DAN Loss 0.6873

    [Test (Source Domain)]: 
    Data Time 0.2958 (0.0031)
    Batch Time 19.9819 (0.2126)
    Accuracy 0.7551 0.7551 0.7551 0.7551 0.7551 0.7551 0.7551
    Precision 0.7726 0.5000 0.3795 0.8840 0.6840 0.6221 0.7630
    Recall 0.7631 0.5441 0.5380 0.8787 0.7360 0.6687 0.6401
    F1 0.7678 0.5211 0.4450 0.8814 0.7091 0.6446 0.6962
    Acc_avg 0.7551 Prec_avg 0.6579 Recall_avg 0.6812 F1_avg 0.6664
    Loss 1.9118

    [Test (Target Domain)]: 
    Data Time 1.4764 (0.0029)
    Batch Time 104.9316 (0.2049)
    Accuracy 0.7887 0.7887 0.7887 0.7887 0.7887 0.7887 0.7887
    Precision 0.7080 0.4609 0.5771 0.8835 0.3555 0.8863 0.8403
    Recall 0.7092 0.1122 0.5824 0.9685 0.5911 0.5447 0.7074
    F1 0.7086 0.1804 0.5797 0.9241 0.4440 0.6747 0.7681
    Acc_avg 0.7887 Prec_avg 0.6731 Recall_avg 0.6022 F1_avg 0.6114
    Loss 1.6613

    [Tain]: 
    Epoch 41
    Data Time 7.5188 (0.0073)
    Batch Time 672.7126 (0.6576)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9905 0.9905 0.9905 0.9905 0.9905 0.9905 0.9905
    Precision 0.9918 0.9874 0.9830 0.9937 0.9901 0.9862 0.9877
    Recall 0.9895 0.9832 0.9815 0.9955 0.9869 0.9862 0.9889
    F1 0.9907 0.9853 0.9823 0.9946 0.9885 0.9862 0.9883
    AdversarialNet Acc 0.5567 Acc_avg 0.9905 Prec_avg 0.9886 Recall_avg 0.9874 F1_avg 0.9880
    Total Loss 0.7424 Global Cls Loss 0.0284 Local Cls Loss 0.0307 AFN Loss 0.0000 DAN Loss 0.6834

    [Test (Source Domain)]: 
    Data Time 0.2953 (0.0031)
    Batch Time 19.7833 (0.2105)
    Accuracy 0.7765 0.7765 0.7765 0.7765 0.7765 0.7765 0.7765
    Precision 0.8045 0.5873 0.4340 0.8767 0.7033 0.6970 0.7496
    Recall 0.7723 0.5441 0.4367 0.9044 0.7159 0.7188 0.7123
    F1 0.7881 0.5649 0.4353 0.8903 0.7095 0.7077 0.7305
    Acc_avg 0.7765 Prec_avg 0.6932 Recall_avg 0.6864 F1_avg 0.6895
    Loss 1.6743

    [Test (Target Domain)]: 
    Data Time 1.4091 (0.0028)
    Batch Time 112.6851 (0.2201)
    Accuracy 0.7971 0.7971 0.7971 0.7971 0.7971 0.7971 0.7971
    Precision 0.7436 0.4797 0.6164 0.8967 0.3587 0.8648 0.8223
    Recall 0.6849 0.1122 0.5417 0.9638 0.6207 0.6110 0.7471
    F1 0.7131 0.1818 0.5766 0.9291 0.4547 0.7161 0.7829
    Acc_avg 0.7971 Prec_avg 0.6832 Recall_avg 0.6116 F1_avg 0.6220
    Loss 1.6820

    [Tain]: 
    Epoch 42
    Data Time 6.2442 (0.0061)
    Batch Time 645.9348 (0.6314)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9947 0.9947 0.9947 0.9947 0.9947 0.9947 0.9947
    Precision 0.9933 0.9945 0.9928 0.9963 0.9950 0.9930 0.9930
    Recall 0.9927 0.9835 0.9897 0.9982 0.9921 0.9930 0.9939
    F1 0.9930 0.9890 0.9913 0.9972 0.9935 0.9930 0.9934
    AdversarialNet Acc 0.5586 Acc_avg 0.9947 Prec_avg 0.9940 Recall_avg 0.9919 F1_avg 0.9929
    Total Loss 0.7194 Global Cls Loss 0.0166 Local Cls Loss 0.0188 AFN Loss 0.0000 DAN Loss 0.6840

    [Test (Source Domain)]: 
    Data Time 0.2714 (0.0029)
    Batch Time 17.8131 (0.1895)
    Accuracy 0.7761 0.7761 0.7761 0.7761 0.7761 0.7761 0.7761
    Precision 0.8206 0.5507 0.4393 0.8925 0.6844 0.6975 0.7488
    Recall 0.7600 0.5588 0.4810 0.8864 0.7472 0.7063 0.7184
    F1 0.7891 0.5547 0.4592 0.8895 0.7144 0.7019 0.7333
    Acc_avg 0.7761 Prec_avg 0.6906 Recall_avg 0.6940 F1_avg 0.6917
    Loss 1.6934

    [Test (Target Domain)]: 
    Data Time 1.4161 (0.0028)
    Batch Time 94.0283 (0.1836)
    Accuracy 0.7982 0.7982 0.7982 0.7982 0.7982 0.7982 0.7982
    Precision 0.7451 0.4839 0.6319 0.9022 0.3530 0.8912 0.8109
    Recall 0.6901 0.1141 0.5324 0.9621 0.6238 0.5942 0.7612
    F1 0.7165 0.1846 0.5779 0.9312 0.4509 0.7130 0.7853
    Acc_avg 0.7982 Prec_avg 0.6883 Recall_avg 0.6111 F1_avg 0.6228
    Loss 1.6961

    [Tain]: 
    Epoch 43
    Data Time 6.3764 (0.0062)
    Batch Time 631.2838 (0.6171)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9956 0.9956 0.9956 0.9956 0.9956 0.9956 0.9956
    Precision 0.9945 0.9958 0.9913 0.9978 0.9943 0.9963 0.9941
    Recall 0.9942 0.9915 0.9893 0.9979 0.9957 0.9952 0.9944
    F1 0.9943 0.9936 0.9903 0.9979 0.9950 0.9957 0.9942
    AdversarialNet Acc 0.5568 Acc_avg 0.9956 Prec_avg 0.9949 Recall_avg 0.9940 F1_avg 0.9944
    Total Loss 0.7159 Global Cls Loss 0.0138 Local Cls Loss 0.0162 AFN Loss 0.0000 DAN Loss 0.6860

    [Test (Source Domain)]: 
    Data Time 0.2858 (0.0030)
    Batch Time 20.7307 (0.2205)
    Accuracy 0.7785 0.7785 0.7785 0.7785 0.7785 0.7785 0.7785
    Precision 0.8339 0.5672 0.4253 0.8826 0.6928 0.7091 0.7590
    Recall 0.7569 0.5588 0.4684 0.8992 0.7517 0.7312 0.7018
    F1 0.7935 0.5630 0.4458 0.8909 0.7210 0.7200 0.7293
    Acc_avg 0.7785 Prec_avg 0.6957 Recall_avg 0.6954 F1_avg 0.6948
    Loss 1.6963

    [Test (Target Domain)]: 
    Data Time 1.3826 (0.0027)
    Batch Time 107.2514 (0.2095)
    Accuracy 0.8021 0.8021 0.8021 0.8021 0.8021 0.8021 0.8021
    Precision 0.7625 0.4924 0.6279 0.8968 0.3720 0.8824 0.8150
    Recall 0.6745 0.1236 0.5704 0.9667 0.6048 0.6101 0.7612
    F1 0.7158 0.1976 0.5978 0.9304 0.4607 0.7214 0.7872
    Acc_avg 0.8021 Prec_avg 0.6927 Recall_avg 0.6159 F1_avg 0.6301
    Loss 1.6594
[Save] Best Accuracy: 0.8021.

    [Tain]: 
    Epoch 44
    Data Time 6.1870 (0.0060)
    Batch Time 643.3897 (0.6289)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9961 0.9961 0.9961 0.9961 0.9961 0.9961 0.9961
    Precision 0.9962 0.9986 0.9938 0.9976 0.9951 0.9973 0.9941
    Recall 0.9948 0.9889 0.9897 0.9979 0.9955 0.9984 0.9959
    F1 0.9955 0.9937 0.9918 0.9977 0.9953 0.9978 0.9950
    AdversarialNet Acc 0.5563 Acc_avg 0.9961 Prec_avg 0.9961 Recall_avg 0.9944 F1_avg 0.9953
    Total Loss 0.7119 Global Cls Loss 0.0117 Local Cls Loss 0.0137 AFN Loss 0.0000 DAN Loss 0.6865

    [Test (Source Domain)]: 
    Data Time 0.2710 (0.0029)
    Batch Time 17.6420 (0.1877)
    Accuracy 0.7822 0.7822 0.7822 0.7822 0.7822 0.7822 0.7822
    Precision 0.8167 0.5352 0.4311 0.8880 0.7092 0.7048 0.7624
    Recall 0.7538 0.5588 0.4557 0.9009 0.7584 0.7312 0.7154
    F1 0.7840 0.5468 0.4431 0.8944 0.7330 0.7178 0.7382
    Acc_avg 0.7822 Prec_avg 0.6925 Recall_avg 0.6963 F1_avg 0.6939
    Loss 1.6719

    [Test (Target Domain)]: 
    Data Time 1.4145 (0.0028)
    Batch Time 104.6963 (0.2045)
    Accuracy 0.8046 0.8046 0.8046 0.8046 0.8046 0.8046 0.8046
    Precision 0.7726 0.5224 0.6546 0.9080 0.3678 0.8753 0.7949
    Recall 0.6667 0.1331 0.5370 0.9603 0.6112 0.6331 0.7887
    F1 0.7158 0.2121 0.5900 0.9334 0.4592 0.7347 0.7918
    Acc_avg 0.8046 Prec_avg 0.6994 Recall_avg 0.6186 F1_avg 0.6339
    Loss 1.6857
[Save] Best Accuracy: 0.8046.

    [Tain]: 
    Epoch 45
    Data Time 6.5060 (0.0064)
    Batch Time 659.7390 (0.6449)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9963 0.9963 0.9963 0.9963 0.9963 0.9963 0.9963
    Precision 0.9971 0.9957 0.9954 0.9967 0.9957 0.9973 0.9955
    Recall 0.9948 0.9929 0.9913 0.9984 0.9957 0.9952 0.9957
    F1 0.9960 0.9943 0.9933 0.9976 0.9957 0.9963 0.9956
    AdversarialNet Acc 0.5462 Acc_avg 0.9963 Prec_avg 0.9962 Recall_avg 0.9949 F1_avg 0.9955
    Total Loss 0.7111 Global Cls Loss 0.0103 Local Cls Loss 0.0122 AFN Loss 0.0000 DAN Loss 0.6887

    [Test (Source Domain)]: 
    Data Time 0.2519 (0.0027)
    Batch Time 18.0080 (0.1916)
    Accuracy 0.7795 0.7795 0.7795 0.7795 0.7795 0.7795 0.7795
    Precision 0.8139 0.5781 0.4342 0.8898 0.6848 0.6923 0.7565
    Recall 0.7938 0.5441 0.4177 0.8967 0.7584 0.7312 0.7018
    F1 0.8037 0.5606 0.4258 0.8932 0.7197 0.7112 0.7281
    Acc_avg 0.7795 Prec_avg 0.6928 Recall_avg 0.6920 F1_avg 0.6918
    Loss 1.7242

    [Test (Target Domain)]: 
    Data Time 1.4381 (0.0028)
    Batch Time 109.2282 (0.2133)
    Accuracy 0.8050 0.8050 0.8050 0.8050 0.8050 0.8050 0.8050
    Precision 0.7662 0.5135 0.6459 0.9136 0.3610 0.8690 0.8037
    Recall 0.6884 0.1445 0.5574 0.9572 0.6185 0.6569 0.7734
    F1 0.7252 0.2255 0.5984 0.9349 0.4559 0.7482 0.7883
    Acc_avg 0.8050 Prec_avg 0.6961 Recall_avg 0.6280 F1_avg 0.6395
    Loss 1.7059
[Save] Best Accuracy: 0.8050.

    [Tain]: 
    Epoch 46
    Data Time 6.5389 (0.0064)
    Batch Time 651.1421 (0.6365)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9975 0.9975 0.9975 0.9975 0.9975 0.9975 0.9975
    Precision 0.9974 1.0000 0.9964 0.9978 0.9981 0.9968 0.9967
    Recall 0.9974 0.9889 0.9923 0.9990 0.9969 0.9968 0.9978
    F1 0.9974 0.9944 0.9943 0.9984 0.9975 0.9968 0.9973
    AdversarialNet Acc 0.5472 Acc_avg 0.9975 Prec_avg 0.9976 Recall_avg 0.9956 F1_avg 0.9966
    Total Loss 0.7084 Global Cls Loss 0.0085 Local Cls Loss 0.0100 AFN Loss 0.0000 DAN Loss 0.6898

    [Test (Source Domain)]: 
    Data Time 0.2866 (0.0030)
    Batch Time 19.2756 (0.2051)
    Accuracy 0.7795 0.7795 0.7795 0.7795 0.7795 0.7795 0.7795
    Precision 0.8328 0.5135 0.4260 0.9032 0.6880 0.7048 0.7484
    Recall 0.7508 0.5588 0.4557 0.8847 0.7696 0.7312 0.7259
    F1 0.7896 0.5352 0.4404 0.8939 0.7265 0.7178 0.7370
    Acc_avg 0.7795 Prec_avg 0.6881 Recall_avg 0.6967 F1_avg 0.6915
    Loss 1.7567

    [Test (Target Domain)]: 
    Data Time 1.3633 (0.0027)
    Batch Time 93.9417 (0.1835)
    Accuracy 0.8027 0.8027 0.8027 0.8027 0.8027 0.8027 0.8027
    Precision 0.7744 0.5137 0.6270 0.9163 0.3563 0.8914 0.8014
    Recall 0.6615 0.1426 0.5667 0.9559 0.6428 0.6172 0.7779
    F1 0.7135 0.2232 0.5953 0.9357 0.4585 0.7294 0.7895
    Acc_avg 0.8027 Prec_avg 0.6972 Recall_avg 0.6235 F1_avg 0.6350
    Loss 1.7532

    [Tain]: 
    Epoch 47
    Data Time 6.4896 (0.0063)
    Batch Time 656.2633 (0.6415)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9969 0.9969 0.9969 0.9969 0.9969 0.9969 0.9969
    Precision 0.9954 0.9986 0.9964 0.9975 0.9973 0.9984 0.9958
    Recall 0.9980 0.9958 0.9938 0.9987 0.9950 0.9968 0.9955
    F1 0.9967 0.9972 0.9951 0.9981 0.9961 0.9976 0.9957
    AdversarialNet Acc 0.5437 Acc_avg 0.9969 Prec_avg 0.9971 Recall_avg 0.9962 F1_avg 0.9966
    Total Loss 0.7105 Global Cls Loss 0.0090 Local Cls Loss 0.0103 AFN Loss 0.0000 DAN Loss 0.6912

    [Test (Source Domain)]: 
    Data Time 0.3506 (0.0037)
    Batch Time 20.1741 (0.2146)
    Accuracy 0.7855 0.7855 0.7855 0.7855 0.7855 0.7855 0.7855
    Precision 0.8456 0.5286 0.4452 0.9021 0.7095 0.7006 0.7412
    Recall 0.7415 0.5441 0.4367 0.8890 0.7651 0.7312 0.7590
    F1 0.7902 0.5362 0.4409 0.8955 0.7363 0.7156 0.7500
    Acc_avg 0.7855 Prec_avg 0.6961 Recall_avg 0.6952 F1_avg 0.6949
    Loss 1.7987

    [Test (Target Domain)]: 
    Data Time 1.4089 (0.0028)
    Batch Time 112.7163 (0.2201)
    Accuracy 0.8071 0.8071 0.8071 0.8071 0.8071 0.8071 0.8071
    Precision 0.7669 0.5441 0.6194 0.9141 0.3721 0.8847 0.8046
    Recall 0.6684 0.1407 0.5981 0.9578 0.6070 0.6446 0.7831
    F1 0.7143 0.2236 0.6086 0.9355 0.4614 0.7458 0.7937
    Acc_avg 0.8071 Prec_avg 0.7008 Recall_avg 0.6285 F1_avg 0.6404
    Loss 1.6986
[Save] Best Accuracy: 0.8071.

    [Tain]: 
    Epoch 48
    Data Time 6.2119 (0.0061)
    Batch Time 621.2456 (0.6073)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9977 0.9977 0.9977 0.9977 0.9977 0.9977 0.9977
    Precision 0.9985 0.9972 0.9948 0.9980 0.9967 0.9979 0.9984
    Recall 0.9968 0.9945 0.9938 0.9992 0.9965 0.9979 0.9976
    F1 0.9977 0.9958 0.9943 0.9986 0.9966 0.9979 0.9980
    AdversarialNet Acc 0.5470 Acc_avg 0.9977 Prec_avg 0.9974 Recall_avg 0.9966 F1_avg 0.9970
    Total Loss 0.7068 Global Cls Loss 0.0070 Local Cls Loss 0.0082 AFN Loss 0.0000 DAN Loss 0.6916

    [Test (Source Domain)]: 
    Data Time 0.2698 (0.0029)
    Batch Time 17.9345 (0.1908)
    Accuracy 0.7721 0.7721 0.7721 0.7721 0.7721 0.7721 0.7721
    Precision 0.8345 0.5000 0.4083 0.9167 0.6783 0.6744 0.7277
    Recall 0.7292 0.5588 0.4367 0.8642 0.7830 0.7250 0.7364
    F1 0.7783 0.5278 0.4220 0.8897 0.7269 0.6988 0.7320
    Acc_avg 0.7721 Prec_avg 0.6771 Recall_avg 0.6905 F1_avg 0.6822
    Loss 1.9689

    [Test (Target Domain)]: 
    Data Time 1.4200 (0.0028)
    Batch Time 110.8164 (0.2164)
    Accuracy 0.8037 0.8037 0.8037 0.8037 0.8037 0.8037 0.8037
    Precision 0.7837 0.5690 0.6240 0.8933 0.3763 0.8831 0.8175
    Recall 0.6354 0.1255 0.5917 0.9689 0.6059 0.6348 0.7612
    F1 0.7018 0.2056 0.6074 0.9296 0.4643 0.7387 0.7883
    Acc_avg 0.8037 Prec_avg 0.7067 Recall_avg 0.6176 F1_avg 0.6337
    Loss 1.6860

    [Tain]: 
    Epoch 49
    Data Time 6.5838 (0.0064)
    Batch Time 668.4757 (0.6534)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9976 0.9976 0.9976 0.9976 0.9976 0.9976 0.9976
    Precision 0.9980 0.9986 0.9964 0.9982 0.9963 0.9979 0.9976
    Recall 0.9965 0.9945 0.9964 0.9986 0.9979 0.9984 0.9967
    F1 0.9972 0.9965 0.9964 0.9984 0.9971 0.9981 0.9972
    AdversarialNet Acc 0.5466 Acc_avg 0.9976 Prec_avg 0.9976 Recall_avg 0.9970 F1_avg 0.9973
    Total Loss 0.7061 Global Cls Loss 0.0068 Local Cls Loss 0.0079 AFN Loss 0.0000 DAN Loss 0.6915

    [Test (Source Domain)]: 
    Data Time 0.3026 (0.0032)
    Batch Time 19.9903 (0.2127)
    Accuracy 0.7775 0.7775 0.7775 0.7775 0.7775 0.7775 0.7775
    Precision 0.8493 0.5373 0.3946 0.9119 0.6911 0.6842 0.7414
    Recall 0.7108 0.5294 0.4620 0.8753 0.7808 0.7312 0.7470
    F1 0.7739 0.5333 0.4257 0.8932 0.7332 0.7069 0.7442
    Acc_avg 0.7775 Prec_avg 0.6871 Recall_avg 0.6909 F1_avg 0.6872
    Loss 1.9514

    [Test (Target Domain)]: 
    Data Time 1.4140 (0.0028)
    Batch Time 100.5116 (0.1963)
    Accuracy 0.8005 0.8005 0.8005 0.8005 0.8005 0.8005 0.8005
    Precision 0.8020 0.5565 0.6210 0.8957 0.3618 0.8933 0.8109
    Recall 0.6120 0.1217 0.5963 0.9666 0.6164 0.6145 0.7623
    F1 0.6942 0.1997 0.6084 0.9298 0.4560 0.7281 0.7859
    Acc_avg 0.8005 Prec_avg 0.7059 Recall_avg 0.6128 F1_avg 0.6289
    Loss 1.8099
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 87.263209s
 train target dataset qty: 32757
 train target dataset dist: 2303, 1053, 2158, 15871, 1898, 2262, 7212
[Target Domain] Cost time : 238.310525s
TransferToTargetDomain.py:172: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():

    [Tain]: 
    Epoch 50
    Data Time 6.5403 (0.0064)
    Batch Time 653.0616 (0.6384)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9974 0.9974 0.9974 0.9974 0.9974 0.9974 0.9974
    Precision 0.9980 0.9972 0.9918 0.9986 0.9969 0.9968 0.9970
    Recall 0.9974 0.9930 0.9964 0.9977 0.9975 0.9957 0.9979
    F1 0.9977 0.9951 0.9941 0.9982 0.9972 0.9962 0.9975
    AdversarialNet Acc 0.5616 Acc_avg 0.9974 Prec_avg 0.9966 Recall_avg 0.9965 F1_avg 0.9966
    Total Loss 0.7054 Global Cls Loss 0.0082 Local Cls Loss 0.0093 AFN Loss 0.0000 DAN Loss 0.6879

    [Test (Source Domain)]: 
    Data Time 0.2514 (0.0027)
    Batch Time 17.5999 (0.1872)
    Accuracy 0.7845 0.7845 0.7845 0.7845 0.7845 0.7845 0.7845
    Precision 0.8412 0.5833 0.4371 0.9142 0.6884 0.7143 0.7310
    Recall 0.7662 0.5147 0.4177 0.8736 0.7808 0.7188 0.7696
    F1 0.8019 0.5469 0.4272 0.8934 0.7317 0.7165 0.7498
    Acc_avg 0.7845 Prec_avg 0.7014 Recall_avg 0.6916 F1_avg 0.6953
    Loss 2.0105

    [Test (Target Domain)]: 
    Data Time 1.3733 (0.0027)
    Batch Time 99.6550 (0.1946)
    Accuracy 0.7995 0.7995 0.7995 0.7995 0.7995 0.7995 0.7995
    Precision 0.8035 0.6557 0.7815 0.8983 0.3921 0.8800 0.7226
    Recall 0.6033 0.0760 0.3444 0.9613 0.5669 0.6286 0.8627
    F1 0.6891 0.1363 0.4781 0.9287 0.4636 0.7334 0.7865
    Acc_avg 0.7995 Prec_avg 0.7334 Recall_avg 0.5776 F1_avg 0.6023
    Loss 1.9737

    [Tain]: 
    Epoch 51
    Data Time 6.0174 (0.0059)
    Batch Time 643.2539 (0.6288)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9978 0.9978 0.9978 0.9978 0.9978 0.9978 0.9978
    Precision 0.9974 0.9972 0.9964 0.9984 0.9971 0.9979 0.9978
    Recall 0.9974 0.9958 0.9949 0.9986 0.9981 0.9963 0.9978
    F1 0.9974 0.9965 0.9957 0.9985 0.9976 0.9971 0.9978
    AdversarialNet Acc 0.5807 Acc_avg 0.9978 Prec_avg 0.9974 Recall_avg 0.9970 F1_avg 0.9972
    Total Loss 0.6965 Global Cls Loss 0.0063 Local Cls Loss 0.0074 AFN Loss 0.0000 DAN Loss 0.6828

    [Test (Source Domain)]: 
    Data Time 0.2775 (0.0030)
    Batch Time 18.0210 (0.1917)
    Accuracy 0.7802 0.7802 0.7802 0.7802 0.7802 0.7802 0.7802
    Precision 0.8345 0.5556 0.4107 0.9071 0.6926 0.7108 0.7356
    Recall 0.7446 0.5147 0.4367 0.8839 0.7562 0.7375 0.7500
    F1 0.7870 0.5344 0.4233 0.8953 0.7230 0.7239 0.7427
    Acc_avg 0.7802 Prec_avg 0.6924 Recall_avg 0.6891 F1_avg 0.6899
    Loss 1.9336

    [Test (Target Domain)]: 
    Data Time 1.3850 (0.0027)
    Batch Time 93.6316 (0.1829)
    Accuracy 0.8017 0.8017 0.8017 0.8017 0.8017 0.8017 0.8017
    Precision 0.8314 0.6897 0.7782 0.8900 0.3906 0.8514 0.7387
    Recall 0.5608 0.0760 0.3769 0.9713 0.5532 0.6684 0.8458
    F1 0.6698 0.1370 0.5078 0.9288 0.4579 0.7489 0.7886
    Acc_avg 0.8017 Prec_avg 0.7386 Recall_avg 0.5789 F1_avg 0.6055
    Loss 1.9397

    [Tain]: 
    Epoch 52
    Data Time 6.2986 (0.0062)
    Batch Time 655.0673 (0.6403)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9976 0.9976 0.9976 0.9976 0.9976 0.9976 0.9976
    Precision 0.9971 0.9972 0.9954 0.9980 0.9973 0.9984 0.9978
    Recall 0.9980 0.9889 0.9948 0.9987 0.9973 0.9984 0.9970
    F1 0.9975 0.9930 0.9951 0.9983 0.9973 0.9984 0.9974
    AdversarialNet Acc 0.5950 Acc_avg 0.9976 Prec_avg 0.9973 Recall_avg 0.9962 F1_avg 0.9967
    Total Loss 0.6934 Global Cls Loss 0.0076 Local Cls Loss 0.0083 AFN Loss 0.0000 DAN Loss 0.6775

    [Test (Source Domain)]: 
    Data Time 0.2631 (0.0028)
    Batch Time 17.4997 (0.1862)
    Accuracy 0.7745 0.7745 0.7745 0.7745 0.7745 0.7745 0.7745
    Precision 0.8191 0.5000 0.4342 0.9141 0.6573 0.7250 0.7353
    Recall 0.7662 0.5294 0.4177 0.8634 0.7852 0.7250 0.7364
    F1 0.7917 0.5143 0.4258 0.8880 0.7156 0.7250 0.7359
    Acc_avg 0.7745 Prec_avg 0.6836 Recall_avg 0.6890 F1_avg 0.6852
    Loss 1.9777

    [Test (Target Domain)]: 
    Data Time 1.3883 (0.0027)
    Batch Time 93.7322 (0.1831)
    Accuracy 0.7986 0.7986 0.7986 0.7986 0.7986 0.7986 0.7986
    Precision 0.8150 0.6786 0.7748 0.8850 0.3753 0.8649 0.7504
    Recall 0.5929 0.0722 0.3759 0.9732 0.5722 0.6340 0.8239
    F1 0.6864 0.1306 0.5062 0.9270 0.4533 0.7316 0.7855
    Acc_avg 0.7986 Prec_avg 0.7349 Recall_avg 0.5777 F1_avg 0.6029
    Loss 1.9248

    [Tain]: 
    Epoch 53
    Data Time 6.4510 (0.0063)
    Batch Time 624.6805 (0.6106)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9977 0.9977 0.9977 0.9977 0.9977 0.9977 0.9977
    Precision 0.9983 0.9972 0.9979 0.9981 0.9985 0.9963 0.9964
    Recall 0.9980 0.9930 0.9964 0.9984 0.9971 0.9963 0.9978
    F1 0.9981 0.9951 0.9972 0.9983 0.9978 0.9963 0.9971
    AdversarialNet Acc 0.6070 Acc_avg 0.9977 Prec_avg 0.9975 Recall_avg 0.9967 F1_avg 0.9971
    Total Loss 0.6886 Global Cls Loss 0.0069 Local Cls Loss 0.0076 AFN Loss 0.0000 DAN Loss 0.6740

    [Test (Source Domain)]: 
    Data Time 0.2618 (0.0028)
    Batch Time 17.3856 (0.1850)
    Accuracy 0.7781 0.7781 0.7781 0.7781 0.7781 0.7781 0.7781
    Precision 0.8407 0.5667 0.4414 0.9064 0.6635 0.6543 0.7496
    Recall 0.7631 0.5000 0.4051 0.8770 0.7852 0.7688 0.7259
    F1 0.8000 0.5312 0.4224 0.8915 0.7193 0.7069 0.7376
    Acc_avg 0.7781 Prec_avg 0.6889 Recall_avg 0.6893 F1_avg 0.6870
    Loss 1.9571

    [Test (Target Domain)]: 
    Data Time 1.3705 (0.0027)
    Batch Time 100.1634 (0.1956)
    Accuracy 0.8004 0.8004 0.8004 0.8004 0.8004 0.8004 0.8004
    Precision 0.8505 0.7234 0.7815 0.8872 0.3797 0.8529 0.7409
    Recall 0.5382 0.0646 0.3843 0.9720 0.5553 0.6923 0.8367
    F1 0.6592 0.1187 0.5152 0.9277 0.4510 0.7643 0.7859
    Acc_avg 0.8004 Prec_avg 0.7452 Recall_avg 0.5776 F1_avg 0.6031
    Loss 1.9797

    [Tain]: 
    Epoch 54
    Data Time 5.9575 (0.0058)
    Batch Time 627.5414 (0.6134)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9980 0.9980 0.9980 0.9980 0.9980 0.9980 0.9980
    Precision 0.9977 0.9931 0.9980 0.9981 0.9981 0.9984 0.9981
    Recall 0.9977 0.9959 0.9949 0.9991 0.9979 0.9963 0.9976
    F1 0.9977 0.9945 0.9964 0.9986 0.9980 0.9973 0.9978
    AdversarialNet Acc 0.6110 Acc_avg 0.9980 Prec_avg 0.9973 Recall_avg 0.9970 F1_avg 0.9972
    Total Loss 0.6843 Global Cls Loss 0.0062 Local Cls Loss 0.0072 AFN Loss 0.0000 DAN Loss 0.6709

    [Test (Source Domain)]: 
    Data Time 0.4105 (0.0044)
    Batch Time 19.0305 (0.2025)
    Accuracy 0.7755 0.7755 0.7755 0.7755 0.7755 0.7755 0.7755
    Precision 0.8403 0.5893 0.4286 0.9088 0.6737 0.6559 0.7325
    Recall 0.7446 0.4853 0.4177 0.8676 0.7808 0.7625 0.7425
    F1 0.7896 0.5323 0.4231 0.8877 0.7233 0.7052 0.7375
    Acc_avg 0.7755 Prec_avg 0.6899 Recall_avg 0.6859 F1_avg 0.6855
    Loss 1.9957

    [Test (Target Domain)]: 
    Data Time 1.3798 (0.0027)
    Batch Time 93.8185 (0.1832)
    Accuracy 0.7994 0.7994 0.7994 0.7994 0.7994 0.7994 0.7994
    Precision 0.8503 0.7895 0.7639 0.8884 0.3789 0.8567 0.7378
    Recall 0.5226 0.0570 0.4194 0.9715 0.5574 0.6764 0.8333
    F1 0.6473 0.1064 0.5415 0.9281 0.4512 0.7559 0.7827
    Acc_avg 0.7994 Prec_avg 0.7522 Recall_avg 0.5768 F1_avg 0.6019
    Loss 1.9686

    [Tain]: 
    Epoch 55
    Data Time 6.2174 (0.0061)
    Batch Time 630.6508 (0.6165)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9979 0.9979 0.9979 0.9979 0.9979 0.9979 0.9979
    Precision 0.9983 0.9986 0.9964 0.9980 0.9975 0.9979 0.9981
    Recall 0.9974 0.9901 0.9954 0.9994 0.9975 0.9973 0.9972
    F1 0.9978 0.9943 0.9959 0.9987 0.9975 0.9976 0.9976
    AdversarialNet Acc 0.6128 Acc_avg 0.9979 Prec_avg 0.9978 Recall_avg 0.9963 F1_avg 0.9971
    Total Loss 0.6850 Global Cls Loss 0.0066 Local Cls Loss 0.0077 AFN Loss 0.0000 DAN Loss 0.6707

    [Test (Source Domain)]: 
    Data Time 0.2704 (0.0029)
    Batch Time 20.8725 (0.2220)
    Accuracy 0.7761 0.7761 0.7761 0.7761 0.7761 0.7761 0.7761
    Precision 0.8571 0.5763 0.4514 0.9098 0.6679 0.6901 0.7165
    Recall 0.7200 0.5000 0.4114 0.8702 0.7830 0.7375 0.7575
    F1 0.7826 0.5354 0.4305 0.8896 0.7209 0.7130 0.7365
    Acc_avg 0.7761 Prec_avg 0.6956 Recall_avg 0.6828 F1_avg 0.6869
    Loss 1.9669

    [Test (Target Domain)]: 
    Data Time 1.3797 (0.0027)
    Batch Time 94.8758 (0.1853)
    Accuracy 0.7966 0.7966 0.7966 0.7966 0.7966 0.7966 0.7966
    Precision 0.8394 0.7561 0.7750 0.8886 0.3792 0.8576 0.7246
    Recall 0.5217 0.0589 0.3954 0.9671 0.5374 0.6658 0.8464
    F1 0.6435 0.1093 0.5236 0.9262 0.4446 0.7496 0.7808
    Acc_avg 0.7966 Prec_avg 0.7458 Recall_avg 0.5704 F1_avg 0.5968
    Loss 1.9738

    [Tain]: 
    Epoch 56
    Data Time 6.2076 (0.0061)
    Batch Time 657.5450 (0.6428)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9982 0.9982 0.9982 0.9982 0.9982 0.9982 0.9982
    Precision 0.9977 0.9972 0.9959 0.9984 0.9990 0.9974 0.9982
    Recall 0.9974 0.9958 0.9964 0.9991 0.9990 0.9979 0.9970
    F1 0.9975 0.9965 0.9962 0.9988 0.9990 0.9976 0.9976
    AdversarialNet Acc 0.6043 Acc_avg 0.9982 Prec_avg 0.9977 Recall_avg 0.9975 F1_avg 0.9976
    Total Loss 0.6850 Global Cls Loss 0.0060 Local Cls Loss 0.0073 AFN Loss 0.0000 DAN Loss 0.6718

    [Test (Source Domain)]: 
    Data Time 0.2711 (0.0029)
    Batch Time 17.4886 (0.1860)
    Accuracy 0.7758 0.7758 0.7758 0.7758 0.7758 0.7758 0.7758
    Precision 0.8526 0.6346 0.4342 0.9084 0.6706 0.6854 0.7177
    Recall 0.7477 0.4853 0.4177 0.8642 0.7606 0.7625 0.7620
    F1 0.7967 0.5500 0.4258 0.8858 0.7128 0.7219 0.7392
    Acc_avg 0.7758 Prec_avg 0.7005 Recall_avg 0.6857 F1_avg 0.6903
    Loss 1.9052

    [Test (Target Domain)]: 
    Data Time 1.3860 (0.0027)
    Batch Time 94.5097 (0.1846)
    Accuracy 0.8022 0.8022 0.8022 0.8022 0.8022 0.8022 0.8022
    Precision 0.8198 0.7568 0.7637 0.8954 0.3912 0.8575 0.7266
    Recall 0.5530 0.0532 0.4250 0.9676 0.5174 0.6702 0.8564
    F1 0.6604 0.0995 0.5461 0.9301 0.4456 0.7524 0.7862
    Acc_avg 0.8022 Prec_avg 0.7444 Recall_avg 0.5775 F1_avg 0.6029
    Loss 1.8961

    [Tain]: 
    Epoch 57
    Data Time 6.6469 (0.0065)
    Batch Time 646.4989 (0.6320)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9980 0.9980 0.9980 0.9980 0.9980 0.9980 0.9980
    Precision 0.9977 0.9929 0.9990 0.9981 0.9983 0.9962 0.9987
    Recall 0.9960 0.9929 0.9964 0.9991 0.9983 0.9968 0.9982
    F1 0.9968 0.9929 0.9977 0.9986 0.9983 0.9965 0.9984
    AdversarialNet Acc 0.5899 Acc_avg 0.9980 Prec_avg 0.9973 Recall_avg 0.9968 F1_avg 0.9970
    Total Loss 0.6896 Global Cls Loss 0.0057 Local Cls Loss 0.0072 AFN Loss 0.0000 DAN Loss 0.6767

    [Test (Source Domain)]: 
    Data Time 0.2945 (0.0031)
    Batch Time 17.3976 (0.1851)
    Accuracy 0.7758 0.7758 0.7758 0.7758 0.7758 0.7758 0.7758
    Precision 0.8451 0.5862 0.4444 0.9048 0.6667 0.6685 0.7332
    Recall 0.7385 0.5000 0.4051 0.8685 0.7919 0.7562 0.7410
    F1 0.7882 0.5397 0.4238 0.8863 0.7239 0.7097 0.7371
    Acc_avg 0.7758 Prec_avg 0.6927 Recall_avg 0.6859 F1_avg 0.6870
    Loss 1.9092

    [Test (Target Domain)]: 
    Data Time 1.4353 (0.0028)
    Batch Time 94.9232 (0.1854)
    Accuracy 0.8040 0.8040 0.8040 0.8040 0.8040 0.8040 0.8040
    Precision 0.8127 0.7442 0.7824 0.8891 0.3978 0.8359 0.7391
    Recall 0.5686 0.0608 0.4028 0.9700 0.5068 0.7162 0.8483
    F1 0.6691 0.1125 0.5318 0.9278 0.4458 0.7714 0.7899
    Acc_avg 0.8040 Prec_avg 0.7430 Recall_avg 0.5819 F1_avg 0.6069
    Loss 1.8687

    [Tain]: 
    Epoch 58
    Data Time 6.1030 (0.0060)
    Batch Time 597.2462 (0.5838)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9978 0.9978 0.9978 0.9978 0.9978 0.9978 0.9978
    Precision 0.9985 1.0000 0.9964 0.9976 0.9977 0.9952 0.9987
    Recall 0.9971 0.9944 0.9943 0.9998 0.9965 0.9947 0.9975
    F1 0.9978 0.9972 0.9954 0.9987 0.9971 0.9949 0.9981
    AdversarialNet Acc 0.5670 Acc_avg 0.9978 Prec_avg 0.9977 Recall_avg 0.9963 F1_avg 0.9970
    Total Loss 0.6972 Global Cls Loss 0.0061 Local Cls Loss 0.0075 AFN Loss 0.0000 DAN Loss 0.6836

    [Test (Source Domain)]: 
    Data Time 0.2909 (0.0031)
    Batch Time 17.4744 (0.1859)
    Accuracy 0.7731 0.7731 0.7731 0.7731 0.7731 0.7731 0.7731
    Precision 0.8013 0.5763 0.4701 0.9106 0.6814 0.6578 0.7139
    Recall 0.7569 0.5000 0.3987 0.8617 0.7606 0.7688 0.7515
    F1 0.7785 0.5354 0.4315 0.8855 0.7188 0.7089 0.7322
    Acc_avg 0.7731 Prec_avg 0.6873 Recall_avg 0.6855 F1_avg 0.6844
    Loss 1.9058

    [Test (Target Domain)]: 
    Data Time 1.3918 (0.0027)
    Batch Time 94.6043 (0.1848)
    Accuracy 0.8026 0.8026 0.8026 0.8026 0.8026 0.8026 0.8026
    Precision 0.8064 0.7561 0.7872 0.9094 0.3981 0.8392 0.7124
    Recall 0.5712 0.0589 0.3972 0.9544 0.5395 0.7153 0.8691
    F1 0.6687 0.1093 0.5280 0.9313 0.4582 0.7723 0.7830
    Acc_avg 0.8026 Prec_avg 0.7441 Recall_avg 0.5865 F1_avg 0.6073
    Loss 1.9874

    [Tain]: 
    Epoch 59
    Data Time 6.1310 (0.0060)
    Batch Time 592.6318 (0.5793)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9979 0.9979 0.9979 0.9979 0.9979 0.9979 0.9979
    Precision 0.9977 0.9972 0.9995 0.9981 0.9975 0.9984 0.9972
    Recall 0.9962 0.9972 0.9959 0.9992 0.9981 0.9963 0.9970
    F1 0.9969 0.9972 0.9977 0.9987 0.9978 0.9973 0.9971
    AdversarialNet Acc 0.5453 Acc_avg 0.9979 Prec_avg 0.9979 Recall_avg 0.9971 F1_avg 0.9975
    Total Loss 0.7048 Global Cls Loss 0.0072 Local Cls Loss 0.0088 AFN Loss 0.0000 DAN Loss 0.6889

    [Test (Source Domain)]: 
    Data Time 0.2703 (0.0029)
    Batch Time 17.4222 (0.1853)
    Accuracy 0.7718 0.7718 0.7718 0.7718 0.7718 0.7718 0.7718
    Precision 0.8173 0.5926 0.4423 0.9132 0.6875 0.6396 0.7151
    Recall 0.7569 0.4706 0.4367 0.8531 0.7629 0.7875 0.7485
    F1 0.7859 0.5246 0.4395 0.8821 0.7232 0.7059 0.7314
    Acc_avg 0.7718 Prec_avg 0.6868 Recall_avg 0.6880 F1_avg 0.6847
    Loss 1.9032

    [Test (Target Domain)]: 
    Data Time 1.3879 (0.0027)
    Batch Time 94.5518 (0.1847)
    Accuracy 0.8032 0.8032 0.8032 0.8032 0.8032 0.8032 0.8032
    Precision 0.7816 0.7143 0.7691 0.9153 0.3937 0.8350 0.7184
    Recall 0.6120 0.0665 0.4287 0.9477 0.5501 0.7206 0.8583
    F1 0.6865 0.1217 0.5505 0.9312 0.4589 0.7736 0.7822
    Acc_avg 0.8032 Prec_avg 0.7325 Recall_avg 0.5977 F1_avg 0.6149
    Loss 1.9473
 train source dataset qty: 11971
 train source dataset dist: 1259, 262, 713, 4705, 1885, 682, 2465
[Source Domain] Cost time : 80.030677s
 train target dataset qty: 32757
 train target dataset dist: 2303, 1053, 2158, 15871, 1898, 2262, 7212
[Target Domain] Cost time : 205.916640s
TransferToTargetDomain.py:172: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():

    [Tain]: 
    Epoch 60
    Data Time 6.5956 (0.0064)
    Batch Time 600.2302 (0.5867)
    Learning Rate 1e-05 Learning Rate(AdversarialNet) 1e-05
    Accuracy 0.9983 0.9983 0.9983 0.9983 0.9983 0.9983 0.9983
    Precision 0.9991 1.0000 0.9974 0.9983 0.9979 0.9978 0.9982
    Recall 0.9974 0.9959 0.9969 0.9986 0.9984 0.9995 0.9982
    F1 0.9983 0.9979 0.9972 0.9985 0.9982 0.9986 0.9982
    AdversarialNet Acc 0.5349 Acc_avg 0.9983 Prec_avg 0.9984 Recall_avg 0.9978 F1_avg 0.9981
    Total Loss 0.7076 Global Cls Loss 0.0061 Local Cls Loss 0.0079 AFN Loss 0.0000 DAN Loss 0.6936

    [Test (Source Domain)]: 
    Data Time 0.2502 (0.0027)
    Batch Time 17.7474 (0.1888)
    Accuracy 0.7778 0.7778 0.7778 0.7778 0.7778 0.7778 0.7778
    Precision 0.8311 0.5538 0.4318 0.8975 0.7027 0.6704 0.7450
    Recall 0.7569 0.5294 0.4810 0.8745 0.7562 0.7500 0.7349
    F1 0.7923 0.5414 0.4551 0.8858 0.7284 0.7080 0.7400
    Acc_avg 0.7778 Prec_avg 0.6903 Recall_avg 0.6976 F1_avg 0.6930
    Loss 1.8451

    [Test (Target Domain)]: 
    Data Time 1.4193 (0.0028)
    Batch Time 94.7673 (0.1851)
    Accuracy 0.7973 0.7973 0.7973 0.7973 0.7973 0.7973 0.7973
    Precision 0.7617 0.5917 0.6841 0.8474 0.4378 0.9177 0.7783
    Recall 0.6493 0.1350 0.4972 0.9816 0.4120 0.5420 0.8070
    F1 0.7010 0.2198 0.5759 0.9096 0.4245 0.6815 0.7924
    Acc_avg 0.7973 Prec_avg 0.7169 Recall_avg 0.5749 F1_avg 0.6150
    Loss 1.9774
